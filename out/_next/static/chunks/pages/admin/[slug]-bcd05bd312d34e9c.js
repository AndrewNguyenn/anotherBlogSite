(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[815],{4625:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/[slug]",function(){return c(2550)}])},9958:function(a,b,c){"use strict";c.d(b,{Z:function(){return h}});var d=c(5893),e=c(1664),f=c(7294),g=c(8200);function h(a){return(0,f.useContext)(g.S).username?a.children:a.fallback||(0,d.jsx)(e.default,{href:"/enter",children:"You must be signed in"})}},3369:function(a,b,c){"use strict";c.d(b,{Z:function(){return e}});var d=c(5893);function e(a){return a.show?(0,d.jsx)("div",{className:"loader"}):null}},2550:function(a,b,c){"use strict";c.r(b),c.d(b,{"default":function(){return y}});var d=c(8520),e=c.n(d),f=c(5893),g=c(4468),h=c.n(g),i=c(9958),j=c(8403),k=c(5321),l=c(7294),m=c(3369),n=c(1153);function o(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function p(){var a=(0,l.useState)(!1),b=a[0],c=a[1],d=(0,l.useState)(0),g=d[0],h=d[1],i=(0,l.useState)(null),k=i[0],p=i[1],q=function(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){o(f,d,e,g,h,"next",a)}function h(a){o(f,d,e,g,h,"throw",a)}g(void 0)})}}(e().mark(function a(b){var d,f,g,i;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:f=(d=Array.from(b.target.files)[0]).type.split("/")[1],g=(0,n.iH)(j.tO,"uploads/".concat(j.I8.currentUser.uid,"/").concat(Date.now(),".").concat(f)),c(!0),(i=(0,n.B0)(g,d)).on(j.mC,function(a){h((a.bytesTransferred/a.totalBytes*100).toFixed(0))}),i.then(function(a){return(0,n.Jt)(g)}).then(function(a){p(a),c(!1)});case 7:case"end":return a.stop()}},a)}));return(0,f.jsxs)("div",{className:"box",children:[(0,f.jsx)(m.Z,{show:b}),b&&(0,f.jsxs)("h3",{children:[g,"%"]}),!b&&(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("label",{className:"btn",children:["üì∑  Upload Img",(0,f.jsx)("input",{type:"file",onChange:q,accept:"image/x-png,image/gif,image/jpeg"})]})}),k&&(0,f.jsx)("code",{className:"upload-snippet",children:"![alt](".concat(k,")")})]})}var q=c(1163),r=c(6677),s=c(2283),t=c(4895),u=c(1664),v=c(2620);function w(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function x(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){w(f,d,e,g,h,"next",a)}function h(a){w(f,d,e,g,h,"throw",a)}g(void 0)})}}function y(a){return(0,f.jsx)(i.Z,{children:(0,f.jsx)(z,{})})}function z(){var a,b=(0,l.useState)(!1),c=b[0],d=b[1],e=(0,q.useRouter)().query.slug,g=(0,k.JU)((0,k.ad)(),"users",j.I8.currentUser.uid,"posts",e),i=(function(a){if(Array.isArray(a))return a}(a=(0,r.iY)(g))||function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c}(a,1)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}())[0];return(0,f.jsx)("main",{className:h().container,children:i&&(0,f.jsxs)(f.Fragment,{children:[(0,f.jsxs)("section",{children:[(0,f.jsx)("h1",{children:i.title}),(0,f.jsxs)("p",{children:["ID: ",i.slug]}),(0,f.jsx)(A,{postRef:g,defaultValues:i,preview:c})]}),(0,f.jsxs)("aside",{children:[(0,f.jsx)("h3",{children:"Tools"}),(0,f.jsx)("button",{onClick:function(){return d(!c)},children:c?"Edit":"Preview"}),(0,f.jsx)(u.default,{href:"/".concat(i.username,"/").concat(i.slug),children:(0,f.jsx)("button",{className:"btn-blue",children:"Live view"})}),(0,f.jsx)(B,{postRef:g})]})]})})}function A(a){var b=a.defaultValues,c=a.postRef,d=a.preview,g=(0,s.cI)({defaultValues:b,mode:"onChange"}),i=g.register,j=g.errors,l=g.handleSubmit,m=g.formState,n=g.reset,o=g.watch,q=m.isValid,r=m.isDirty,u=x(e().mark(function a(b){var d,f;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return d=b.content,f=b.published,a.next=3,(0,k.r7)(c,{content:d,published:f,updatedAt:(0,k.Bt)()});case 3:n({content:d,published:f}),v.ZP.success("Post updated successfully!");case 5:case"end":return a.stop()}},a)}));return(0,f.jsxs)("form",{onSubmit:l(u),children:[d&&(0,f.jsx)("div",{className:"card",children:(0,f.jsx)(t.D,{children:o("content")})}),(0,f.jsxs)("div",{className:d?h().hidden:h().controls,children:[(0,f.jsx)(p,{}),(0,f.jsx)("textarea",{name:"content",ref:i({maxLength:{value:20e3,message:"content is too long"},minLength:{value:10,message:"content is too short"},required:{value:!0,message:"content is required"}})}),j.content&&(0,f.jsx)("p",{className:"text-danger",children:j.content.message}),(0,f.jsxs)("fieldset",{children:[(0,f.jsx)("input",{className:h().checkbox,name:"published",type:"checkbox",ref:i}),(0,f.jsx)("label",{children:"Published"})]}),(0,f.jsx)("button",{type:"submit",className:"btn-green",disabled:!r||!q,children:"Save Changes"})]})]})}function B(a){var b=a.postRef,c=(0,q.useRouter)(),d=x(e().mark(function a(){var d;return e().wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!(d=confirm("are you sure!"))){a.next=6;break}return a.next=4,(0,k.oe)(b);case 4:c.push("/admin"),(0,v.ZP)("post annihilated ",{icon:"ÔøΩÔ∏è"});case 6:case"end":return a.stop()}},a)}));return(0,f.jsx)("button",{className:"btn-red",onClick:d,children:"Delete"})}},4468:function(a){a.exports={container:"Admin_container__7Kd1y",hidden:"Admin_hidden__blWKt",controls:"Admin_controls__RhTAv",input:"Admin_input__9_7r7",checkbox:"Admin_checkbox__Ttf_p"}}},function(a){a.O(0,[545,718,774,888,179],function(){return a(a.s=4625)}),_N_E=a.O()}])