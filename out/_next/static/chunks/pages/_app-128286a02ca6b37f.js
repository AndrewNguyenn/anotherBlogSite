(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[888],{4444:function(a,b,c){"use strict";c.d(b,{BH:function(){return j},LL:function(){return w},ZR:function(){return s},tV:function(){return g},ne:function(){return Q},vZ:function(){return L},pd:function(){return P},m9:function(){return ha},"z$":function(){return l},ru:function(){return n},d:function(){return p},xb:function(){return K},w1:function(){return q},uI:function(){return m},"b$":function(){return o},Mn:function(){return r},xO:function(){return N},zd:function(){return O}});const d=function(a){const b=[];let c=0;for(let d=0;d<a.length;d++){let e=a.charCodeAt(d);e<128?b[c++]=e:e<2048?(b[c++]=e>>6|192,b[c++]=63&e|128):(64512&e)==55296&&d+1<a.length&&(64512&a.charCodeAt(d+1))==56320?(e=65536+((1023&e)<<10)+(1023&a.charCodeAt(++d)),b[c++]=e>>18|240,b[c++]=e>>12&63|128,b[c++]=e>>6&63|128,b[c++]=63&e|128):(b[c++]=e>>12|224,b[c++]=e>>6&63|128,b[c++]=63&e|128)}return b},e=function(a){const b=[];let c=0,d=0;for(;c<a.length;){const e=a[c++];if(e<128)b[d++]=String.fromCharCode(e);else if(e>191&&e<224){const f=a[c++];b[d++]=String.fromCharCode((31&e)<<6|63&f)}else if(e>239&&e<365){const g=a[c++],h=a[c++],i=a[c++],j=((7&e)<<18|(63&g)<<12|(63&h)<<6|63&i)-65536;b[d++]=String.fromCharCode(55296+(j>>10)),b[d++]=String.fromCharCode(56320+(1023&j))}else{const k=a[c++],l=a[c++];b[d++]=String.fromCharCode((15&e)<<12|(63&k)<<6|63&l)}}return b.join("")},f={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray(a,b){if(!Array.isArray(a))throw Error("encodeByteArray takes an array as a parameter");this.init_();const c=b?this.byteToCharMapWebSafe_:this.byteToCharMap_,d=[];for(let e=0;e<a.length;e+=3){const f=a[e],g=e+1<a.length,h=g?a[e+1]:0,i=e+2<a.length,j=i?a[e+2]:0,k=f>>2,l=(3&f)<<4|h>>4;let m=(15&h)<<2|j>>6,n=63&j;i||(n=64,g||(m=64)),d.push(c[k],c[l],c[m],c[n])}return d.join("")},encodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?btoa(a):this.encodeByteArray(d(a),b)},decodeString(a,b){return this.HAS_NATIVE_SUPPORT&&!b?atob(a):e(this.decodeStringToByteArray(a,b))},decodeStringToByteArray(a,b){this.init_();const c=b?this.charToByteMapWebSafe_:this.charToByteMap_,d=[];for(let e=0;e<a.length;){const f=c[a.charAt(e++)],g=e<a.length,h=g?c[a.charAt(e)]:0;++e;const i=e<a.length,j=i?c[a.charAt(e)]:64;++e;const k=e<a.length,l=k?c[a.charAt(e)]:64;if(++e,null==f||null==h||null==j||null==l)throw Error();const m=f<<2|h>>4;if(d.push(m),64!==j){const n=h<<4&240|j>>2;if(d.push(n),64!==l){const o=j<<6&192|l;d.push(o)}}}return d},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let a=0;a<this.ENCODED_VALS.length;a++)this.byteToCharMap_[a]=this.ENCODED_VALS.charAt(a),this.charToByteMap_[this.byteToCharMap_[a]]=a,this.byteToCharMapWebSafe_[a]=this.ENCODED_VALS_WEBSAFE.charAt(a),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[a]]=a,a>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(a)]=a,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(a)]=a)}}},g=function(a){try{return f.decodeString(a,!0)}catch(b){console.error("base64Decode failed: ",b)}return null};function h(a,b){if(!(b instanceof Object))return b;switch(b.constructor){case Date:const c=b;return new Date(c.getTime());case Object:void 0===a&&(a={});break;case Array:a=[];break;default:return b}for(const d in b)b.hasOwnProperty(d)&&i(d)&&(a[d]=h(a[d],b[d]));return a}function i(a){return"__proto__"!==a}class j{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}wrapCallback(k){return(a,b)=>{a?this.reject(a):this.resolve(b),"function"==typeof k&&(this.promise.catch(()=>{}),1===k.length?k(a):k(a,b))}}}function l(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""}function m(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(l())}function n(){const a="object"==typeof chrome?chrome.runtime:"object"==typeof browser?browser.runtime:void 0;return"object"==typeof a&& void 0!==a.id}function o(){return"object"==typeof navigator&&"ReactNative"===navigator.product}function p(){return l().indexOf("Electron/")>=0}function q(){const a=l();return a.indexOf("MSIE ")>=0||a.indexOf("Trident/")>=0}function r(){return l().indexOf("MSAppHost/")>=0}class s extends Error{constructor(t,u,v){super(u),this.code=t,this.customData=v,this.name="FirebaseError",Object.setPrototypeOf(this,s.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,w.prototype.create)}}class w{constructor(x,y,z){this.service=x,this.serviceName=y,this.errors=z}create(A,...B){const C=B[0]||{},D=`${this.service}/${A}`,E=this.errors[A],F=E?I(E,C):"Error",G=`${this.serviceName}: ${F} (${D}).`,H=new s(D,G,C);return H}}function I(a,b){return a.replace(J,(a,c)=>{const d=b[c];return null!=d?String(d):`<${c}?>`})}const J=/\{\$([^}]+)}/g;function K(a){for(const b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}function L(a,b){if(a===b)return!0;const c=Object.keys(a),d=Object.keys(b);for(const e of c){if(!d.includes(e))return!1;const f=a[e],g=b[e];if(M(f)&&M(g)){if(!L(f,g))return!1}else if(f!==g)return!1}for(const h of d)if(!c.includes(h))return!1;return!0}function M(a){return null!==a&&"object"==typeof a}function N(a){const b=[];for(const[c,d]of Object.entries(a))Array.isArray(d)?d.forEach(a=>{b.push(encodeURIComponent(c)+"="+encodeURIComponent(a))}):b.push(encodeURIComponent(c)+"="+encodeURIComponent(d));return b.length?"&"+b.join("&"):""}function O(a){const b={},c=a.replace(/^\?/,"").split("&");return c.forEach(a=>{if(a){const[c,d]=a.split("=");b[decodeURIComponent(c)]=decodeURIComponent(d)}}),b}function P(a){const b=a.indexOf("?");if(!b)return"";const c=a.indexOf("#",b);return a.substring(b,c>0?c:void 0)}function Q(a,b){const c=new R(a,b);return c.subscribe.bind(c)}class R{constructor(S,T){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=T,this.task.then(()=>{S(this)}).catch(a=>{this.error(a)})}next(U){this.forEachObserver(a=>{a.next(U)})}error(V){this.forEachObserver(a=>{a.error(V)}),this.close(V)}complete(){this.forEachObserver(a=>{a.complete()}),this.close()}subscribe(W,X,Y){let Z;if(void 0===W&& void 0===X&& void 0===Y)throw new Error("Missing Observer.");void 0===(Z=fa(W,["next","error","complete"])?W:{next:W,error:X,complete:Y}).next&&(Z.next=ga),void 0===Z.error&&(Z.error=ga),void 0===Z.complete&&(Z.complete=ga);const $=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?Z.error(this.finalError):Z.complete()}catch(a){}}),this.observers.push(Z),$}unsubscribeOne(_){void 0!==this.observers&& void 0!==this.observers[_]&&(delete this.observers[_],this.observerCount-=1,0===this.observerCount&& void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(aa){if(!this.finalized)for(let ba=0;ba<this.observers.length;ba++)this.sendOne(ba,aa)}sendOne(ca,da){this.task.then(()=>{if(void 0!==this.observers&& void 0!==this.observers[ca])try{da(this.observers[ca])}catch(a){"undefined"!=typeof console&&console.error&&console.error(a)}})}close(ea){this.finalized||(this.finalized=!0,void 0!==ea&&(this.finalError=ea),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function fa(a,b){if("object"!=typeof a||null===a)return!1;for(const c of b)if(c in a&&"function"==typeof a[c])return!0;return!1}function ga(){}function ha(a){return a&&a._delegate?a._delegate:a}},2720:function(a,b,c){"use strict";c.d(b,{hJ:function(){return Kf},v0:function(){return dn},Aj:function(){return qh},rh:function(){return Yk},w7:function(){return rh}});var d,e=c(4444),f=c(2238),g=function(a,b){return(g=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(a,b){a.__proto__=b}||function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])})(a,b)},h=function(){return(h=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)};function i(a,b){var c={};for(var d in a)Object.prototype.hasOwnProperty.call(a,d)&&0>b.indexOf(d)&&(c[d]=a[d]);if(null!=a&&"function"==typeof Object.getOwnPropertySymbols)for(var e=0,d=Object.getOwnPropertySymbols(a);e<d.length;e++)0>b.indexOf(d[e])&&Object.prototype.propertyIsEnumerable.call(a,d[e])&&(c[d[e]]=a[d[e]]);return c}function j(a){return this instanceof j?(this.v=a,this):new j(a)}var k=c(3333),l=c(8463);function m(){return{["dependent-sdk-initialized-before-auth"]:"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const n=m,o=new e.LL("auth","Firebase",m()),p=new k.Yd("@firebase/auth");function q(a,...b){p.logLevel<=k.in.ERROR&&p.error(`Auth (${f.Jn}): ${a}`,...b)}function r(a,...b){throw u(a,...b)}function s(a,...b){return u(a,...b)}function t(a,b,c){const d=Object.assign(Object.assign({},n()),{[b]:c}),f=new e.LL("auth","Firebase",d);return f.create(b,{appName:a.name})}function u(a,...b){if("string"!=typeof a){const c=b[0],d=[...b.slice(1)];return d[0]&&(d[0].appName=a.name),a._errorFactory.create(c,...d)}return o.create(a,...b)}function v(a,b,...c){if(!a)throw u(b,...c)}function w(a){const b="INTERNAL ASSERTION FAILED: "+a;throw q(b),new Error(b)}function x(a,b){a||w(b)}const y=new Map();function z(a){x(a instanceof Function,"Expected a class definition");let b=y.get(a);return b?(x(b instanceof a,"Instance stored in cache mismatched with class"),b):(b=new a(),y.set(a,b),b)}function A(){var a;return"undefined"!=typeof self&&(null===(a=self.location)|| void 0===a?void 0:a.href)||""}function B(){var a;return"undefined"!=typeof self&&(null===(a=self.location)|| void 0===a?void 0:a.protocol)||null}class C{constructor(D,E){this.shortDelay=D,this.longDelay=E,x(E>D,"Short delay should be less than long delay!"),this.isMobile=(0,e.uI)()||(0,e.b$)()}get(){return!("undefined"!=typeof navigator&&navigator&&"onLine"in navigator&&"boolean"==typeof navigator.onLine&&("http:"===B()||"https:"===B()||(0,e.ru)()||"connection"in navigator))||navigator.onLine?this.isMobile?this.longDelay:this.shortDelay:Math.min(5000,this.shortDelay)}}function F(a,b){x(a.emulator,"Emulator should always be set here");const{url:c}=a.emulator;return b?`${c}${b.startsWith("/")?b.slice(1):b}`:c}class G{static initialize(H,I,J){this.fetchImpl=H,I&&(this.headersImpl=I),J&&(this.responseImpl=J)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!=typeof self&&"fetch"in self?self.fetch:void w("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!=typeof self&&"Headers"in self?self.Headers:void w("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!=typeof self&&"Response"in self?self.Response:void w("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const K={["CREDENTIAL_MISMATCH"]:"custom-token-mismatch",["MISSING_CUSTOM_TOKEN"]:"internal-error",["INVALID_IDENTIFIER"]:"invalid-email",["MISSING_CONTINUE_URI"]:"internal-error",["INVALID_PASSWORD"]:"wrong-password",["MISSING_PASSWORD"]:"internal-error",["EMAIL_EXISTS"]:"email-already-in-use",["PASSWORD_LOGIN_DISABLED"]:"operation-not-allowed",["INVALID_IDP_RESPONSE"]:"invalid-credential",["INVALID_PENDING_TOKEN"]:"invalid-credential",["FEDERATED_USER_ID_ALREADY_LINKED"]:"credential-already-in-use",["MISSING_REQ_TYPE"]:"internal-error",["EMAIL_NOT_FOUND"]:"user-not-found",["RESET_PASSWORD_EXCEED_LIMIT"]:"too-many-requests",["EXPIRED_OOB_CODE"]:"expired-action-code",["INVALID_OOB_CODE"]:"invalid-action-code",["MISSING_OOB_CODE"]:"internal-error",["CREDENTIAL_TOO_OLD_LOGIN_AGAIN"]:"requires-recent-login",["INVALID_ID_TOKEN"]:"invalid-user-token",["TOKEN_EXPIRED"]:"user-token-expired",["USER_NOT_FOUND"]:"user-token-expired",["TOO_MANY_ATTEMPTS_TRY_LATER"]:"too-many-requests",["INVALID_CODE"]:"invalid-verification-code",["INVALID_SESSION_INFO"]:"invalid-verification-id",["INVALID_TEMPORARY_PROOF"]:"invalid-credential",["MISSING_SESSION_INFO"]:"missing-verification-id",["SESSION_EXPIRED"]:"code-expired",["MISSING_ANDROID_PACKAGE_NAME"]:"missing-android-pkg-name",["UNAUTHORIZED_DOMAIN"]:"unauthorized-continue-uri",["INVALID_OAUTH_CLIENT_ID"]:"invalid-oauth-client-id",["ADMIN_ONLY_OPERATION"]:"admin-restricted-operation",["INVALID_MFA_PENDING_CREDENTIAL"]:"invalid-multi-factor-session",["MFA_ENROLLMENT_NOT_FOUND"]:"multi-factor-info-not-found",["MISSING_MFA_ENROLLMENT_ID"]:"missing-multi-factor-info",["MISSING_MFA_PENDING_CREDENTIAL"]:"missing-multi-factor-session",["SECOND_FACTOR_EXISTS"]:"second-factor-already-in-use",["SECOND_FACTOR_LIMIT_EXCEEDED"]:"maximum-second-factor-count-exceeded",["BLOCKING_FUNCTION_ERROR_RESPONSE"]:"internal-error"},L=new C(30e3,60e3);function M(a,b){return a.tenantId&&!b.tenantId?Object.assign(Object.assign({},b),{tenantId:a.tenantId}):b}async function N(a,b,c,d,f={}){return O(a,f,async()=>{let f={},g={};d&&("GET"===b?g=d:f={body:JSON.stringify(d)});const h=(0,e.xO)(Object.assign({key:a.config.apiKey},g)).slice(1),i=await a._getAdditionalHeaders();return i["Content-Type"]="application/json",a.languageCode&&(i["X-Firebase-Locale"]=a.languageCode),G.fetch()(Q(a,a.config.apiHost,c,h),Object.assign({method:b,headers:i,referrerPolicy:"no-referrer"},f))})}async function O(a,b,c){a._canInitEmulator=!1;const d=Object.assign(Object.assign({},K),b);try{const f=new R(a),g=await Promise.race([c(),f.promise]);f.clearNetworkTimeout();const h=await g.json();if("needConfirmation"in h)throw T(a,"account-exists-with-different-credential",h);if(g.ok&&!("errorMessage"in h))return h;{const i=g.ok?h.errorMessage:h.error.message,[j,k]=i.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===j)throw T(a,"credential-already-in-use",h);if("EMAIL_EXISTS"===j)throw T(a,"email-already-in-use",h);const l=d[j]||j.toLowerCase().replace(/[_\s]+/g,"-");if(k)throw t(a,l,k);r(a,l)}}catch(m){if(m instanceof e.ZR)throw m;r(a,"network-request-failed")}}async function P(a,b,c,d,e={}){const f=await N(a,b,c,d,e);return"mfaPendingCredential"in f&&r(a,"multi-factor-auth-required",{_serverResponse:f}),f}function Q(a,b,c,d){const e=`${b}${c}?${d}`;return a.config.emulator?F(a.config,e):`${a.config.apiScheme}://${e}`}class R{constructor(S){this.auth=S,this.timer=null,this.promise=new Promise((a,b)=>{this.timer=setTimeout(()=>b(s(this.auth,"timeout")),L.get())})}clearNetworkTimeout(){clearTimeout(this.timer)}}function T(a,b,c){const d={appName:a.name};c.email&&(d.email=c.email),c.phoneNumber&&(d.phoneNumber=c.phoneNumber);const e=s(a,b,d);return e.customData._tokenResponse=c,e}async function U(a,b){return N(a,"POST","/v1/accounts:delete",b)}async function V(a,b){return N(a,"POST","/v1/accounts:lookup",b)}function W(a){if(a)try{const b=new Date(Number(a));if(!isNaN(b.getTime()))return b.toUTCString()}catch(c){}}async function X(a,b=!1){const c=(0,e.m9)(a),d=await c.getIdToken(b),f=Z(d);v(f&&f.exp&&f.auth_time&&f.iat,c.auth,"internal-error");const g="object"==typeof f.firebase?f.firebase:void 0,h=null==g?void 0:g.sign_in_provider;return{claims:f,token:d,authTime:W(Y(f.auth_time)),issuedAtTime:W(Y(f.iat)),expirationTime:W(Y(f.exp)),signInProvider:h||null,signInSecondFactor:(null==g?void 0:g.sign_in_second_factor)||null}}function Y(a){return 1000*Number(a)}function Z(a){const[b,c,d]=a.split(".");if(void 0===b|| void 0===c|| void 0===d)return q("JWT malformed, contained fewer than 3 sections"),null;try{const f=(0,e.tV)(c);if(!f)return q("Failed to decode base64 JWT payload"),null;return JSON.parse(f)}catch(g){return q("Caught error parsing JWT payload as JSON",g),null}}async function $(a,b,c=!1){if(c)return b;try{return await b}catch(d){throw d instanceof e.ZR&&_(d)&&a.auth.currentUser===a&&await a.auth.signOut(),d}}function _({code:a}){return"auth/user-disabled"===a||"auth/user-token-expired"===a}class aa{constructor(ba,ca){this.createdAt=ba,this.lastLoginAt=ca,this._initializeTime()}_initializeTime(){this.lastSignInTime=W(this.lastLoginAt),this.creationTime=W(this.createdAt)}_copy(da){this.createdAt=da.createdAt,this.lastLoginAt=da.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function ea(a){var b;const c=a.auth,d=await a.getIdToken(),e=await $(a,V(c,{idToken:d}));v(null==e?void 0:e.users.length,c,"internal-error");const f=e.users[0];a._notifyReloadListener(f);const g=(null===(b=f.providerUserInfo)|| void 0===b?void 0:b.length)?ha(f.providerUserInfo):[],h=ga(a.providerData,g),i=a.isAnonymous,j=!(a.email&&f.passwordHash)&&!(null==h?void 0:h.length),k={uid:f.localId,displayName:f.displayName||null,photoURL:f.photoUrl||null,email:f.email||null,emailVerified:f.emailVerified||!1,phoneNumber:f.phoneNumber||null,tenantId:f.tenantId||null,providerData:h,metadata:new aa(f.createdAt,f.lastLoginAt),isAnonymous:!!i&&j};Object.assign(a,k)}async function fa(a){const b=(0,e.m9)(a);await ea(b),await b.auth._persistUserIfCurrent(b),b.auth._notifyListenersIfCurrent(b)}function ga(a,b){const c=a.filter(a=>!b.some(b=>b.providerId===a.providerId));return[...c,...b]}function ha(a){return a.map(a=>{var{providerId:b}=a,c=i(a,["providerId"]);return{providerId:b,uid:c.rawId||"",displayName:c.displayName||null,email:c.email||null,phoneNumber:c.phoneNumber||null,photoURL:c.photoUrl||null}})}async function ia(a,b){const c=await O(a,{},async()=>{const c=(0,e.xO)({grant_type:"refresh_token",refresh_token:b}).slice(1),{tokenApiHost:d,apiKey:f}=a.config,g=Q(a,d,"/v1/token",`key=${f}`),h=await a._getAdditionalHeaders();return h["Content-Type"]="application/x-www-form-urlencoded",G.fetch()(g,{method:"POST",headers:h,body:c})});return{accessToken:c.access_token,expiresIn:c.expires_in,refreshToken:c.refresh_token}}class ja{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-30e3}updateFromServerResponse(ka){v(ka.idToken,"internal-error"),v(void 0!==ka.idToken,"internal-error"),v(void 0!==ka.refreshToken,"internal-error");const la="expiresIn"in ka&& void 0!==ka.expiresIn?Number(ka.expiresIn):function(a){const b=Z(a);return v(b,"internal-error"),v(void 0!==b.exp,"internal-error"),v(void 0!==b.iat,"internal-error"),Number(b.exp)-Number(b.iat)}(ka.idToken);this.updateTokensAndExpiration(ka.idToken,ka.refreshToken,la)}async getToken(ma,na=!1){return(v(!this.accessToken||this.refreshToken,ma,"user-token-expired"),na||!this.accessToken||this.isExpired)?this.refreshToken?(await this.refresh(ma,this.refreshToken),this.accessToken):null:this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(oa,pa){const{accessToken:qa,refreshToken:ra,expiresIn:sa}=await ia(oa,pa);this.updateTokensAndExpiration(qa,ra,Number(sa))}updateTokensAndExpiration(ta,ua,va){this.refreshToken=ua||null,this.accessToken=ta||null,this.expirationTime=Date.now()+1000*va}static fromJSON(wa,xa){const{refreshToken:ya,accessToken:za,expirationTime:Aa}=xa,Ba=new ja();return ya&&(v("string"==typeof ya,"internal-error",{appName:wa}),Ba.refreshToken=ya),za&&(v("string"==typeof za,"internal-error",{appName:wa}),Ba.accessToken=za),Aa&&(v("number"==typeof Aa,"internal-error",{appName:wa}),Ba.expirationTime=Aa),Ba}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(Ca){this.accessToken=Ca.accessToken,this.refreshToken=Ca.refreshToken,this.expirationTime=Ca.expirationTime}_clone(){return Object.assign(new ja(),this.toJSON())}_performRefresh(){return w("not implemented")}}function Da(a,b){v("string"==typeof a|| void 0===a,"internal-error",{appName:b})}class Ea{constructor(Fa){var{uid:Ga,auth:Ha,stsTokenManager:Ia}=Fa,Ja=i(Fa,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.emailVerified=!1,this.isAnonymous=!1,this.tenantId=null,this.providerData=[],this.proactiveRefresh=new class{constructor(Ka){this.user=Ka,this.isRunning=!1,this.timerId=null,this.errorBackoff=30e3}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(La){var Ma;if(La){const Na=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,960e3),Na}{this.errorBackoff=30e3;const Oa=null!==(Ma=this.user.stsTokenManager.expirationTime)&& void 0!==Ma?Ma:0,Pa=Oa-Date.now()-30e4;return Math.max(0,Pa)}}schedule(Qa=!1){if(this.isRunning){const Ra=this.getInterval(Qa);this.timerId=setTimeout(async()=>{await this.iteration()},Ra)}}async iteration(){try{await this.user.getIdToken(!0)}catch(Sa){"auth/network-request-failed"===Sa.code&&this.schedule(!0);return}this.schedule()}}(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=Ga,this.auth=Ha,this.stsTokenManager=Ia,this.accessToken=Ia.accessToken,this.displayName=Ja.displayName||null,this.email=Ja.email||null,this.emailVerified=Ja.emailVerified||!1,this.phoneNumber=Ja.phoneNumber||null,this.photoURL=Ja.photoURL||null,this.isAnonymous=Ja.isAnonymous||!1,this.tenantId=Ja.tenantId||null,this.metadata=new aa(Ja.createdAt||void 0,Ja.lastLoginAt||void 0)}async getIdToken(Ta){const Ua=await $(this,this.stsTokenManager.getToken(this.auth,Ta));return v(Ua,this.auth,"internal-error"),this.accessToken!==Ua&&(this.accessToken=Ua,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),Ua}getIdTokenResult(Va){return X(this,Va)}reload(){return fa(this)}_assign(Wa){this!==Wa&&(v(this.uid===Wa.uid,this.auth,"internal-error"),this.displayName=Wa.displayName,this.photoURL=Wa.photoURL,this.email=Wa.email,this.emailVerified=Wa.emailVerified,this.phoneNumber=Wa.phoneNumber,this.isAnonymous=Wa.isAnonymous,this.tenantId=Wa.tenantId,this.providerData=Wa.providerData.map(a=>Object.assign({},a)),this.metadata._copy(Wa.metadata),this.stsTokenManager._assign(Wa.stsTokenManager))}_clone(Xa){return new Ea(Object.assign(Object.assign({},this),{auth:Xa,stsTokenManager:this.stsTokenManager._clone()}))}_onReload(Ya){v(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=Ya,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(Za){this.reloadListener?this.reloadListener(Za):this.reloadUserInfo=Za}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary($a,_a=!1){let ab=!1;$a.idToken&&$a.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse($a),ab=!0),_a&&await ea(this),await this.auth._persistUserIfCurrent(this),ab&&this.auth._notifyListenersIfCurrent(this)}async delete(){const bb=await this.getIdToken();return await $(this,U(this.auth,{idToken:bb})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(a=>Object.assign({},a)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(cb,db){var eb,fb,gb,hb,ib,jb,kb,lb;const mb=null!==(eb=db.displayName)&& void 0!==eb?eb:void 0,nb=null!==(fb=db.email)&& void 0!==fb?fb:void 0,ob=null!==(gb=db.phoneNumber)&& void 0!==gb?gb:void 0,pb=null!==(hb=db.photoURL)&& void 0!==hb?hb:void 0,qb=null!==(ib=db.tenantId)&& void 0!==ib?ib:void 0,rb=null!==(jb=db._redirectEventId)&& void 0!==jb?jb:void 0,sb=null!==(kb=db.createdAt)&& void 0!==kb?kb:void 0,tb=null!==(lb=db.lastLoginAt)&& void 0!==lb?lb:void 0,{uid:ub,emailVerified:vb,isAnonymous:wb,providerData:xb,stsTokenManager:yb}=db;v(ub&&yb,cb,"internal-error");const zb=ja.fromJSON(this.name,yb);v("string"==typeof ub,cb,"internal-error"),Da(mb,cb.name),Da(nb,cb.name),v("boolean"==typeof vb,cb,"internal-error"),v("boolean"==typeof wb,cb,"internal-error"),Da(ob,cb.name),Da(pb,cb.name),Da(qb,cb.name),Da(rb,cb.name),Da(sb,cb.name),Da(tb,cb.name);const Ab=new Ea({uid:ub,auth:cb,email:nb,emailVerified:vb,displayName:mb,isAnonymous:wb,photoURL:pb,phoneNumber:ob,tenantId:qb,stsTokenManager:zb,createdAt:sb,lastLoginAt:tb});return xb&&Array.isArray(xb)&&(Ab.providerData=xb.map(a=>Object.assign({},a))),rb&&(Ab._redirectEventId=rb),Ab}static async _fromIdTokenResponse(Bb,Cb,Db=!1){const Eb=new ja();Eb.updateFromServerResponse(Cb);const Fb=new Ea({uid:Cb.localId,auth:Bb,stsTokenManager:Eb,isAnonymous:Db});return await ea(Fb),Fb}}class Gb{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(Hb,Ib){this.storage[Hb]=Ib}async _get(Jb){const Kb=this.storage[Jb];return void 0===Kb?null:Kb}async _remove(Lb){delete this.storage[Lb]}_addListener(Mb,Nb){}_removeListener(Ob,Pb){}}Gb.type="NONE";const Qb=Gb;function Rb(a,b,c){return`firebase:${a}:${b}:${c}`}class Sb{constructor(Tb,Ub,Vb){this.persistence=Tb,this.auth=Ub,this.userKey=Vb;const{config:Wb,name:Xb}=this.auth;this.fullUserKey=Rb(this.userKey,Wb.apiKey,Xb),this.fullPersistenceKey=Rb("persistence",Wb.apiKey,Xb),this.boundEventHandler=Ub._onStorageEvent.bind(Ub),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(Yb){return this.persistence._set(this.fullUserKey,Yb.toJSON())}async getCurrentUser(){const Zb=await this.persistence._get(this.fullUserKey);return Zb?Ea._fromJSON(this.auth,Zb):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence($b){if(this.persistence!==$b){const _b=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=$b,_b)return this.setCurrentUser(_b)}}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(ac,bc,cc="authUser"){if(!bc.length)return new Sb(z(Qb),ac,cc);const dc=(await Promise.all(bc.map(async a=>{if(await a._isAvailable())return a}))).filter(a=>a);let ec=dc[0]||z(Qb);const fc=Rb(cc,ac.config.apiKey,ac.name);let gc=null;for(const hc of bc)try{const ic=await hc._get(fc);if(ic){const jc=Ea._fromJSON(ac,ic);hc!==ec&&(gc=jc),ec=hc;break}}catch(kc){}const lc=dc.filter(a=>a._shouldAllowMigration);return ec._shouldAllowMigration&&lc.length&&(ec=lc[0],gc&&await ec._set(fc,gc.toJSON()),await Promise.all(bc.map(async a=>{if(a!==ec)try{await a._remove(fc)}catch(b){}}))),new Sb(ec,ac,cc)}}function mc(a){const b=a.toLowerCase();if(b.includes("opera/")||b.includes("opr/")||b.includes("opios/"))return"Opera";{if(qc(b))return"IEMobile";if(b.includes("msie")||b.includes("trident/"))return"IE";if(b.includes("edge/"))return"Edge";if(nc(b))return"Firefox";if(b.includes("silk/"))return"Silk";if(sc(b))return"Blackberry";if(tc(b))return"Webos";if(oc(b))return"Safari";if((b.includes("chrome/")||pc(b))&&!b.includes("edge/"))return"Chrome";if(rc(b))return"Android";const c=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,d=a.match(c);if((null==d?void 0:d.length)===2)return d[1]}return"Other"}function nc(a=(0,e.z$)()){return/firefox\//i.test(a)}function oc(a=(0,e.z$)()){const b=a.toLowerCase();return b.includes("safari/")&&!b.includes("chrome/")&&!b.includes("crios/")&&!b.includes("android")}function pc(a=(0,e.z$)()){return/crios\//i.test(a)}function qc(a=(0,e.z$)()){return/iemobile/i.test(a)}function rc(a=(0,e.z$)()){return/android/i.test(a)}function sc(a=(0,e.z$)()){return/blackberry/i.test(a)}function tc(a=(0,e.z$)()){return/webos/i.test(a)}function uc(a=(0,e.z$)()){return/iphone|ipad|ipod/i.test(a)}function vc(a=(0,e.z$)()){return uc(a)||rc(a)||tc(a)||sc(a)||/windows phone/i.test(a)||qc(a)}function wc(a,b=[]){let c;switch(a){case"Browser":c=mc((0,e.z$)());break;case"Worker":c=`${mc((0,e.z$)())}-${a}`;break;default:c=a}const d=b.length?b.join(","):"FirebaseCore-web";return`${c}/JsCore/${f.Jn}/${d}`}class xc{constructor(yc,zc){this.app=yc,this.config=zc,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new wd(this),this.idTokenSubscription=new wd(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=o,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=yc.name,this.clientVersion=zc.sdkClientVersion}_initializeWithPersistence(Ac,Bc){return Bc&&(this._popupRedirectResolver=z(Bc)),this._initializationPromise=this.queue(async()=>{var a,b;if(!this._deleted&&(this.persistenceManager=await Sb.create(this,Ac),!this._deleted)){if(null===(a=this._popupRedirectResolver)|| void 0===a?void 0:a._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(c){}await this.initializeCurrentUser(Bc),this.lastNotifiedUid=(null===(b=this.currentUser)|| void 0===b?void 0:b.uid)||null,this._deleted||(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(!this._deleted){const Cc=await this.assertedPersistence.getCurrentUser();if(this.currentUser||Cc){if(this.currentUser&&Cc&&this.currentUser.uid===Cc.uid){this._currentUser._assign(Cc),await this.currentUser.getIdToken();return}await this._updateCurrentUser(Cc)}}}async initializeCurrentUser(Dc){var Ec;let Fc=await this.assertedPersistence.getCurrentUser();if(Dc&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const Gc=null===(Ec=this.redirectUser)|| void 0===Ec?void 0:Ec._redirectEventId,Hc=null==Fc?void 0:Fc._redirectEventId,Ic=await this.tryRedirectSignIn(Dc);(!Gc||Gc===Hc)&&(null==Ic?void 0:Ic.user)&&(Fc=Ic.user)}return Fc?Fc._redirectEventId&&(v(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===Fc._redirectEventId)?this.directlySetCurrentUser(Fc):this.reloadAndSetCurrentUserOrClear(Fc):this.directlySetCurrentUser(null)}async tryRedirectSignIn(Jc){let Kc=null;try{Kc=await this._popupRedirectResolver._completeRedirectFn(this,Jc,!0)}catch(Lc){await this._setRedirectUser(null)}return Kc}async reloadAndSetCurrentUserOrClear(Mc){try{await ea(Mc)}catch(Nc){if("auth/network-request-failed"!==Nc.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(Mc)}useDeviceLanguage(){this.languageCode=(function(){if("undefined"==typeof navigator)return null;const a=navigator;return a.languages&&a.languages[0]||a.language||null})()}async _delete(){this._deleted=!0}async updateCurrentUser(Oc){const Pc=Oc?(0,e.m9)(Oc):null;return Pc&&v(Pc.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(Pc&&Pc._clone(this))}async _updateCurrentUser(Qc){if(!this._deleted)return Qc&&v(this.tenantId===Qc.tenantId,this,"tenant-id-mismatch"),this.queue(async()=>{await this.directlySetCurrentUser(Qc),this.notifyAuthListeners()})}async signOut(){return(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null)}setPersistence(Rc){return this.queue(async()=>{await this.assertedPersistence.setPersistence(z(Rc))})}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(Sc){this._errorFactory=new e.LL("auth","Firebase",Sc())}onAuthStateChanged(Tc,Uc,Vc){return this.registerStateListener(this.authStateSubscription,Tc,Uc,Vc)}onIdTokenChanged(Wc,Xc,Yc){return this.registerStateListener(this.idTokenSubscription,Wc,Xc,Yc)}toJSON(){var Zc;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(Zc=this._currentUser)|| void 0===Zc?void 0:Zc.toJSON()}}async _setRedirectUser($c,_c){const ad=await this.getOrInitRedirectPersistenceManager(_c);return null===$c?ad.removeCurrentUser():ad.setCurrentUser($c)}async getOrInitRedirectPersistenceManager(bd){if(!this.redirectPersistenceManager){const cd=bd&&z(bd)||this._popupRedirectResolver;v(cd,this,"argument-error"),this.redirectPersistenceManager=await Sb.create(this,[z(cd._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(dd){var ed,fd;return(this._isInitialized&&await this.queue(async()=>{}),(null===(ed=this._currentUser)|| void 0===ed?void 0:ed._redirectEventId)===dd)?this._currentUser:(null===(fd=this.redirectUser)|| void 0===fd?void 0:fd._redirectEventId)===dd?this.redirectUser:null}async _persistUserIfCurrent(gd){if(gd===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(gd))}_notifyListenersIfCurrent(hd){hd===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var id,jd;if(this._isInitialized){this.idTokenSubscription.next(this.currentUser);const kd=null!==(jd=null===(id=this.currentUser)|| void 0===id?void 0:id.uid)&& void 0!==jd?jd:null;this.lastNotifiedUid!==kd&&(this.lastNotifiedUid=kd,this.authStateSubscription.next(this.currentUser))}}registerStateListener(ld,md,nd,od){if(this._deleted)return()=>{};const pd="function"==typeof md?md:md.next.bind(md),qd=this._isInitialized?Promise.resolve():this._initializationPromise;return(v(qd,this,"internal-error"),qd.then(()=>pd(this.currentUser)),"function"==typeof md)?ld.addObserver(md,nd,od):ld.addObserver(md)}async directlySetCurrentUser(rd){this.currentUser&&this.currentUser!==rd&&(this._currentUser._stopProactiveRefresh(),rd&&this.isProactiveRefreshEnabled&&rd._startProactiveRefresh()),this.currentUser=rd,rd?await this.assertedPersistence.setCurrentUser(rd):await this.assertedPersistence.removeCurrentUser()}queue(sd){return this.operations=this.operations.then(sd,sd),this.operations}get assertedPersistence(){return v(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(td){!td||this.frameworks.includes(td)||(this.frameworks.push(td),this.frameworks.sort(),this.clientVersion=wc(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const ud={["X-Client-Version"]:this.clientVersion};return this.app.options.appId&&(ud["X-Firebase-gmpid"]=this.app.options.appId),ud}}function vd(a){return(0,e.m9)(a)}class wd{constructor(xd){this.auth=xd,this.observer=null,this.addObserver=(0,e.ne)(a=>this.observer=a)}get next(){return v(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}class yd{constructor(zd,Ad){this.providerId=zd,this.signInMethod=Ad}toJSON(){return w("not implemented")}_getIdTokenResponse(Bd){return w("not implemented")}_linkToIdToken(Cd,Dd){return w("not implemented")}_getReauthenticationResolver(Ed){return w("not implemented")}}async function Fd(a,b){return N(a,"POST","/v1/accounts:update",b)}async function Gd(a,b){return P(a,"POST","/v1/accounts:signInWithPassword",M(a,b))}async function Hd(a,b){return P(a,"POST","/v1/accounts:signInWithEmailLink",M(a,b))}async function Id(a,b){return P(a,"POST","/v1/accounts:signInWithEmailLink",M(a,b))}class Jd extends yd{constructor(Kd,Ld,Md,Nd=null){super("password",Md),this._email=Kd,this._password=Ld,this._tenantId=Nd}static _fromEmailAndPassword(Od,Pd){return new Jd(Od,Pd,"password")}static _fromEmailAndCode(Qd,Rd,Sd=null){return new Jd(Qd,Rd,"emailLink",Sd)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(Td){const Ud="string"==typeof Td?JSON.parse(Td):Td;if((null==Ud?void 0:Ud.email)&&(null==Ud?void 0:Ud.password)){if("password"===Ud.signInMethod)return this._fromEmailAndPassword(Ud.email,Ud.password);if("emailLink"===Ud.signInMethod)return this._fromEmailAndCode(Ud.email,Ud.password,Ud.tenantId)}return null}async _getIdTokenResponse(Vd){switch(this.signInMethod){case"password":return Gd(Vd,{returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Hd(Vd,{email:this._email,oobCode:this._password});default:r(Vd,"internal-error")}}async _linkToIdToken(Wd,Xd){switch(this.signInMethod){case"password":return Fd(Wd,{idToken:Xd,returnSecureToken:!0,email:this._email,password:this._password});case"emailLink":return Id(Wd,{idToken:Xd,email:this._email,oobCode:this._password});default:r(Wd,"internal-error")}}_getReauthenticationResolver(Yd){return this._getIdTokenResponse(Yd)}}async function Zd(a,b){return P(a,"POST","/v1/accounts:signInWithIdp",M(a,b))}class $d extends yd{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(_d){const ae=new $d(_d.providerId,_d.signInMethod);return _d.idToken||_d.accessToken?(_d.idToken&&(ae.idToken=_d.idToken),_d.accessToken&&(ae.accessToken=_d.accessToken),_d.nonce&&!_d.pendingToken&&(ae.nonce=_d.nonce),_d.pendingToken&&(ae.pendingToken=_d.pendingToken)):_d.oauthToken&&_d.oauthTokenSecret?(ae.accessToken=_d.oauthToken,ae.secret=_d.oauthTokenSecret):r("argument-error"),ae}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(be){const ce="string"==typeof be?JSON.parse(be):be,{providerId:de,signInMethod:ee}=ce,fe=i(ce,["providerId","signInMethod"]);if(!de||!ee)return null;const ge=new $d(de,ee);return ge.idToken=fe.idToken||void 0,ge.accessToken=fe.accessToken||void 0,ge.secret=fe.secret,ge.nonce=fe.nonce,ge.pendingToken=fe.pendingToken||null,ge}_getIdTokenResponse(he){const ie=this.buildRequest();return Zd(he,ie)}_linkToIdToken(je,ke){const le=this.buildRequest();return le.idToken=ke,Zd(je,le)}_getReauthenticationResolver(me){const ne=this.buildRequest();return ne.autoCreate=!1,Zd(me,ne)}buildRequest(){const oe={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)oe.pendingToken=this.pendingToken;else{const pe={};this.idToken&&(pe.id_token=this.idToken),this.accessToken&&(pe.access_token=this.accessToken),this.secret&&(pe.oauth_token_secret=this.secret),pe.providerId=this.providerId,this.nonce&&!this.pendingToken&&(pe.nonce=this.nonce),oe.postBody=(0,e.xO)(pe)}return oe}}async function qe(a,b){return N(a,"POST","/v1/accounts:sendVerificationCode",M(a,b))}async function re(a,b){return P(a,"POST","/v1/accounts:signInWithPhoneNumber",M(a,b))}async function se(a,b){const c=await P(a,"POST","/v1/accounts:signInWithPhoneNumber",M(a,b));if(c.temporaryProof)throw T(a,"account-exists-with-different-credential",c);return c}const te={["USER_NOT_FOUND"]:"user-not-found"};async function ue(a,b){const c=Object.assign(Object.assign({},b),{operation:"REAUTH"});return P(a,"POST","/v1/accounts:signInWithPhoneNumber",M(a,c),te)}class ve extends yd{constructor(we){super("phone","phone"),this.params=we}static _fromVerification(xe,ye){return new ve({verificationId:xe,verificationCode:ye})}static _fromTokenResponse(ze,Ae){return new ve({phoneNumber:ze,temporaryProof:Ae})}_getIdTokenResponse(Be){return re(Be,this._makeVerificationRequest())}_linkToIdToken(Ce,De){return se(Ce,Object.assign({idToken:De},this._makeVerificationRequest()))}_getReauthenticationResolver(Ee){return ue(Ee,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:Fe,phoneNumber:Ge,verificationId:He,verificationCode:Ie}=this.params;return Fe&&Ge?{temporaryProof:Fe,phoneNumber:Ge}:{sessionInfo:He,code:Ie}}toJSON(){const Je={providerId:this.providerId};return this.params.phoneNumber&&(Je.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(Je.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(Je.verificationCode=this.params.verificationCode),this.params.verificationId&&(Je.verificationId=this.params.verificationId),Je}static fromJSON(Ke){"string"==typeof Ke&&(Ke=JSON.parse(Ke));const{verificationId:Le,verificationCode:Me,phoneNumber:Ne,temporaryProof:Oe}=Ke;return Me||Le||Ne||Oe?new ve({verificationId:Le,verificationCode:Me,phoneNumber:Ne,temporaryProof:Oe}):null}}class Pe{constructor(Qe){var Re,Se,Te,Ue,Ve,We;const Xe=(0,e.zd)((0,e.pd)(Qe)),Ye=null!==(Re=Xe.apiKey)&& void 0!==Re?Re:null,Ze=null!==(Se=Xe.oobCode)&& void 0!==Se?Se:null,$e=function(a){switch(a){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(Te=Xe.mode)&& void 0!==Te?Te:null);v(Ye&&Ze&&$e,"argument-error"),this.apiKey=Ye,this.operation=$e,this.code=Ze,this.continueUrl=null!==(Ue=Xe.continueUrl)&& void 0!==Ue?Ue:null,this.languageCode=null!==(Ve=Xe.languageCode)&& void 0!==Ve?Ve:null,this.tenantId=null!==(We=Xe.tenantId)&& void 0!==We?We:null}static parseLink(_e){const af=function(a){const b=(0,e.zd)((0,e.pd)(a)).link,c=b?(0,e.zd)((0,e.pd)(b)).deep_link_id:null,d=(0,e.zd)((0,e.pd)(a)).deep_link_id,f=d?(0,e.zd)((0,e.pd)(d)).link:null;return f||d||c||b||a}(_e);try{return new Pe(af)}catch(bf){return null}}}class cf{constructor(){this.providerId=cf.PROVIDER_ID}static credential(df,ef){return Jd._fromEmailAndPassword(df,ef)}static credentialWithLink(ff,gf){const hf=Pe.parseLink(gf);return v(hf,"argument-error"),Jd._fromEmailAndCode(ff,hf.code,hf.tenantId)}}cf.PROVIDER_ID="password",cf.EMAIL_PASSWORD_SIGN_IN_METHOD="password",cf.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class jf{constructor(kf){this.providerId=kf,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(lf){this.defaultLanguageCode=lf}setCustomParameters(mf){return this.customParameters=mf,this}getCustomParameters(){return this.customParameters}}class nf extends jf{constructor(){super(...arguments),this.scopes=[]}addScope(of){return this.scopes.includes(of)||this.scopes.push(of),this}getScopes(){return[...this.scopes]}}class pf extends null{static credentialFromJSON(qf){const rf="string"==typeof qf?JSON.parse(qf):qf;return v("providerId"in rf&&"signInMethod"in rf,"argument-error"),$d._fromParams(rf)}credential(sf){return this._credential(Object.assign(Object.assign({},sf),{nonce:sf.rawNonce}))}_credential(tf){return v(tf.idToken||tf.accessToken,"argument-error"),$d._fromParams(Object.assign(Object.assign({},tf),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(uf){return pf.oauthCredentialFromTaggedObject(uf)}static credentialFromError(vf){return pf.oauthCredentialFromTaggedObject(vf.customData||{})}static oauthCredentialFromTaggedObject({_tokenResponse:wf}){if(!wf)return null;const{oauthIdToken:xf,oauthAccessToken:yf,oauthTokenSecret:zf,pendingToken:Af,nonce:Bf,providerId:Cf}=wf;if(!yf&&!zf&&!xf&&!Af)return null;if(!Cf)return null;try{return new pf(Cf)._credential({idToken:xf,accessToken:yf,nonce:Bf,pendingToken:Af})}catch(Df){return null}}}class Ef extends nf{constructor(){super("facebook.com")}static credential(Ff){return $d._fromParams({providerId:Ef.PROVIDER_ID,signInMethod:Ef.FACEBOOK_SIGN_IN_METHOD,accessToken:Ff})}static credentialFromResult(Gf){return Ef.credentialFromTaggedObject(Gf)}static credentialFromError(Hf){return Ef.credentialFromTaggedObject(Hf.customData||{})}static credentialFromTaggedObject({_tokenResponse:If}){if(!If||!("oauthAccessToken"in If))return null;if(!If.oauthAccessToken)return null;try{return Ef.credential(If.oauthAccessToken)}catch(Jf){return null}}}Ef.FACEBOOK_SIGN_IN_METHOD="facebook.com",Ef.PROVIDER_ID="facebook.com";class Kf extends nf{constructor(){super("google.com"),this.addScope("profile")}static credential(Lf,Mf){return $d._fromParams({providerId:Kf.PROVIDER_ID,signInMethod:Kf.GOOGLE_SIGN_IN_METHOD,idToken:Lf,accessToken:Mf})}static credentialFromResult(Nf){return Kf.credentialFromTaggedObject(Nf)}static credentialFromError(Of){return Kf.credentialFromTaggedObject(Of.customData||{})}static credentialFromTaggedObject({_tokenResponse:Pf}){if(!Pf)return null;const{oauthIdToken:Qf,oauthAccessToken:Rf}=Pf;if(!Qf&&!Rf)return null;try{return Kf.credential(Qf,Rf)}catch(Sf){return null}}}Kf.GOOGLE_SIGN_IN_METHOD="google.com",Kf.PROVIDER_ID="google.com";class Tf extends nf{constructor(){super("github.com")}static credential(Uf){return $d._fromParams({providerId:Tf.PROVIDER_ID,signInMethod:Tf.GITHUB_SIGN_IN_METHOD,accessToken:Uf})}static credentialFromResult(Vf){return Tf.credentialFromTaggedObject(Vf)}static credentialFromError(Wf){return Tf.credentialFromTaggedObject(Wf.customData||{})}static credentialFromTaggedObject({_tokenResponse:Xf}){if(!Xf||!("oauthAccessToken"in Xf))return null;if(!Xf.oauthAccessToken)return null;try{return Tf.credential(Xf.oauthAccessToken)}catch(Yf){return null}}}Tf.GITHUB_SIGN_IN_METHOD="github.com",Tf.PROVIDER_ID="github.com";class Zf extends null{constructor($f,_f){super($f,$f),this.pendingToken=_f}_getIdTokenResponse(ag){const bg=this.buildRequest();return Zd(ag,bg)}_linkToIdToken(cg,dg){const eg=this.buildRequest();return eg.idToken=dg,Zd(cg,eg)}_getReauthenticationResolver(fg){const gg=this.buildRequest();return gg.autoCreate=!1,Zd(fg,gg)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(hg){const ig="string"==typeof hg?JSON.parse(hg):hg,{providerId:jg,signInMethod:kg,pendingToken:lg}=ig;return jg&&kg&&lg&&jg===kg?new Zf(jg,lg):null}static _create(mg,ng){return new Zf(mg,ng)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class og extends null{constructor(pg){v(pg.startsWith("saml."),"argument-error"),super(pg)}static credentialFromResult(qg){return og.samlCredentialFromTaggedObject(qg)}static credentialFromError(rg){return og.samlCredentialFromTaggedObject(rg.customData||{})}static credentialFromJSON(sg){const tg=Zf.fromJSON(sg);return v(tg,"argument-error"),tg}static samlCredentialFromTaggedObject({_tokenResponse:ug}){if(!ug)return null;const{pendingToken:vg,providerId:wg}=ug;if(!vg||!wg)return null;try{return Zf._create(wg,vg)}catch(xg){return null}}}class yg extends nf{constructor(){super("twitter.com")}static credential(zg,Ag){return $d._fromParams({providerId:yg.PROVIDER_ID,signInMethod:yg.TWITTER_SIGN_IN_METHOD,oauthToken:zg,oauthTokenSecret:Ag})}static credentialFromResult(Bg){return yg.credentialFromTaggedObject(Bg)}static credentialFromError(Cg){return yg.credentialFromTaggedObject(Cg.customData||{})}static credentialFromTaggedObject({_tokenResponse:Dg}){if(!Dg)return null;const{oauthAccessToken:Eg,oauthTokenSecret:Fg}=Dg;if(!Eg||!Fg)return null;try{return yg.credential(Eg,Fg)}catch(Gg){return null}}}yg.TWITTER_SIGN_IN_METHOD="twitter.com",yg.PROVIDER_ID="twitter.com";class Hg{constructor(Ig){this.user=Ig.user,this.providerId=Ig.providerId,this._tokenResponse=Ig._tokenResponse,this.operationType=Ig.operationType}static async _fromIdTokenResponse(Jg,Kg,Lg,Mg=!1){const Ng=await Ea._fromIdTokenResponse(Jg,Lg,Mg),Og=Ug(Lg),Pg=new Hg({user:Ng,providerId:Og,_tokenResponse:Lg,operationType:Kg});return Pg}static async _forOperation(Qg,Rg,Sg){await Qg._updateTokensIfNecessary(Sg,!0);const Tg=Ug(Sg);return new Hg({user:Qg,providerId:Tg,_tokenResponse:Sg,operationType:Rg})}}function Ug(a){return a.providerId?a.providerId:"phoneNumber"in a?"phone":null}class Vg extends e.ZR{constructor(Wg,Xg,Yg,Zg){var $g;super(Xg.code,Xg.message),this.operationType=Yg,this.user=Zg,Object.setPrototypeOf(this,Vg.prototype),this.customData={appName:Wg.name,tenantId:null!==($g=Wg.tenantId)&& void 0!==$g?$g:void 0,_serverResponse:Xg.customData._serverResponse,operationType:Yg}}static _fromErrorAndOperation(_g,ah,bh,ch){return new Vg(_g,ah,bh,ch)}}function dh(a,b,c,d){const e="reauthenticate"===b?c._getReauthenticationResolver(a):c._getIdTokenResponse(a);return e.catch(c=>{if("auth/multi-factor-auth-required"===c.code)throw Vg._fromErrorAndOperation(a,c,b,d);throw c})}async function eh(a,b,c=!1){const d=await $(a,b._linkToIdToken(a.auth,await a.getIdToken()),c);return Hg._forOperation(a,"link",d)}async function fh(a,b,c=!1){const{auth:d}=a,e="reauthenticate";try{const f=await $(a,dh(d,e,b,a),c);v(f.idToken,d,"internal-error");const g=Z(f.idToken);v(g,d,"internal-error");const{sub:h}=g;return v(a.uid===h,d,"user-mismatch"),Hg._forOperation(a,e,f)}catch(i){throw(null==i?void 0:i.code)==="auth/user-not-found"&&r(d,"user-mismatch"),i}}async function gh(a,b,c=!1){const d="signIn",e=await dh(a,d,b),f=await Hg._fromIdTokenResponse(a,d,e);return c||await a._updateCurrentUser(f.user),f}class hh{constructor(ih,jh){this.factorId=ih,this.uid=jh.mfaEnrollmentId,this.enrollmentTime=new Date(jh.enrolledAt).toUTCString(),this.displayName=jh.displayName}static _fromServerResponse(kh,lh){return"phoneInfo"in lh?mh._fromServerResponse(kh,lh):r(kh,"internal-error")}}class mh extends null{constructor(nh){super("phone",nh),this.phoneNumber=nh.phoneInfo}static _fromServerResponse(oh,ph){return new mh(ph)}}function qh(a,b,c,d){return(0,e.m9)(a).onAuthStateChanged(b,c,d)}function rh(a){return(0,e.m9)(a).signOut()}class sh{constructor(th,uh){this.type=th,this.credential=uh}static _fromIdtoken(vh){return new sh("enroll",vh)}static _fromMfaPendingCredential(wh){return new sh("signin",wh)}toJSON(){const xh="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[xh]:this.credential}}}static fromJSON(yh){var zh,Ah;if(null==yh?void 0:yh.multiFactorSession){if(null===(zh=yh.multiFactorSession)|| void 0===zh?void 0:zh.pendingCredential)return sh._fromMfaPendingCredential(yh.multiFactorSession.pendingCredential);if(null===(Ah=yh.multiFactorSession)|| void 0===Ah?void 0:Ah.idToken)return sh._fromIdtoken(yh.multiFactorSession.idToken)}return null}}class Bh{constructor(Ch,Dh,Eh){this.session=Ch,this.hints=Dh,this.signInResolver=Eh}static _fromError(Fh,Gh){const Hh=vd(Fh),Ih=Gh.customData._serverResponse,Jh=(Ih.mfaInfo||[]).map(a=>hh._fromServerResponse(Hh,a));v(Ih.mfaPendingCredential,Hh,"internal-error");const Kh=sh._fromMfaPendingCredential(Ih.mfaPendingCredential);return new Bh(Kh,Jh,async a=>{const b=await a._process(Hh,Kh);delete Ih.mfaInfo,delete Ih.mfaPendingCredential;const c=Object.assign(Object.assign({},Ih),{idToken:b.idToken,refreshToken:b.refreshToken});switch(Gh.operationType){case"signIn":const d=await Hg._fromIdTokenResponse(Hh,Gh.operationType,c);return await Hh._updateCurrentUser(d.user),d;case"reauthenticate":return v(Gh.user,Hh,"internal-error"),Hg._forOperation(Gh.user,Gh.operationType,c);default:r(Hh,"internal-error")}})}async resolveSignIn(Lh){return this.signInResolver(Lh)}}class Mh{constructor(Nh){this.user=Nh,this.enrolledFactors=[],Nh._onReload(a=>{a.mfaInfo&&(this.enrolledFactors=a.mfaInfo.map(a=>hh._fromServerResponse(Nh.auth,a)))})}static _fromUser(Oh){return new Mh(Oh)}async getSession(){return sh._fromIdtoken(await this.user.getIdToken())}async enroll(Ph,Qh){const Rh=await this.getSession(),Sh=await $(this.user,Ph._process(this.user.auth,Rh,Qh));return await this.user._updateTokensIfNecessary(Sh),this.user.reload()}async unenroll(Th){const Uh="string"==typeof Th?Th:Th.uid,Vh=await this.user.getIdToken(),Wh=await $(this.user,N(this.user.auth,"POST","/v2/accounts/mfaEnrollment:withdraw",M(this.user.auth,{idToken:Vh,mfaEnrollmentId:Uh})));this.enrolledFactors=this.enrolledFactors.filter(({uid:a})=>a!==Uh),await this.user._updateTokensIfNecessary(Wh);try{await this.user.reload()}catch(Xh){if("auth/user-token-expired"!==Xh.code)throw Xh}}}new WeakMap();const Yh="__sak";class Zh{constructor($h,_h){this.storageRetriever=$h,this.type=_h}_isAvailable(){try{if(!this.storage)return Promise.resolve(!1);return this.storage.setItem(Yh,"1"),this.storage.removeItem(Yh),Promise.resolve(!0)}catch(ai){return Promise.resolve(!1)}}_set(bi,ci){return this.storage.setItem(bi,JSON.stringify(ci)),Promise.resolve()}_get(di){const ei=this.storage.getItem(di);return Promise.resolve(ei?JSON.parse(ei):null)}_remove(fi){return this.storage.removeItem(fi),Promise.resolve()}get storage(){return this.storageRetriever()}}class gi extends Zh{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(a,b)=>this.onStorageEvent(a,b),this.listeners={},this.localCache={},this.pollTimer=null,this.safariLocalStorageNotSynced=(function(){const a=(0,e.z$)();return oc(a)||uc(a)})()&&(function(){try{return!!(window&&window!==window.top)}catch(a){return!1}})(),this.fallbackToPolling=vc(),this._shouldAllowMigration=!0}forAllChangedKeys(hi){for(const ii of Object.keys(this.listeners)){const ji=this.storage.getItem(ii),ki=this.localCache[ii];ji!==ki&&hi(ii,ki,ji)}}onStorageEvent(li,mi=!1){if(!li.key){this.forAllChangedKeys((a,b,c)=>{this.notifyListeners(a,c)});return}const ni=li.key;if(mi?this.detachListener():this.stopPolling(),this.safariLocalStorageNotSynced){const oi=this.storage.getItem(ni);if(li.newValue!==oi)null!==li.newValue?this.storage.setItem(ni,li.newValue):this.storage.removeItem(ni);else if(this.localCache[ni]===li.newValue&&!mi)return}const pi=()=>{const a=this.storage.getItem(ni);(mi||this.localCache[ni]!==a)&&this.notifyListeners(ni,a)},qi=this.storage.getItem(ni);(0,e.w1)()&&10===document.documentMode&&qi!==li.newValue&&li.newValue!==li.oldValue?setTimeout(pi,10):pi()}notifyListeners(ri,si){this.localCache[ri]=si;const ti=this.listeners[ri];if(ti)for(const ui of Array.from(ti))ui(si?JSON.parse(si):si)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((a,b,c)=>{this.onStorageEvent(new StorageEvent("storage",{key:a,oldValue:b,newValue:c}),!0)})},1000)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(vi,wi){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[vi]||(this.listeners[vi]=new Set(),this.localCache[vi]=this.storage.getItem(vi)),this.listeners[vi].add(wi)}_removeListener(xi,yi){this.listeners[xi]&&(this.listeners[xi].delete(yi),0===this.listeners[xi].size&&delete this.listeners[xi]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(zi,Ai){await super._set(zi,Ai),this.localCache[zi]=JSON.stringify(Ai)}async _get(Bi){const Ci=await super._get(Bi);return this.localCache[Bi]=JSON.stringify(Ci),Ci}async _remove(Di){await super._remove(Di),delete this.localCache[Di]}}gi.type="LOCAL";const Ei=gi;class Fi extends Zh{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(Gi,Hi){}_removeListener(Ii,Ji){}}Fi.type="SESSION";const Ki=Fi;class Li{constructor(Mi){this.eventTarget=Mi,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(Ni){const Oi=this.receivers.find(a=>a.isListeningto(Ni));if(Oi)return Oi;const Pi=new Li(Ni);return this.receivers.push(Pi),Pi}isListeningto(Qi){return this.eventTarget===Qi}async handleEvent(Ri){var Si;const Ti=Ri,{eventId:Ui,eventType:Vi,data:Wi}=Ti.data,Xi=this.handlersMap[Vi];if(null==Xi?void 0:Xi.size){Ti.ports[0].postMessage({status:"ack",eventId:Ui,eventType:Vi});const Yi=Array.from(Xi).map(async a=>a(Ti.origin,Wi)),Zi=await (Si=Yi,Promise.all(Si.map(async a=>{try{const b=await a;return{fulfilled:!0,value:b}}catch(c){return{fulfilled:!1,reason:c}}})));Ti.ports[0].postMessage({status:"done",eventId:Ui,eventType:Vi,response:Zi})}}_subscribe($i,_i){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[$i]||(this.handlersMap[$i]=new Set()),this.handlersMap[$i].add(_i)}_unsubscribe(aj,bj){this.handlersMap[aj]&&bj&&this.handlersMap[aj].delete(bj),bj&&0!==this.handlersMap[aj].size||delete this.handlersMap[aj],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function cj(a="",b=10){let c="";for(let d=0;d<b;d++)c+=Math.floor(10*Math.random());return a+c}Li.receivers=[];class dj{constructor(ej){this.target=ej,this.handlers=new Set()}removeMessageHandler(fj){fj.messageChannel&&(fj.messageChannel.port1.removeEventListener("message",fj.onMessage),fj.messageChannel.port1.close()),this.handlers.delete(fj)}async _send(gj,hj,ij=50){const jj="undefined"!=typeof MessageChannel?new MessageChannel():null;if(!jj)throw new Error("connection_unavailable");let kj,lj;return new Promise((a,b)=>{const c=cj("",20);jj.port1.start();const d=setTimeout(()=>{b(new Error("unsupported_event"))},ij);lj={messageChannel:jj,onMessage(e){const f=e;if(f.data.eventId===c)switch(f.data.status){case"ack":clearTimeout(d),kj=setTimeout(()=>{b(new Error("timeout"))},3000);break;case"done":clearTimeout(kj),a(f.data.response);break;default:clearTimeout(d),clearTimeout(kj),b(new Error("invalid_response"));break}}},this.handlers.add(lj),jj.port1.addEventListener("message",lj.onMessage),this.target.postMessage({eventType:gj,eventId:c,data:hj},[jj.port2])}).finally(()=>{lj&&this.removeMessageHandler(lj)})}}function mj(){return window}function nj(){return void 0!==mj().WorkerGlobalScope&&"function"==typeof mj().importScripts}async function oj(){if(!(null==navigator?void 0:navigator.serviceWorker))return null;try{const a=await navigator.serviceWorker.ready;return a.active}catch(b){return null}}const pj="firebaseLocalStorageDb",qj="firebaseLocalStorage",rj="fbase_key";class sj{constructor(tj){this.request=tj}toPromise(){return new Promise((a,b)=>{this.request.addEventListener("success",()=>{a(this.request.result)}),this.request.addEventListener("error",()=>{b(this.request.error)})})}}function uj(a,b){return a.transaction([qj],b?"readwrite":"readonly").objectStore(qj)}function vj(){const a=indexedDB.open(pj,1);return new Promise((b,c)=>{a.addEventListener("error",()=>{c(a.error)}),a.addEventListener("upgradeneeded",()=>{const b=a.result;try{b.createObjectStore(qj,{keyPath:rj})}catch(d){c(d)}}),a.addEventListener("success",async()=>{const c=a.result;c.objectStoreNames.contains(qj)?b(c):(c.close(),await function(){const a=indexedDB.deleteDatabase(pj);return new sj(a).toPromise()}(),b(await vj()))})})}async function wj(a,b,c){const d=uj(a,!0).put({[rj]:b,value:c});return new sj(d).toPromise()}async function xj(a,b){const c=uj(a,!1).get(b),d=await new sj(c).toPromise();return void 0===d?null:d.value}function yj(a,b){const c=uj(a,!0).delete(b);return new sj(c).toPromise()}class zj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db||(this.db=await vj()),this.db}async _withRetries(Aj){let Bj=0;for(;;)try{const Cj=await this._openDb();return await Aj(Cj)}catch(Dj){if(Bj++ >3)throw Dj;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return nj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Li._getInstance(nj()?self:null),this.receiver._subscribe("keyChanged",async(a,b)=>{const c=await this._poll();return{keyProcessed:c.includes(b.key)}}),this.receiver._subscribe("ping",async(a,b)=>["keyChanged"])}async initializeSender(){var Ej,Fj;if(this.activeServiceWorker=await oj(),this.activeServiceWorker){this.sender=new dj(this.activeServiceWorker);const Gj=await this.sender._send("ping",{},800);!!Gj&&(null===(Ej=Gj[0])|| void 0===Ej?void 0:Ej.fulfilled)&&(null===(Fj=Gj[0])|| void 0===Fj?void 0:Fj.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}}async notifyServiceWorker(Hj){var Ij;if(this.sender&&this.activeServiceWorker&&((null===(Ij=null==navigator?void 0:navigator.serviceWorker)|| void 0===Ij?void 0:Ij.controller)||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:Hj},this.serviceWorkerReceiverAvailable?800:50)}catch(Jj){}}async _isAvailable(){try{if(!indexedDB)return!1;const Kj=await vj();return await wj(Kj,Yh,"1"),await yj(Kj,Yh),!0}catch(Lj){}return!1}async _withPendingWrite(Mj){this.pendingWrites++;try{await Mj()}finally{this.pendingWrites--}}async _set(Nj,Oj){return this._withPendingWrite(async()=>(await this._withRetries(a=>wj(a,Nj,Oj)),this.localCache[Nj]=Oj,this.notifyServiceWorker(Nj)))}async _get(Pj){const Qj=await this._withRetries(a=>xj(a,Pj));return this.localCache[Pj]=Qj,Qj}async _remove(Rj){return this._withPendingWrite(async()=>(await this._withRetries(a=>yj(a,Rj)),delete this.localCache[Rj],this.notifyServiceWorker(Rj)))}async _poll(){const Sj=await this._withRetries(a=>{const b=uj(a,!1).getAll();return new sj(b).toPromise()});if(!Sj)return[];if(0!==this.pendingWrites)return[];const Tj=[],Uj=new Set();for(const{fbase_key:Vj,value:Wj}of Sj)Uj.add(Vj),JSON.stringify(this.localCache[Vj])!==JSON.stringify(Wj)&&(this.notifyListeners(Vj,Wj),Tj.push(Vj));for(const Xj of Object.keys(this.localCache))this.localCache[Xj]&&!Uj.has(Xj)&&(this.notifyListeners(Xj,null),Tj.push(Xj));return Tj}notifyListeners(Yj,Zj){this.localCache[Yj]=Zj;const $j=this.listeners[Yj];if($j)for(const _j of Array.from($j))_j(Zj)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(ak,bk){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[ak]||(this.listeners[ak]=new Set(),this._get(ak)),this.listeners[ak].add(bk)}_removeListener(ck,dk){this.listeners[ck]&&(this.listeners[ck].delete(dk),0===this.listeners[ck].size&&delete this.listeners[ck]),0===Object.keys(this.listeners).length&&this.stopPolling()}}zj.type="LOCAL";const ek=zj;function fk(a){return`__${a}${Math.floor(10e5*Math.random())}`}async function gk(a,b,c){var d,e,f,g,h;const i=await c.verify();try{v("string"==typeof i,a,"argument-error"),v("recaptcha"===c.type,a,"argument-error");let j;if(j="string"==typeof b?{phoneNumber:b}:b,"session"in j){const k=j.session;if("phoneNumber"in j){v("enroll"===k.type,a,"internal-error");const l=await (e=a,f={idToken:k.credential,phoneEnrollmentInfo:{phoneNumber:j.phoneNumber,recaptchaToken:i}},N(e,"POST","/v2/accounts/mfaEnrollment:start",M(e,f)));return l.phoneSessionInfo.sessionInfo}{v("signin"===k.type,a,"internal-error");const m=(null===(d=j.multiFactorHint)|| void 0===d?void 0:d.uid)||j.multiFactorUid;v(m,a,"missing-multi-factor-info");const n=await (g=a,h={mfaPendingCredential:k.credential,mfaEnrollmentId:m,phoneSignInInfo:{recaptchaToken:i}},N(g,"POST","/v2/accounts/mfaSignIn:start",M(g,h)));return n.phoneResponseInfo.sessionInfo}}{const{sessionInfo:o}=await qe(a,{phoneNumber:j.phoneNumber,recaptchaToken:i});return o}}finally{c._reset()}}fk("rcb"),new C(30e3,60e3);class hk{constructor(ik){this.providerId=hk.PROVIDER_ID,this.auth=vd(ik)}verifyPhoneNumber(jk,kk){return gk(this.auth,jk,(0,e.m9)(kk))}static credential(lk,mk){return ve._fromVerification(lk,mk)}static credentialFromResult(nk){return hk.credentialFromTaggedObject(nk)}static credentialFromError(ok){return hk.credentialFromTaggedObject(ok.customData||{})}static credentialFromTaggedObject({_tokenResponse:pk}){if(!pk)return null;const{phoneNumber:qk,temporaryProof:rk}=pk;return qk&&rk?ve._fromTokenResponse(qk,rk):null}}function sk(a,b){return b?z(b):(v(a._popupRedirectResolver,a,"argument-error"),a._popupRedirectResolver)}hk.PROVIDER_ID="phone",hk.PHONE_SIGN_IN_METHOD="phone";class tk extends yd{constructor(uk){super("custom","custom"),this.params=uk}_getIdTokenResponse(vk){return Zd(vk,this._buildIdpRequest())}_linkToIdToken(wk,xk){return Zd(wk,this._buildIdpRequest(xk))}_getReauthenticationResolver(yk){return Zd(yk,this._buildIdpRequest())}_buildIdpRequest(zk){const Ak={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return zk&&(Ak.idToken=zk),Ak}}function Bk(a){return gh(a.auth,new tk(a),a.bypassAuthState)}function Ck(a){const{auth:b,user:c}=a;return v(c,b,"internal-error"),fh(c,new tk(a),a.bypassAuthState)}async function Dk(a){const{auth:b,user:c}=a;return v(c,b,"internal-error"),eh(c,new tk(a),a.bypassAuthState)}class Ek{constructor(Fk,Gk,Hk,Ik,Jk=!1){this.auth=Fk,this.resolver=Hk,this.user=Ik,this.bypassAuthState=Jk,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(Gk)?Gk:[Gk]}execute(){return new Promise(async(a,b)=>{this.pendingPromise={resolve:a,reject:b};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(c){this.reject(c)}})}async onAuthEvent(Kk){const{urlResponse:Lk,sessionId:Mk,postBody:Nk,tenantId:Ok,error:Pk,type:Qk}=Kk;if(Pk){this.reject(Pk);return}const Rk={auth:this.auth,requestUri:Lk,sessionId:Mk,tenantId:Ok||void 0,postBody:Nk||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(Qk)(Rk))}catch(Sk){this.reject(Sk)}}onError(Tk){this.reject(Tk)}getIdpTask(Uk){switch(Uk){case"signInViaPopup":case"signInViaRedirect":return Bk;case"linkViaPopup":case"linkViaRedirect":return Dk;case"reauthViaPopup":case"reauthViaRedirect":return Ck;default:r(this.auth,"internal-error")}}resolve(Vk){x(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(Vk),this.unregisterAndCleanUp()}reject(Wk){x(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(Wk),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Xk=new C(2000,10e3);async function Yk(a,b,c){const d=vd(a);!function(a,b,c){const d=c;if(!(b instanceof d))throw d.name!==b.constructor.name&&r(a,"argument-error"),t(a,"argument-error",`Type of ${b.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}(a,b,jf);const e=sk(d,c),f=new Zk(d,"signInViaPopup",b,e);return f.executeNotNull()}class Zk extends Ek{constructor($k,_k,al,bl,cl){super($k,_k,bl,cl),this.provider=al,this.authWindow=null,this.pollId=null,Zk.currentPopupAction&&Zk.currentPopupAction.cancel(),Zk.currentPopupAction=this}async executeNotNull(){const dl=await this.execute();return v(dl,this.auth,"internal-error"),dl}async onExecution(){x(1===this.filter.length,"Popup operations only handle one event");const el=cj();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],el),this.authWindow.associatedEvent=el,this.resolver._originValidation(this.auth).catch(a=>{this.reject(a)}),this.resolver._isIframeWebStorageSupported(this.auth,a=>{a||this.reject(s(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var fl;return(null===(fl=this.authWindow)|| void 0===fl?void 0:fl.associatedEvent)||null}cancel(){this.reject(s(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Zk.currentPopupAction=null}pollUserCancellation(){const gl=()=>{var a,b;if(null===(b=null===(a=this.authWindow)|| void 0===a?void 0:a.window)|| void 0===b?void 0:b.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(s(this.auth,"popup-closed-by-user"))},2000);return}this.pollId=window.setTimeout(gl,Xk.get())};gl()}}Zk.currentPopupAction=null;const hl=new Map();class il extends Ek{constructor(jl,kl,ll=!1){super(jl,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],kl,void 0,ll),this.eventId=null}async execute(){let ml=hl.get(this.auth._key());if(!ml){try{const nl=await sl(this.resolver,this.auth),ol=nl?await super.execute():null;ml=()=>Promise.resolve(ol)}catch(pl){ml=()=>Promise.reject(pl)}hl.set(this.auth._key(),ml)}return this.bypassAuthState||hl.set(this.auth._key(),()=>Promise.resolve(null)),ml()}async onAuthEvent(ql){if("signInViaRedirect"===ql.type)return super.onAuthEvent(ql);if("unknown"===ql.type){this.resolve(null);return}if(ql.eventId){const rl=await this.auth._redirectUserForId(ql.eventId);if(rl)return this.user=rl,super.onAuthEvent(ql);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function sl(a,b){const c=ul(b),d=tl(a);if(!await d._isAvailable())return!1;const e=await d._get(c)==="true";return await d._remove(c),e}function tl(a){return z(a._redirectPersistence)}function ul(a){return Rb("pendingRedirect",a.config.apiKey,a.name)}async function vl(a,b,c=!1){const d=vd(a),e=sk(d,b),f=new il(d,e,c),g=await f.execute();return g&&!c&&(delete g.user._redirectEventId,await d._persistUserIfCurrent(g.user),await d._setRedirectUser(null,b)),g}class wl{constructor(xl){this.auth=xl,this.cachedEventUids=new Set(),this.consumers=new Set(),this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(yl){this.consumers.add(yl),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,yl)&&(this.sendToConsumer(this.queuedRedirectEvent,yl),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(zl){this.consumers.delete(zl)}onEvent(Al){if(this.hasEventBeenHandled(Al))return!1;let Bl=!1;return this.consumers.forEach(a=>{this.isEventForConsumer(Al,a)&&(Bl=!0,this.sendToConsumer(Al,a),this.saveEventToCache(Al))}),this.hasHandledPotentialRedirect||!Nl(Al)||(this.hasHandledPotentialRedirect=!0,Bl||(this.queuedRedirectEvent=Al,Bl=!0)),Bl}sendToConsumer(Cl,Dl){var El;if(Cl.error&&!Ml(Cl)){const Fl=(null===(El=Cl.error.code)|| void 0===El?void 0:El.split("auth/")[1])||"internal-error";Dl.onError(s(this.auth,Fl))}else Dl.onAuthEvent(Cl)}isEventForConsumer(Gl,Hl){const Il=null===Hl.eventId|| !!Gl.eventId&&Gl.eventId===Hl.eventId;return Hl.filter.includes(Gl.type)&&Il}hasEventBeenHandled(Jl){return Date.now()-this.lastProcessedEventTime>=60e4&&this.cachedEventUids.clear(),this.cachedEventUids.has(Ll(Jl))}saveEventToCache(Kl){this.cachedEventUids.add(Ll(Kl)),this.lastProcessedEventTime=Date.now()}}function Ll(a){return[a.type,a.eventId,a.sessionId,a.tenantId].filter(a=>a).join("-")}function Ml({type:a,error:b}){return"unknown"===a&&(null==b?void 0:b.code)==="auth/no-auth-event"}function Nl(a){switch(a.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ml(a);default:return!1}}async function Ol(a,b={}){return N(a,"GET","/v1/projects",b)}const Pl=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Ql=/^https?/;async function Rl(a){if(!a.config.emulator){const{authorizedDomains:b}=await Ol(a);for(const c of b)try{if(Sl(c))return}catch(d){}r(a,"unauthorized-domain")}}function Sl(a){const b=A(),{protocol:c,hostname:d}=new URL(b);if(a.startsWith("chrome-extension://")){const e=new URL(a);return""===e.hostname&&""===d?"chrome-extension:"===c&&a.replace("chrome-extension://","")===b.replace("chrome-extension://",""):"chrome-extension:"===c&&e.hostname===d}if(!Ql.test(c))return!1;if(Pl.test(a))return d===a;const f=a.replace(/\./g,"\\."),g=new RegExp("^(.+\\."+f+"|"+f+")$","i");return g.test(d)}const Tl=new C(30e3,60e3);function Ul(){const a=mj().___jsl;if(null==a?void 0:a.H){for(const b of Object.keys(a.H))if(a.H[b].r=a.H[b].r||[],a.H[b].L=a.H[b].L||[],a.H[b].r=[...a.H[b].L],a.CP)for(let c=0;c<a.CP.length;c++)a.CP[c]=null}}let Vl=null;const Wl=new C(5000,15000),Xl={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Yl=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);async function Zl(a){var b,c;const d=await (b=a,Vl=Vl||(c=b,new Promise((a,b)=>{var d,e,f,g;function h(){Ul(),gapi.load("gapi.iframes",{callback:()=>{a(gapi.iframes.getContext())},ontimeout:()=>{Ul(),b(s(c,"network-request-failed"))},timeout:Tl.get()})}if(null===(e=null===(d=mj().gapi)|| void 0===d?void 0:d.iframes)|| void 0===e?void 0:e.Iframe)a(gapi.iframes.getContext());else if(null===(f=mj().gapi)|| void 0===f?void 0:f.load)h();else{const i=fk("iframefcb");return mj()[i]=()=>{gapi.load?h():b(s(c,"network-request-failed"))},(g=`https://apis.google.com/js/api.js?onload=${i}`,new Promise((a,b)=>{var c,d;const e=document.createElement("script");e.setAttribute("src",g),e.onload=a,e.onerror=a=>{const c=s("internal-error");c.customData=a,b(c)},e.type="text/javascript",e.charset="UTF-8",(null!==(d=null===(c=document.getElementsByTagName("head"))|| void 0===c?void 0:c[0])&& void 0!==d?d:document).appendChild(e)})).catch(a=>b(a))}}).catch(a=>{throw Vl=null,a}))),g=mj().gapi;return v(g,a,"internal-error"),d.open({where:document.body,url:function(a){const b=a.config;v(b.authDomain,a,"auth-domain-config-required");const c=b.emulator?F(b,"emulator/auth/iframe"):`https://${a.config.authDomain}/__/auth/iframe`,d={apiKey:b.apiKey,appName:a.name,v:f.Jn},g=Yl.get(a.config.apiHost);g&&(d.eid=g);const h=a._getFrameworks();return h.length&&(d.fw=h.join(",")),`${c}?${(0,e.xO)(d).slice(1)}`}(a),messageHandlersFilter:g.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:Xl,dontclear:!0},b=>new Promise(async(c,d)=>{await b.restyle({setHideOnLeave:!1});const e=s(a,"network-request-failed"),f=mj().setTimeout(()=>{d(e)},Wl.get());function g(){mj().clearTimeout(f),c(b)}b.ping(g).then(g,()=>{d(e)})}))}const $l={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class _l{constructor(am){this.window=am,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(bm){}}}function cm(a,b,c,d,g,h){v(a.config.authDomain,a,"auth-domain-config-required"),v(a.config.apiKey,a,"invalid-api-key");const i={apiKey:a.config.apiKey,appName:a.name,authType:c,redirectUrl:d,v:f.Jn,eventId:g};if(b instanceof jf)for(const[j,k]of(b.setDefaultLanguage(a.languageCode),i.providerId=b.providerId||"",(0,e.xb)(b.getCustomParameters())||(i.customParameters=JSON.stringify(b.getCustomParameters())),Object.entries(h||{})))i[j]=k;if(b instanceof nf){const l=b.getScopes().filter(a=>""!==a);l.length>0&&(i.scopes=l.join(","))}a.tenantId&&(i.tid=a.tenantId);const m=i;for(const n of Object.keys(m))void 0===m[n]&&delete m[n];return`${dm(a)}?${(0,e.xO)(m).slice(1)}`}function dm({config:a}){return a.emulator?F(a,"emulator/auth/handler"):`https://${a.authDomain}/__/auth/handler`}const em="webStorageSupport",fm=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Ki,this._completeRedirectFn=vl}async _openPopup(gm,hm,im,jm){var km;x(null===(km=this.eventManagers[gm._key()])|| void 0===km?void 0:km.manager,"_initialize() not called before _openPopup()");const lm=cm(gm,hm,im,A(),jm);return(function(a,b,c,d=500,f=600){const g=Math.max((window.screen.availHeight-f)/2,0).toString(),h=Math.max((window.screen.availWidth-d)/2,0).toString();let i="";const j=Object.assign(Object.assign({},$l),{width:d.toString(),height:f.toString(),top:g,left:h}),k=(0,e.z$)().toLowerCase();c&&(i=pc(k)?"_blank":c),nc(k)&&(b=b||"http://localhost",j.scrollbars="yes");const l=Object.entries(j).reduce((a,[b,c])=>`${a}${b}=${c},`,"");if((function(a=(0,e.z$)()){var b;return uc(a)&&!!(null===(b=window.navigator)|| void 0===b?void 0:b.standalone)})(k)&&"_self"!==i)return(function(a,b){const c=document.createElement("a");c.href=a,c.target=b;const d=document.createEvent("MouseEvent");d.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),c.dispatchEvent(d)})(b||"",i),new _l(null);const m=window.open(b||"",i,l);v(m,a,"popup-blocked");try{m.focus()}catch(n){}return new _l(m)})(gm,lm,cj())}async _openRedirect(mm,nm,om,pm){var qm;return await this._originValidation(mm),qm=cm(mm,nm,om,A(),pm),mj().location.href=qm,new Promise(()=>{})}_initialize(rm){const sm=rm._key();if(this.eventManagers[sm]){const{manager:tm,promise:um}=this.eventManagers[sm];return tm?Promise.resolve(tm):(x(um,"If manager is not set, promise should be"),um)}const vm=this.initAndGetManager(rm);return this.eventManagers[sm]={promise:vm},vm.catch(()=>{delete this.eventManagers[sm]}),vm}async initAndGetManager(wm){const xm=await Zl(wm),ym=new wl(wm);return xm.register("authEvent",a=>{v(null==a?void 0:a.authEvent,wm,"invalid-auth-event");const b=ym.onEvent(a.authEvent);return{status:b?"ACK":"ERROR"}},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[wm._key()]={manager:ym},this.iframes[wm._key()]=xm,ym}_isIframeWebStorageSupported(zm,Am){const Bm=this.iframes[zm._key()];Bm.send(em,{type:em},a=>{var b;const c=null===(b=null==a?void 0:a[0])|| void 0===b?void 0:b[em];void 0!==c&&Am(!!c),r(zm,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(Cm){const Dm=Cm._key();return this.originValidationPromises[Dm]||(this.originValidationPromises[Dm]=Rl(Cm)),this.originValidationPromises[Dm]}get _shouldInitProactively(){return vc()||oc()||uc()}};class Em{constructor(Fm){this.factorId=Fm}_process(Gm,Hm,Im){switch(Hm.type){case"enroll":return this._finalizeEnroll(Gm,Hm.credential,Im);case"signin":return this._finalizeSignIn(Gm,Hm.credential);default:return w("unexpected MultiFactorSessionType")}}}class Jm extends Em{constructor(Km){super("phone"),this.credential=Km}static _fromCredential(Lm){return new Jm(Lm)}_finalizeEnroll(Mm,Nm,Om){var Pm;return N(Pm=Mm,"POST","/v2/accounts/mfaEnrollment:finalize",M(Pm,{idToken:Nm,displayName:Om,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}_finalizeSignIn(Qm,Rm){var Sm;return N(Sm=Qm,"POST","/v2/accounts/mfaSignIn:finalize",M(Sm,{mfaPendingCredential:Rm,phoneVerificationInfo:this.credential._makeVerificationRequest()}))}}(class{constructor(){}static assertion(Tm){return Jm._fromCredential(Tm)}}).FACTOR_ID="phone";var Um="@firebase/auth",Vm="0.19.4";class Wm{constructor(Xm){this.auth=Xm,this.internalListeners=new Map()}getUid(){var Ym;return this.assertAuthConfigured(),(null===(Ym=this.auth.currentUser)|| void 0===Ym?void 0:Ym.uid)||null}async getToken(Zm){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;const $m=await this.auth.currentUser.getIdToken(Zm);return{accessToken:$m}}addAuthTokenListener(_m){if(this.assertAuthConfigured(),!this.internalListeners.has(_m)){const an=this.auth.onIdTokenChanged(a=>{var b;_m((null===(b=a)|| void 0===b?void 0:b.stsTokenManager.accessToken)||null)});this.internalListeners.set(_m,an),this.updateProactiveRefresh()}}removeAuthTokenListener(bn){this.assertAuthConfigured();const cn=this.internalListeners.get(bn);cn&&(this.internalListeners.delete(bn),cn(),this.updateProactiveRefresh())}assertAuthConfigured(){v(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function dn(a=(0,f.Mq)()){const b=(0,f.qX)(a,"auth");return b.isInitialized()?b.getImmediate():(function(a,b){const c=(0,f.qX)(a,"auth");if(c.isInitialized()){const d=c.getImmediate(),g=c.getOptions();if((0,e.vZ)(g,null!=b?b:{}))return d;r(d,"already-initialized")}const h=c.initialize({options:b});return h})(a,{popupRedirectResolver:fm,persistence:[ek,Ei,Ki]})}d="Browser",(0,f.Xd)(new l.wA("auth",(a,{options:b})=>{const c=a.getProvider("app").getImmediate(),{apiKey:e,authDomain:f}=c.options;return(a=>{v(e&&!e.includes(":"),"invalid-api-key",{appName:a.name}),v(!(null==f?void 0:f.includes(":")),"argument-error",{appName:a.name});const c={apiKey:e,authDomain:f,clientPlatform:d,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:wc(d)},g=new xc(a,c);return(function(a,b){const c=(null==b?void 0:b.persistence)||[],d=(Array.isArray(c)?c:[c]).map(z);(null==b?void 0:b.errorMap)&&a._updateErrorMap(b.errorMap),a._initializeWithPersistence(d,null==b?void 0:b.popupRedirectResolver)})(g,b),g})(c)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((a,b,c)=>{const d=a.getProvider("auth-internal");d.initialize()})),(0,f.Xd)(new l.wA("auth-internal",a=>{var b;const c=vd(a.getProvider("auth").getImmediate());return b=c,new Wm(b)},"PRIVATE").setInstantiationMode("EXPLICIT")),(0,f.KN)(Um,Vm,function(a){switch(a){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";default:return}}(d)),(0,f.KN)(Um,Vm,"esm2017")},5321:function(a,b,c){"use strict";c.d(b,{EK:function(){return Ye},hJ:function(){return MI},"B$":function(){return NI},oe:function(){return qN},JU:function(){return OI},QT:function(){return dN},kl:function(){return jN},Xk:function(){return kN},PL:function(){return lN},UQ:function(){return mN},zN:function(){return nN},ad:function(){return qJ},nP:function(){return vN},b9:function(){return fM},cf:function(){return rN},Xo:function(){return _L},IO:function(){return NL},iE:function(){return QI},Eo:function(){return PI},Bt:function(){return uN},pl:function(){return oN},TQ:function(){return oM},r7:function(){return pN},ar:function(){return VL},qs:function(){return wN}});var d,e,f,g,h,i,j,k,l=c(2238),m=c(8463),n=c(3333),o=c(4444),p="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==c.g?c.g:"undefined"!=typeof self?self:{},q={},r=r||{},s=p||self;function t(){}function u(a){var b=typeof a;return"array"==(b="object"!=b?b:a?Array.isArray(a)?"array":b:"null")||"object"==b&&"number"==typeof a.length}function v(a){var b=typeof a;return"object"==b&&null!=a||"function"==b}function w(a,b,c){return a.call.apply(a.bind,arguments)}function x(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function y(a,b,c){return(y=Function.prototype.bind&& -1!=Function.prototype.bind.toString().indexOf("native code")?w:x).apply(null,arguments)}function z(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();return b.push.apply(b,arguments),a.apply(this,b)}}function A(a,b){function c(){}c.prototype=b.prototype,a.Z=b.prototype,a.prototype=new c,a.prototype.constructor=a,a.Vb=function(a,c,d){for(var e=Array(arguments.length-2),f=2;f<arguments.length;f++)e[f-2]=arguments[f];return b.prototype[c].apply(a,e)}}function B(){this.s=this.s,this.o=this.o}B.prototype.s=!1,B.prototype.na=function(){this.s||(this.s=!0,this.M())},B.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};const C=Array.prototype.indexOf?function(a,b){return Array.prototype.indexOf.call(a,b,void 0)}:function(a,b){if("string"==typeof a)return"string"!=typeof b||1!=b.length?-1:a.indexOf(b,0);for(let c=0;c<a.length;c++)if(c in a&&a[c]===b)return c;return -1},D=Array.prototype.forEach?function(a,b,c){Array.prototype.forEach.call(a,b,c)}:function(a,b,c){const d=a.length,e="string"==typeof a?a.split(""):a;for(let f=0;f<d;f++)f in e&&b.call(c,e[f],f,a)};function E(a){return Array.prototype.concat.apply([],arguments)}function F(a){const b=a.length;if(0<b){const c=Array(b);for(let d=0;d<b;d++)c[d]=a[d];return c}return[]}function G(a){return/^[\s\xa0]*$/.test(a)}var H=String.prototype.trim?function(a){return a.trim()}:function(a){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(a)[1]};function I(a,b){return -1!=a.indexOf(b)}function J(a,b){return a<b?-1:a>b?1:0}a:{var K=s.navigator;if(K){var L=K.userAgent;if(L){e=L;break a}}e=""}function M(a,b,c){for(const d in a)b.call(c,a[d],d,a)}function N(a){const b={};for(const c in a)b[c]=a[c];return b}var O="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function P(a,b){let c,d;for(let e=1;e<arguments.length;e++){for(c in d=arguments[e])a[c]=d[c];for(let f=0;f<O.length;f++)c=O[f],Object.prototype.hasOwnProperty.call(d,c)&&(a[c]=d[c])}}function Q(a){return Q[" "](a),a}Q[" "]=t;var R=I(e,"Opera"),S=I(e,"Trident")||I(e,"MSIE"),T=I(e,"Edge"),U=T||S,V=I(e,"Gecko")&&!(I(e.toLowerCase(),"webkit")&&!I(e,"Edge"))&&!(I(e,"Trident")||I(e,"MSIE"))&&!I(e,"Edge"),W=I(e.toLowerCase(),"webkit")&&!I(e,"Edge");function X(){var a=s.document;return a?a.documentMode:void 0}a:{var Y,Z="",$=(Y=e,V?/rv:([^\);]+)(\)|;)/.exec(Y):T?/Edge\/([\d\.]+)/.exec(Y):S?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(Y):W?/WebKit\/(\S+)/.exec(Y):R?/(?:Version)[ \/]?(\S+)/.exec(Y):void 0);if($&&(Z=$?$[1]:""),S){var _=X();if(null!=_&&_>parseFloat(Z)){f=String(_);break a}}f=Z}var aa={},ba=s.document&&S?X()||parseInt(f,10)||void 0:void 0,ca=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var a=!1,b=Object.defineProperty({},"passive",{get:function(){a=!0}});try{s.addEventListener("test",t,b),s.removeEventListener("test",t,b)}catch(c){}return a}();function da(a,b){this.type=a,this.g=this.target=b,this.defaultPrevented=!1}function ea(a,b){if(da.call(this,a?a.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,a){var c=this.type=a.type,d=a.changedTouches&&a.changedTouches.length?a.changedTouches[0]:null;if(this.target=a.target||a.srcElement,this.g=b,b=a.relatedTarget){if(V){a:{try{Q(b.nodeName);var e=!0;break a}catch(f){}e=!1}e||(b=null)}}else"mouseover"==c?b=a.fromElement:"mouseout"==c&&(b=a.toElement);this.relatedTarget=b,d?(this.clientX=void 0!==d.clientX?d.clientX:d.pageX,this.clientY=void 0!==d.clientY?d.clientY:d.pageY,this.screenX=d.screenX||0,this.screenY=d.screenY||0):(this.clientX=void 0!==a.clientX?a.clientX:a.pageX,this.clientY=void 0!==a.clientY?a.clientY:a.pageY,this.screenX=a.screenX||0,this.screenY=a.screenY||0),this.button=a.button,this.key=a.key||"",this.ctrlKey=a.ctrlKey,this.altKey=a.altKey,this.shiftKey=a.shiftKey,this.metaKey=a.metaKey,this.pointerId=a.pointerId||0,this.pointerType="string"==typeof a.pointerType?a.pointerType:fa[a.pointerType]||"",this.state=a.state,this.i=a,a.defaultPrevented&&ea.Z.h.call(this)}}da.prototype.h=function(){this.defaultPrevented=!0},A(ea,da);var fa={2:"touch",3:"pen",4:"mouse"};ea.prototype.h=function(){ea.Z.h.call(this);var a=this.i;a.preventDefault?a.preventDefault():a.returnValue=!1};var ga="closure_listenable_"+(10e5*Math.random()|0),ha=0;function ia(a,b,c,d,e){this.listener=a,this.proxy=null,this.src=b,this.type=c,this.capture=!!d,this.ia=e,this.key=++ha,this.ca=this.fa=!1}function ja(a){a.ca=!0,a.listener=null,a.proxy=null,a.src=null,a.ia=null}function ka(a){this.src=a,this.g={},this.h=0}function la(a,b){var c=b.type;if(c in a.g){var d,e=a.g[c],f=C(e,b);(d=0<=f)&&Array.prototype.splice.call(e,f,1),d&&(ja(b),0==a.g[c].length&&(delete a.g[c],a.h--))}}function ma(a,b,c,d){for(var e=0;e<a.length;++e){var f=a[e];if(!f.ca&&f.listener==b&& !!c==f.capture&&f.ia==d)return e}return -1}ka.prototype.add=function(a,b,c,d,e){var f=a.toString();(a=this.g[f])||(a=this.g[f]=[],this.h++);var g=ma(a,b,d,e);return -1<g?(b=a[g],c||(b.fa=!1)):((b=new ia(b,this.src,f,!!d,e)).fa=c,a.push(b)),b};var na="closure_lm_"+(10e5*Math.random()|0),oa={};function pa(a,b,c,d,e){if(d&&d.once)return sa(a,b,c,d,e);if(Array.isArray(b)){for(var f=0;f<b.length;f++)pa(a,b[f],c,d,e);return null}return c=za(c),a&&a[ga]?a.N(b,c,v(d)?!!d.capture:!!d,e):qa(a,b,c,!1,d,e)}function qa(a,b,c,d,e,f){if(!b)throw Error("Invalid event type");var g=v(e)?!!e.capture:!!e,h=xa(a);if(h||(a[na]=h=new ka(a)),(c=h.add(b,c,d,g,f)).proxy)return c;if(d=ra(),c.proxy=d,d.src=a,d.listener=c,a.addEventListener)ca||(e=g),void 0===e&&(e=!1),a.addEventListener(b.toString(),d,e);else if(a.attachEvent)a.attachEvent(va(b.toString()),d);else if(a.addListener&&a.removeListener)a.addListener(d);else throw Error("addEventListener and attachEvent are unavailable.");return c}function ra(){function a(c){return b.call(a.src,a.listener,c)}var b=wa;return a}function sa(a,b,c,d,e){if(Array.isArray(b)){for(var f=0;f<b.length;f++)sa(a,b[f],c,d,e);return null}return c=za(c),a&&a[ga]?a.O(b,c,v(d)?!!d.capture:!!d,e):qa(a,b,c,!0,d,e)}function ta(a,b,c,d,e){if(Array.isArray(b))for(var f=0;f<b.length;f++)ta(a,b[f],c,d,e);else(d=v(d)?!!d.capture:!!d,c=za(c),a&&a[ga])?(a=a.i,(b=String(b).toString())in a.g&& -1<(c=ma(f=a.g[b],c,d,e))&&(ja(f[c]),Array.prototype.splice.call(f,c,1),0==f.length&&(delete a.g[b],a.h--))):a&&(a=xa(a))&&(b=a.g[b.toString()],a=-1,b&&(a=ma(b,c,d,e)),(c=-1<a?b[a]:null)&&ua(c))}function ua(a){if("number"!=typeof a&&a&&!a.ca){var b=a.src;if(b&&b[ga])la(b.i,a);else{var c=a.type,d=a.proxy;b.removeEventListener?b.removeEventListener(c,d,a.capture):b.detachEvent?b.detachEvent(va(c),d):b.addListener&&b.removeListener&&b.removeListener(d),(c=xa(b))?(la(c,a),0==c.h&&(c.src=null,b[na]=null)):ja(a)}}}function va(a){return a in oa?oa[a]:oa[a]="on"+a}function wa(a,b){if(a.ca)a=!0;else{b=new ea(b,this);var c=a.listener,d=a.ia||a.src;a.fa&&ua(a),a=c.call(d,b)}return a}function xa(a){return(a=a[na])instanceof ka?a:null}var ya="__closure_events_fn_"+(10e8*Math.random()>>>0);function za(a){return"function"==typeof a?a:(a[ya]||(a[ya]=function(b){return a.handleEvent(b)}),a[ya])}function Aa(){B.call(this),this.i=new ka(this),this.P=this,this.I=null}function Ba(a,b){var c,d=a.I;if(d)for(c=[];d;d=d.I)c.push(d);if(a=a.P,d=b.type||b,"string"==typeof b)b=new da(b,a);else if(b instanceof da)b.target=b.target||a;else{var e=b;P(b=new da(d,a),e)}if(e=!0,c)for(var f=c.length-1;0<=f;f--){var g=b.g=c[f];e=Ca(g,d,!0,b)&&e}if(e=Ca(g=b.g=a,d,!0,b)&&e,e=Ca(g,d,!1,b)&&e,c)for(f=0;f<c.length;f++)e=Ca(g=b.g=c[f],d,!1,b)&&e}function Ca(a,b,c,d){if(!(b=a.i.g[String(b)]))return!0;b=b.concat();for(var e=!0,f=0;f<b.length;++f){var g=b[f];if(g&&!g.ca&&g.capture==c){var h=g.listener,i=g.ia||g.src;g.fa&&la(a.i,g),e=!1!==h.call(i,d)&&e}}return e&&!d.defaultPrevented}A(Aa,B),Aa.prototype[ga]=!0,Aa.prototype.removeEventListener=function(a,b,c,d){ta(this,a,b,c,d)},Aa.prototype.M=function(){if(Aa.Z.M.call(this),this.i){var a,b=this.i;for(a in b.g){for(var c=b.g[a],d=0;d<c.length;d++)ja(c[d]);delete b.g[a],b.h--}}this.I=null},Aa.prototype.N=function(a,b,c,d){return this.i.add(String(a),b,!1,c,d)},Aa.prototype.O=function(a,b,c,d){return this.i.add(String(a),b,!0,c,d)};var Da=s.JSON.stringify;function Ea(){var a=Qa;let b=null;return a.g&&(b=a.g,a.g=a.g.next,a.g||(a.h=null),b.next=null),b}var Fa=new class{constructor(Ga,Ha){this.i=Ga,this.j=Ha,this.h=0,this.g=null}get(){let Ia;return 0<this.h?(this.h--,Ia=this.g,this.g=Ia.next,Ia.next=null):Ia=this.i(),Ia}}(()=>new Ja,a=>a.reset());class Ja{constructor(){this.next=this.g=this.h=null}set(Ka,La){this.h=Ka,this.g=La,this.next=null}reset(){this.next=this.g=this.h=null}}function Ma(a){s.setTimeout(()=>{throw a},0)}function Na(a,b){g||Oa(),Pa||(g(),Pa=!0),Qa.add(a,b)}function Oa(){var a=s.Promise.resolve(void 0);g=function(){a.then(Ua)}}var Pa=!1,Qa=new class{constructor(){this.h=this.g=null}add(Ra,Sa){const Ta=Fa.get();Ta.set(Ra,Sa),this.h?this.h.next=Ta:this.g=Ta,this.h=Ta}};function Ua(){for(var a;a=Ea();){try{a.h.call(a.g)}catch(b){Ma(b)}var c=Fa;c.j(a),100>c.h&&(c.h++,a.next=c.g,c.g=a)}Pa=!1}function Va(a,b){Aa.call(this),this.h=a||1,this.g=b||s,this.j=y(this.kb,this),this.l=Date.now()}function Wa(a){a.da=!1,a.S&&(a.g.clearTimeout(a.S),a.S=null)}function Xa(a,b,c){if("function"==typeof a)c&&(a=y(a,c));else if(a&&"function"==typeof a.handleEvent)a=y(a.handleEvent,a);else throw Error("Invalid listener argument");return 2147483647<Number(b)?-1:s.setTimeout(a,b||0)}function Ya(a){a.g=Xa(()=>{a.g=null,a.i&&(a.i=!1,Ya(a))},a.j);const b=a.h;a.h=null,a.m.apply(null,b)}A(Va,Aa),(k=Va.prototype).da=!1,k.S=null,k.kb=function(){if(this.da){var a=Date.now()-this.l;0<a&&a<0.8*this.h?this.S=this.g.setTimeout(this.j,this.h-a):(this.S&&(this.g.clearTimeout(this.S),this.S=null),Ba(this,"tick"),this.da&&(Wa(this),this.start()))}},k.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())},k.M=function(){Va.Z.M.call(this),Wa(this),delete this.g};class Za extends B{constructor($a,_a){super(),this.m=$a,this.j=_a,this.h=null,this.i=!1,this.g=null}l(ab){this.h=arguments,this.g?this.i=!0:Ya(this)}M(){super.M(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function bb(a){B.call(this),this.h=a,this.g={}}A(bb,B);var cb=[];function db(a,b,c,d){Array.isArray(c)||(c&&(cb[0]=c.toString()),c=cb);for(var e=0;e<c.length;e++){var f=pa(b,c[e],d||a.handleEvent,!1,a.h||a);if(!f)break;a.g[f.key]=f}}function eb(a){M(a.g,function(a,b){this.g.hasOwnProperty(b)&&ua(a)},a),a.g={}}function fb(){this.g=!0}function gb(a,b,c,d){a.info(function(){return"XMLHTTP TEXT ("+b+"): "+hb(a,c)+(d?" "+d:"")})}function hb(a,b){if(!a.g)return b;if(!b)return null;try{var c=JSON.parse(b);if(c){for(a=0;a<c.length;a++)if(Array.isArray(c[a])){var d=c[a];if(!(2>d.length)){var e=d[1];if(Array.isArray(e)&&!(1>e.length)){var f=e[0];if("noop"!=f&&"stop"!=f&&"close"!=f)for(var g=1;g<e.length;g++)e[g]=""}}}}return Da(c)}catch(h){return b}}bb.prototype.M=function(){bb.Z.M.call(this),eb(this)},bb.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fb.prototype.Aa=function(){this.g=!1},fb.prototype.info=function(){};var ib={},jb=null;function kb(){return jb=jb||new Aa}function lb(a){da.call(this,ib.Ma,a)}function mb(a){const b=kb();Ba(b,new lb(b,a))}function nb(a,b){da.call(this,ib.STAT_EVENT,a),this.stat=b}function ob(a){const b=kb();Ba(b,new nb(b,a))}function pb(a,b){da.call(this,ib.Na,a),this.size=b}function qb(a,b){if("function"!=typeof a)throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){a()},b)}ib.Ma="serverreachability",A(lb,da),ib.STAT_EVENT="statevent",A(nb,da),ib.Na="timingevent",A(pb,da);var rb={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},sb={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function tb(){}function ub(a){return a.h||(a.h=a.i())}function vb(){}tb.prototype.h=null;var wb={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function xb(){da.call(this,"d")}function yb(){da.call(this,"c")}function zb(){}function Ab(a,b,c,d){this.l=a,this.j=b,this.m=c,this.X=d||1,this.V=new bb(this),this.P=Cb,a=U?125:void 0,this.W=new Va(a),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new Bb}function Bb(){this.i=null,this.g="",this.h=!1}A(xb,da),A(yb,da),A(zb,tb),zb.prototype.g=function(){return new XMLHttpRequest},zb.prototype.i=function(){return{}},h=new zb;var Cb=45000,Db={},Eb={};function Fb(a,b,c){a.K=1,a.v=ac(Wb(b)),a.s=c,a.U=!0,Gb(a,null)}function Gb(a,b){a.F=Date.now(),Kb(a),a.A=Wb(a.v);var c=a.A,d=a.X;Array.isArray(d)||(d=[String(d)]),nc(c.h,"t",d),a.C=0,c=a.l.H,a.h=new Bb,a.g=rd(a.l,c?b:null,!a.s),0<a.O&&(a.L=new Za(y(a.Ia,a,a.g),a.O)),db(a.V,a.g,"readystatechange",a.gb),b=a.H?N(a.H):{},a.s?(a.u||(a.u="POST"),b["Content-Type"]="application/x-www-form-urlencoded",a.g.ea(a.A,a.u,a.s,b)):(a.u="GET",a.g.ea(a.A,a.u,null,b)),mb(1),(function(a,b,c,d,e,f){a.info(function(){if(a.g)if(f)for(var g="",h=f.split("&"),i=0;i<h.length;i++){var j=h[i].split("=");if(1<j.length){var k=j[0];j=j[1];var l=k.split("_");g=2<=l.length&&"type"==l[1]?g+(k+"="+j+"&"):g+(k+"=redacted&")}}else g=null;else g=f;return"XMLHTTP REQ ("+d+") [attempt "+e+"]: "+b+"\n"+c+"\n"+g})})(a.j,a.u,a.A,a.m,a.X,a.s)}function Hb(a){return!!a.g&&"GET"==a.u&&2!=a.K&&a.l.Ba}function Ib(a,b,c){let d=!0,e;for(;!a.I&&a.C<c.length;)if((e=Jb(a,c))==Eb){4==b&&(a.o=4,ob(14),d=!1),gb(a.j,a.m,null,"[Incomplete Response]");break}else if(e==Db){a.o=4,ob(15),gb(a.j,a.m,c,"[Invalid Chunk]"),d=!1;break}else gb(a.j,a.m,e,null),Pb(a,e);Hb(a)&&e!=Eb&&e!=Db&&(a.h.g="",a.C=0),4!=b||0!=c.length||a.h.h||(a.o=1,ob(16),d=!1),a.i=a.i&&d,d?0<c.length&&!a.aa&&(a.aa=!0,(b=a.l).g==a&&b.$&&!b.L&&(b.h.info("Great, no buffering proxy detected. Bytes received: "+c.length),jd(b),b.L=!0,ob(11))):(gb(a.j,a.m,c,"[Invalid Chunked Response]"),Ob(a),Nb(a))}function Jb(a,b){var c=a.C,d=b.indexOf("\n",c);return -1==d?Eb:isNaN(c=Number(b.substring(c,d)))?Db:(d+=1)+c>b.length?Eb:(b=b.substr(d,c),a.C=d+c,b)}function Kb(a){a.Y=Date.now()+a.P,Lb(a,a.P)}function Lb(a,b){if(null!=a.B)throw Error("WatchDog timer not null");a.B=qb(y(a.eb,a),b)}function Mb(a){a.B&&(s.clearTimeout(a.B),a.B=null)}function Nb(a){0==a.l.G||a.I||md(a.l,a)}function Ob(a){Mb(a);var b=a.L;b&&"function"==typeof b.na&&b.na(),a.L=null,Wa(a.W),eb(a.V),a.g&&(b=a.g,a.g=null,b.abort(),b.na())}function Pb(a,b){try{var c=a.l;if(0!=c.G&&(c.g==a||xc(c.i,a))){if(c.I=a.N,!a.J&&xc(c.i,a)&&3==c.G){try{var d=c.Ca.g.parse(b)}catch(e){d=null}if(Array.isArray(d)&&3==d.length){var f=d;if(0==f[0]){a:if(!c.u){if(c.g)if(c.g.F+3000<a.F)ld(c),ad(c);else break a;id(c),ob(18)}}else c.ta=f[1],0<c.ta-c.U&&37500>f[2]&&c.N&&0==c.A&&!c.v&&(c.v=qb(y(c.ab,c),6000));if(1>=wc(c.i)&&c.ka){try{c.ka()}catch(g){}c.ka=void 0}}else od(c,11)}else if((a.J||c.g==a)&&ld(c),!G(b))for(f=c.Ca.g.parse(b),b=0;b<f.length;b++){let h=f[b];if(c.U=h[0],h=h[1],2==c.G)if("c"==h[0]){c.J=h[1],c.la=h[2];const i=h[3];null!=i&&(c.ma=i,c.h.info("VER="+c.ma));const j=h[4];null!=j&&(c.za=j,c.h.info("SVER="+c.za));const k=h[5];null!=k&&"number"==typeof k&&0<k&&(d=1.5*k,c.K=d,c.h.info("backChannelRequestTimeoutMs_="+d)),d=c;const l=a.g;if(l){const m=l.g?l.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(m){var n=d.i;!n.g&&(I(m,"spdy")||I(m,"quic")||I(m,"h2"))&&(n.j=n.l,n.g=new Set,n.h&&(yc(n,n.h),n.h=null))}if(d.D){const o=l.g?l.g.getResponseHeader("X-HTTP-Session-Id"):null;o&&(d.sa=o,_b(d.F,d.D,o))}}c.G=3,c.j&&c.j.xa(),c.$&&(c.O=Date.now()-a.F,c.h.info("Handshake RTT: "+c.O+"ms")),d=c;var p=a;if(d.oa=qd(d,d.H?d.la:null,d.W),p.J){zc(d.i,p);var q=p,r=d.K;r&&q.setTimeout(r),q.B&&(Mb(q),Kb(q)),d.g=p}else hd(d);0<c.l.length&&dd(c)}else"stop"!=h[0]&&"close"!=h[0]||od(c,7);else 3==c.G&&("stop"==h[0]||"close"==h[0]?"stop"==h[0]?od(c,7):_c(c):"noop"!=h[0]&&c.j&&c.j.wa(h),c.A=0)}}mb(4)}catch(s){}}function Qb(a,b){if(a.forEach&&"function"==typeof a.forEach)a.forEach(b,void 0);else if(u(a)||"string"==typeof a)D(a,b,void 0);else{if(a.T&&"function"==typeof a.T)var c=a.T();else if(a.R&&"function"==typeof a.R)c=void 0;else if(u(a)||"string"==typeof a){c=[];for(var d=a.length,e=0;e<d;e++)c.push(e)}else for(e in c=[],d=0,a)c[d++]=e;e=(d=(function(a){if(a.R&&"function"==typeof a.R)return a.R();if("string"==typeof a)return a.split("");if(u(a)){for(var b=[],c=a.length,d=0;d<c;d++)b.push(a[d]);return b}for(d in b=[],c=0,a)b[c++]=a[d];return b})(a)).length;for(var f=0;f<e;f++)b.call(void 0,d[f],c&&c[f],a)}}function Rb(a,b){this.h={},this.g=[],this.i=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var d=0;d<c;d+=2)this.set(arguments[d],arguments[d+1])}else if(a)if(a instanceof Rb)for(c=a.T(),d=0;d<c.length;d++)this.set(c[d],a.get(c[d]));else for(d in a)this.set(d,a[d])}function Sb(a){if(a.i!=a.g.length){for(var b=0,c=0;b<a.g.length;){var d=a.g[b];Tb(a.h,d)&&(a.g[c++]=d),b++}a.g.length=c}if(a.i!=a.g.length){var e={};for(c=b=0;b<a.g.length;)Tb(e,d=a.g[b])||(a.g[c++]=d,e[d]=1),b++;a.g.length=c}}function Tb(a,b){return Object.prototype.hasOwnProperty.call(a,b)}(k=Ab.prototype).setTimeout=function(a){this.P=a},k.gb=function(a){a=a.target;const b=this.L;b&&3==Wc(a)?b.l():this.Ia(a)},k.Ia=function(a){try{if(a==this.g)a:{const b=Wc(this.g);var c=this.g.Da();const d=this.g.ba();if(!(3>b)&&(3!=b||U||this.g&&(this.h.h||this.g.ga()||Xc(this.g)))){this.I||4!=b||7==c||(8==c||0>=d?mb(3):mb(2)),Mb(this);var e=this.g.ba();this.N=e;b:if(Hb(this)){var f=Xc(this.g);a="";var g=f.length,h=4==Wc(this.g);if(!this.h.i){if("undefined"==typeof TextDecoder){Ob(this),Nb(this);var i="";break b}this.h.i=new s.TextDecoder}for(c=0;c<g;c++)this.h.h=!0,a+=this.h.i.decode(f[c],{stream:h&&c==g-1});f.splice(0,g),this.h.g+=a,this.C=0,i=this.h.g}else i=this.g.ga();if(this.i=200==e,(function(a,b,c,d,e,f,g){a.info(function(){return"XMLHTTP RESP ("+d+") [ attempt "+e+"]: "+b+"\n"+c+"\n"+f+" "+g})})(this.j,this.u,this.A,this.m,this.X,b,e),this.i){if(this.$&&!this.J){b:{if(this.g){var j,k=this.g;if((j=k.g?k.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!G(j)){var l=j;break b}}l=null}if(e=l)gb(this.j,this.m,e,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,Pb(this,e);else{this.i=!1,this.o=3,ob(12),Ob(this),Nb(this);break a}}this.U?(Ib(this,b,i),U&&this.i&&3==b&&(db(this.V,this.W,"tick",this.fb),this.W.start())):(gb(this.j,this.m,i,null),Pb(this,i)),4==b&&Ob(this),this.i&&!this.I&&(4==b?md(this.l,this):(this.i=!1,Kb(this)))}else 400==e&&0<i.indexOf("Unknown SID")?(this.o=3,ob(12)):(this.o=0,ob(13)),Ob(this),Nb(this)}}}catch(m){}finally{}},k.fb=function(){if(this.g){var a=Wc(this.g),b=this.g.ga();this.C<b.length&&(Mb(this),Ib(this,a,b),this.i&&4!=a&&Kb(this))}},k.cancel=function(){this.I=!0,Ob(this)},k.eb=function(){this.B=null;const a=Date.now();0<=a-this.Y?((function(a,b){a.info(function(){return"TIMEOUT: "+b})})(this.j,this.A),2!=this.K&&(mb(3),ob(17)),Ob(this),this.o=2,Nb(this)):Lb(this,this.Y-a)},(k=Rb.prototype).R=function(){Sb(this);for(var a=[],b=0;b<this.g.length;b++)a.push(this.h[this.g[b]]);return a},k.T=function(){return Sb(this),this.g.concat()},k.get=function(a,b){return Tb(this.h,a)?this.h[a]:b},k.set=function(a,b){Tb(this.h,a)||(this.i++,this.g.push(a)),this.h[a]=b},k.forEach=function(a,b){for(var c=this.T(),d=0;d<c.length;d++){var e=c[d],f=this.get(e);a.call(b,f,e,this)}};var Ub=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function Vb(a,b){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,a instanceof Vb){this.g=void 0!==b?b:a.g,Xb(this,a.j),this.s=a.s,Yb(this,a.i),Zb(this,a.m),this.l=a.l,b=a.h;var c=new jc;c.i=b.i,b.g&&(c.g=new Rb(b.g),c.h=b.h),$b(this,c),this.o=a.o}else a&&(c=String(a).match(Ub))?(this.g=!!b,Xb(this,c[1]||"",!0),this.s=bc(c[2]||""),Yb(this,c[3]||"",!0),Zb(this,c[4]),this.l=bc(c[5]||"",!0),$b(this,c[6]||"",!0),this.o=bc(c[7]||"")):(this.g=!!b,this.h=new jc(null,this.g))}function Wb(a){return new Vb(a)}function Xb(a,b,c){a.j=c?bc(b,!0):b,a.j&&(a.j=a.j.replace(/:$/,""))}function Yb(a,b,c){a.i=c?bc(b,!0):b}function Zb(a,b){if(b){if(isNaN(b=Number(b))||0>b)throw Error("Bad port number "+b);a.m=b}else a.m=null}function $b(a,b,c){b instanceof jc?(a.h=b,pc(a.h,a.g)):(c||(b=cc(b,hc)),a.h=new jc(b,a.g))}function _b(a,b,c){a.h.set(b,c)}function ac(a){return _b(a,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),a}function bc(a,b){return a?b?decodeURI(a.replace(/%25/g,"%2525")):decodeURIComponent(a):""}function cc(a,b,c){return"string"==typeof a?(a=encodeURI(a).replace(b,dc),c&&(a=a.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),a):null}function dc(a){return"%"+((a=a.charCodeAt(0))>>4&15).toString(16)+(15&a).toString(16)}Vb.prototype.toString=function(){var a=[],b=this.j;b&&a.push(cc(b,ec,!0),":");var c=this.i;return(c||"file"==b)&&(a.push("//"),(b=this.s)&&a.push(cc(b,ec,!0),"@"),a.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(c=this.m)&&a.push(":",String(c))),(c=this.l)&&(this.i&&"/"!=c.charAt(0)&&a.push("/"),a.push(cc(c,"/"==c.charAt(0)?gc:fc,!0))),(c=this.h.toString())&&a.push("?",c),(c=this.o)&&a.push("#",cc(c,ic)),a.join("")};var ec=/[#\/\?@]/g,fc=/[#\?:]/g,gc=/[#\?]/g,hc=/[#\?@]/g,ic=/#/g;function jc(a,b){this.h=this.g=null,this.i=a||null,this.j=!!b}function kc(a){a.g||(a.g=new Rb,a.h=0,a.i&&(function(a,b){if(a){a=a.split("&");for(var c=0;c<a.length;c++){var d=a[c].indexOf("="),e=null;if(0<=d){var f=a[c].substring(0,d);e=a[c].substring(d+1)}else f=a[c];b(f,e?decodeURIComponent(e.replace(/\+/g," ")):"")}}})(a.i,function(b,c){a.add(decodeURIComponent(b.replace(/\+/g," ")),c)}))}function lc(a,b){kc(a),b=oc(a,b),Tb(a.g.h,b)&&(a.i=null,a.h-=a.g.get(b).length,Tb((a=a.g).h,b)&&(delete a.h[b],a.i--,a.g.length>2*a.i&&Sb(a)))}function mc(a,b){return kc(a),b=oc(a,b),Tb(a.g.h,b)}function nc(a,b,c){lc(a,b),0<c.length&&(a.i=null,a.g.set(oc(a,b),F(c)),a.h+=c.length)}function oc(a,b){return b=String(b),a.j&&(b=b.toLowerCase()),b}function pc(a,b){b&&!a.j&&(kc(a),a.i=null,a.g.forEach(function(a,b){var c=b.toLowerCase();b!=c&&(lc(this,b),nc(this,c,a))},a)),a.j=b}(k=jc.prototype).add=function(a,b){kc(this),this.i=null,a=oc(this,a);var c=this.g.get(a);return c||this.g.set(a,c=[]),c.push(b),this.h+=1,this},k.forEach=function(a,b){kc(this),this.g.forEach(function(c,d){D(c,function(c){a.call(b,c,d,this)},this)},this)},k.T=function(){kc(this);for(var a=this.g.R(),b=this.g.T(),c=[],d=0;d<b.length;d++)for(var e=a[d],f=0;f<e.length;f++)c.push(b[d]);return c},k.R=function(a){kc(this);var b=[];if("string"==typeof a)mc(this,a)&&(b=E(b,this.g.get(oc(this,a))));else{a=this.g.R();for(var c=0;c<a.length;c++)b=E(b,a[c])}return b},k.set=function(a,b){return kc(this),this.i=null,mc(this,a=oc(this,a))&&(this.h-=this.g.get(a).length),this.g.set(a,[b]),this.h+=1,this},k.get=function(a,b){return a&&0<(a=this.R(a)).length?String(a[0]):b},k.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var a=[],b=this.g.T(),c=0;c<b.length;c++){var d=b[c],e=encodeURIComponent(String(d));d=this.R(d);for(var f=0;f<d.length;f++){var g=e;""!==d[f]&&(g+="="+encodeURIComponent(String(d[f]))),a.push(g)}}return this.i=a.join("&")};var qc=class{constructor(rc,sc){this.h=rc,this.g=sc}};function tc(a){this.l=a||uc,a=s.PerformanceNavigationTiming?0<(a=s.performance.getEntriesByType("navigation")).length&&("hq"==a[0].nextHopProtocol||"h2"==a[0].nextHopProtocol):!!(s.g&&s.g.Ea&&s.g.Ea()&&s.g.Ea().Zb),this.j=a?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var uc=10;function vc(a){return!!a.h|| !!a.g&&a.g.size>=a.j}function wc(a){return a.h?1:a.g?a.g.size:0}function xc(a,b){return a.h?a.h==b:!!a.g&&a.g.has(b)}function yc(a,b){a.g?a.g.add(b):a.h=b}function zc(a,b){a.h&&a.h==b?a.h=null:a.g&&a.g.has(b)&&a.g.delete(b)}function Ac(a){if(null!=a.h)return a.i.concat(a.h.D);if(null!=a.g&&0!==a.g.size){let b=a.i;for(const c of a.g.values())b=b.concat(c.D);return b}return F(a.i)}function Bc(){}function Cc(){this.g=new Bc}function Dc(a,b,c){const d=c||"";try{Qb(a,function(a,c){let e=a;v(a)&&(e=Da(a)),b.push(d+c+"="+encodeURIComponent(e))})}catch(e){throw b.push(d+"type="+encodeURIComponent("_badmap")),e}}function Ec(a,b,c,d,e){try{b.onload=null,b.onerror=null,b.onabort=null,b.ontimeout=null,e(d)}catch(f){}}function Fc(a){this.l=a.$b||null,this.j=a.ib||!1}function Gc(a,b){Aa.call(this),this.D=a,this.u=b,this.m=void 0,this.readyState=Hc,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}tc.prototype.cancel=function(){if(this.i=Ac(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const a of this.g.values())a.cancel();this.g.clear()}},Bc.prototype.stringify=function(a){return s.JSON.stringify(a,void 0)},Bc.prototype.parse=function(a){return s.JSON.parse(a,void 0)},A(Fc,tb),Fc.prototype.g=function(){return new Gc(this.l,this.j)},d={},Fc.prototype.i=function(){return d},A(Gc,Aa);var Hc=0;function Ic(a){a.j.read().then(a.Sa.bind(a)).catch(a.ha.bind(a))}function Jc(a){a.readyState=4,a.l=null,a.j=null,a.A=null,Kc(a)}function Kc(a){a.onreadystatechange&&a.onreadystatechange.call(a)}(k=Gc.prototype).open=function(a,b){if(this.readyState!=Hc)throw this.abort(),Error("Error reopening a connection");this.C=a,this.B=b,this.readyState=1,Kc(this)},k.send=function(a){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const b={headers:this.v,method:this.C,credentials:this.m,cache:void 0};a&&(b.body=a),(this.D||s).fetch(new Request(this.B,b)).then(this.Va.bind(this),this.ha.bind(this))},k.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Jc(this)),this.readyState=Hc},k.Va=function(a){if(this.g&&(this.l=a,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=a.headers,this.readyState=2,Kc(this)),this.g&&(this.readyState=3,Kc(this),this.g)))if("arraybuffer"===this.responseType)a.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(void 0!==s.ReadableStream&&"body"in a){if(this.j=a.body.getReader(),this.u){if(this.responseType)throw Error("responseType must be empty for \"streamBinaryChunks\" mode responses.");this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;Ic(this)}else a.text().then(this.Ua.bind(this),this.ha.bind(this))},k.Sa=function(a){if(this.g){if(this.u&&a.value)this.response.push(a.value);else if(!this.u){var b=a.value?a.value:new Uint8Array(0);(b=this.A.decode(b,{stream:!a.done}))&&(this.response=this.responseText+=b)}a.done?Jc(this):Kc(this),3==this.readyState&&Ic(this)}},k.Ua=function(a){this.g&&(this.response=this.responseText=a,Jc(this))},k.Ta=function(a){this.g&&(this.response=a,Jc(this))},k.ha=function(){this.g&&Jc(this)},k.setRequestHeader=function(a,b){this.v.append(a,b)},k.getResponseHeader=function(a){return this.h?this.h.get(a.toLowerCase())||"":""},k.getAllResponseHeaders=function(){if(!this.h)return"";const a=[],b=this.h.entries();for(var c=b.next();!c.done;)c=c.value,a.push(c[0]+": "+c[1]),c=b.next();return a.join("\r\n")},Object.defineProperty(Gc.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(a){this.m=a?"include":"same-origin"}});var Lc=s.JSON.parse;function Mc(a){Aa.call(this),this.headers=new Rb,this.u=a||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=Nc,this.K=this.L=!1}A(Mc,Aa);var Nc="",Oc=/^https?$/i,Pc=["POST","PUT"];function Qc(a){return"content-type"==a.toLowerCase()}function Rc(a,b){a.h=!1,a.g&&(a.l=!0,a.g.abort(),a.l=!1),a.j=b,a.m=5,Sc(a),Uc(a)}function Sc(a){a.D||(a.D=!0,Ba(a,"complete"),Ba(a,"error"))}function Tc(a){if(a.h&& void 0!==r&&(!a.C[1]||4!=Wc(a)||2!=a.ba())){if(a.v&&4==Wc(a))Xa(a.Fa,0,a);else if(Ba(a,"readystatechange"),4==Wc(a)){a.h=!1;try{const b=a.ba();a:switch(b){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c,d,e=!0;break a;default:e=!1}if(!(c=e)){if(d=0===b){var f=String(a.H).match(Ub)[1]||null;if(!f&&s.self&&s.self.location){var g=s.self.location.protocol;f=g.substr(0,g.length-1)}d=!Oc.test(f?f.toLowerCase():"")}c=d}if(c)Ba(a,"complete"),Ba(a,"success");else{a.m=6;try{var h=2<Wc(a)?a.g.statusText:""}catch(i){h=""}a.j=h+" ["+a.ba()+"]",Sc(a)}}finally{Uc(a)}}}}function Uc(a,b){if(a.g){Vc(a);const c=a.g,d=a.C[0]?t:null;a.g=null,a.C=null,b||Ba(a,"ready");try{c.onreadystatechange=d}catch(e){}}}function Vc(a){a.g&&a.K&&(a.g.ontimeout=null),a.A&&(s.clearTimeout(a.A),a.A=null)}function Wc(a){return a.g?a.g.readyState:0}function Xc(a){try{if(!a.g)return null;if("response"in a.g)return a.g.response;switch(a.J){case Nc:case"text":return a.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in a.g)return a.g.mozResponseArrayBuffer}return null}catch(b){return null}}function Yc(a,b,c){a:{for(d in c){var d=!1;break a}d=!0}let e;d||(e="",M(c,function(a,b){e+=b,e+=":",e+=a,e+="\r\n"}),c=e,"string"==typeof a?null!=c&&encodeURIComponent(String(c)):_b(a,b,c))}function Zc(a,b,c){return c&&c.internalChannelParams?c.internalChannelParams[a]||b:b}function $c(a){this.za=0,this.l=[],this.h=new fb,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=Zc("failFast",!1,a),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=Zc("baseRetryDelayMs",5000,a),this.$a=Zc("retryDelaySeedMs",10e3,a),this.Ya=Zc("forwardChannelMaxRetries",2,a),this.ra=Zc("forwardChannelRequestTimeoutMs",20e3,a),this.qa=a&&a.xmlHttpFactory||void 0,this.Ba=a&&a.Yb||!1,this.K=void 0,this.H=a&&a.supportsCrossDomainXhr||!1,this.J="",this.i=new tc(a&&a.concurrentRequestLimit),this.Ca=new Cc,this.ja=a&&a.fastHandshake||!1,this.Ra=a&&a.Wb||!1,a&&a.Aa&&this.h.Aa(),a&&a.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&a&&a.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!a|| !1!==a.Xb}function _c(a){if(bd(a),3==a.G){var b=a.V++,c=Wb(a.F);_b(c,"SID",a.J),_b(c,"RID",b),_b(c,"TYPE","terminate"),fd(a,c),(b=new Ab(a,a.h,b,void 0)).K=2,b.v=ac(Wb(c)),c=!1,s.navigator&&s.navigator.sendBeacon&&(c=s.navigator.sendBeacon(b.v.toString(),"")),!c&&s.Image&&((new Image).src=b.v,c=!0),c||(b.g=rd(b.l,null),b.g.ea(b.v)),b.F=Date.now(),Kb(b)}pd(a)}function ad(a){a.g&&(jd(a),a.g.cancel(),a.g=null)}function bd(a){ad(a),a.u&&(s.clearTimeout(a.u),a.u=null),ld(a),a.i.cancel(),a.m&&("number"==typeof a.m&&s.clearTimeout(a.m),a.m=null)}function cd(a,b){a.l.push(new qc(a.Za++,b)),3==a.G&&dd(a)}function dd(a){vc(a.i)||a.m||(a.m=!0,Na(a.Ha,a),a.C=0)}function ed(a,b){var c;c=b?b.m:a.V++;const d=Wb(a.F);_b(d,"SID",a.J),_b(d,"RID",c),_b(d,"AID",a.U),fd(a,d),a.o&&a.s&&Yc(d,a.o,a.s),c=new Ab(a,a.h,c,a.C+1),null===a.o&&(c.H=a.s),b&&(a.l=b.D.concat(a.l)),b=gd(a,c,1000),c.setTimeout(Math.round(0.5*a.ra)+Math.round(0.5*a.ra*Math.random())),yc(a.i,c),Fb(c,d,b)}function fd(a,b){a.j&&Qb({},function(a,c){_b(b,c,a)})}function gd(a,b,c){c=Math.min(a.l.length,c);var d=a.j?y(a.j.Oa,a.j,a):null;a:{var e=a.l;let f=-1;for(;;){const g=["count="+c];-1==f?0<c?(f=e[0].h,g.push("ofs="+f)):f=0:g.push("ofs="+f);let h=!0;for(let i=0;i<c;i++){let j=e[i].h;const k=e[i].g;if(0>(j-=f))f=Math.max(0,e[i].h-100),h=!1;else try{Dc(k,g,"req"+j+"_")}catch(l){d&&d(k)}}if(h){d=g.join("&");break a}}}return a=a.l.splice(0,c),b.D=a,d}function hd(a){a.g||a.u||(a.Y=1,Na(a.Ga,a),a.A=0)}function id(a){return!a.g&&!a.u&&!(3<=a.A)&&(a.Y++,a.u=qb(y(a.Ga,a),nd(a,a.A)),a.A++,!0)}function jd(a){null!=a.B&&(s.clearTimeout(a.B),a.B=null)}function kd(a){a.g=new Ab(a,a.h,"rpc",a.Y),null===a.o&&(a.g.H=a.s),a.g.O=0;var b=Wb(a.oa);_b(b,"RID","rpc"),_b(b,"SID",a.J),_b(b,"CI",a.N?"0":"1"),_b(b,"AID",a.U),fd(a,b),_b(b,"TYPE","xmlhttp"),a.o&&a.s&&Yc(b,a.o,a.s),a.K&&a.g.setTimeout(a.K);var c=a.g;a=a.la,c.K=1,c.v=ac(Wb(b)),c.s=null,c.U=!0,Gb(c,a)}function ld(a){null!=a.v&&(s.clearTimeout(a.v),a.v=null)}function md(a,b){var c,d,e=null;if(a.g==b){ld(a),jd(a),a.g=null;var f=2}else{if(!xc(a.i,b))return;e=b.D,zc(a.i,b),f=1}if(a.I=b.N,0!=a.G){if(b.i)if(1==f){e=b.s?b.s.length:0,b=Date.now()-b.F;var g=a.C;Ba(f=kb(),new pb(f,e,b,g)),dd(a)}else hd(a);else if(3==(g=b.o)||0==g&&0<a.I||!(1==f&&(c=a,d=b,!(wc(c.i)>=c.i.j-(c.m?1:0))&&(c.m?(c.l=d.D.concat(c.l),!0):1!=c.G&&2!=c.G&&!(c.C>=(c.Xa?0:c.Ya))&&(c.m=qb(y(c.Ha,c,d),nd(c,c.C)),c.C++,!0)))||2==f&&id(a)))switch(e&&0<e.length&&((b=a.i).i=b.i.concat(e)),g){case 1:od(a,5);break;case 4:od(a,10);break;case 3:od(a,6);break;default:od(a,2)}}}function nd(a,b){let c=a.Pa+Math.floor(Math.random()*a.$a);return a.j||(c*=2),c*b}function od(a,b){if(a.h.info("Error code "+b),2==b){var c=null;a.j&&(c=null);var d=y(a.jb,a);c||(c=new Vb("//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||Xb(c,"https"),ac(c)),(function(a,b){const c=new fb;if(s.Image){const d=new Image;d.onload=z(Ec,c,d,"TestLoadImage: loaded",!0,b),d.onerror=z(Ec,c,d,"TestLoadImage: error",!1,b),d.onabort=z(Ec,c,d,"TestLoadImage: abort",!1,b),d.ontimeout=z(Ec,c,d,"TestLoadImage: timeout",!1,b),s.setTimeout(function(){d.ontimeout&&d.ontimeout()},10e3),d.src=a}else b(!1)})(c.toString(),d)}else ob(2);a.G=0,a.j&&a.j.va(b),pd(a),bd(a)}function pd(a){a.G=0,a.I=-1,a.j&&((0!=Ac(a.i).length||0!=a.l.length)&&(a.i.i.length=0,F(a.l),a.l.length=0),a.j.ua())}function qd(a,b,c){var d,e,f,g,h,i;let j=(d=c)instanceof Vb?Wb(d):new Vb(d,void 0);if(""!=j.i)b&&Yb(j,b+"."+j.i),Zb(j,j.m);else{const k=s.location;j=(e=k.protocol,f=b?b+"."+k.hostname:k.hostname,g=+k.port,h=c,i=new Vb(null,void 0),e&&Xb(i,e),f&&Yb(i,f),g&&Zb(i,g),h&&(i.l=h),i)}return a.aa&&M(a.aa,function(a,b){_b(j,b,a)}),b=a.D,c=a.sa,b&&c&&_b(j,b,c),_b(j,"VER",a.ma),fd(a,j),j}function rd(a,b,c){if(b&&!a.H)throw Error("Can't create secondary domain capable XhrIo object.");return(b=new Mc(c&&a.Ba&&!a.qa?new Fc({ib:!0}):a.qa)).L=a.H,b}function sd(){}function td(){if(S&&!(10<=Number(ba)))throw Error("Environmental error: no available transport.")}function ud(a,b){Aa.call(this),this.g=new $c(b),this.l=a,this.h=b&&b.messageUrlParams||null,a=b&&b.messageHeaders||null,b&&b.clientProtocolHeaderRequired&&(a?a["X-Client-Protocol"]="webchannel":a={"X-Client-Protocol":"webchannel"}),this.g.s=a,a=b&&b.initMessageHeaders||null,b&&b.messageContentType&&(a?a["X-WebChannel-Content-Type"]=b.messageContentType:a={"X-WebChannel-Content-Type":b.messageContentType}),b&&b.ya&&(a?a["X-WebChannel-Client-Profile"]=b.ya:a={"X-WebChannel-Client-Profile":b.ya}),this.g.P=a,(a=b&&b.httpHeadersOverwriteParam)&&!G(a)&&(this.g.o=a),this.A=b&&b.supportsCrossDomainXhr||!1,this.v=b&&b.sendRawJson||!1,(b=b&&b.httpSessionIdParam)&&!G(b)&&(this.g.D=b,null!==(a=this.h)&&b in a&&b in(a=this.h)&&delete a[b]),this.j=new xd(this)}function vd(a){xb.call(this);var b=a.__sm__;if(b){a:{for(const c in b){a=c;break a}a=void 0}(this.i=a)&&(a=this.i,b=null!==b&&a in b?b[a]:void 0),this.data=b}else this.data=a}function wd(){yb.call(this),this.status=1}function xd(a){this.g=a}(k=Mc.prototype).ea=function(a,b,c,d){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+a);b=b?b.toUpperCase():"GET",this.H=a,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():h.g(),this.C=this.u?ub(this.u):ub(h),this.g.onreadystatechange=y(this.Fa,this);try{this.F=!0,this.g.open(b,String(a),!0),this.F=!1}catch(e){Rc(this,e);return}a=c||"";const g=new Rb(this.headers);d&&Qb(d,function(a,b){g.set(b,a)}),d=(function(a){a:{var b=Qc;const c=a.length,d="string"==typeof a?a.split(""):a;for(let e=0;e<c;e++)if(e in d&&b.call(void 0,d[e],e,a)){b=e;break a}b=-1}return 0>b?null:"string"==typeof a?a.charAt(b):a[b]})(g.T()),c=s.FormData&&a instanceof s.FormData,!(0<=C(Pc,b))||d||c||g.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),g.forEach(function(a,b){this.g.setRequestHeader(b,a)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{var i;Vc(this),0<this.B&&((this.K=(i=this.g,S&&(function(a){var b=aa;return Object.prototype.hasOwnProperty.call(b,9)?b[9]:b[9]=a(9)})(function(){let a=0;const b=H(String(f)).split("."),c=H("9").split("."),d=Math.max(b.length,c.length);for(let e=0;0==a&&e<d;e++){var g=b[e]||"",h=c[e]||"";do{if(g=/(\d*)(\D*)(.*)/.exec(g)||["","","",""],h=/(\d*)(\D*)(.*)/.exec(h)||["","","",""],0==g[0].length&&0==h[0].length)break;a=J(0==g[1].length?0:parseInt(g[1],10),0==h[1].length?0:parseInt(h[1],10))||J(0==g[2].length,0==h[2].length)||J(g[2],h[2]),g=g[3],h=h[3]}while(0==a)}return 0<=a})&&"number"==typeof i.timeout&& void 0!==i.ontimeout))?(this.g.timeout=this.B,this.g.ontimeout=y(this.pa,this)):this.A=Xa(this.pa,this.B,this)),this.v=!0,this.g.send(a),this.v=!1}catch(j){Rc(this,j)}},k.pa=function(){void 0!==r&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,Ba(this,"timeout"),this.abort(8))},k.abort=function(a){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=a||7,Ba(this,"complete"),Ba(this,"abort"),Uc(this))},k.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),Uc(this,!0)),Mc.Z.M.call(this)},k.Fa=function(){this.s||(this.F||this.v||this.l?Tc(this):this.cb())},k.cb=function(){Tc(this)},k.ba=function(){try{return 2<Wc(this)?this.g.status:-1}catch(a){return -1}},k.ga=function(){try{return this.g?this.g.responseText:""}catch(a){return""}},k.Qa=function(a){if(this.g){var b=this.g.responseText;return a&&0==b.indexOf(a)&&(b=b.substring(a.length)),Lc(b)}},k.Da=function(){return this.m},k.La=function(){return"string"==typeof this.j?this.j:String(this.j)},(k=$c.prototype).ma=8,k.G=1,k.hb=function(a){try{this.h.info("Origin Trials invoked: "+a)}catch(b){}},k.Ha=function(a){if(this.m)if(this.m=null,1==this.G){if(!a){this.V=Math.floor(10e4*Math.random()),a=this.V++;const b=new Ab(this,this.h,a,void 0);let c=this.s;if(this.P&&(c?P(c=N(c),this.P):c=this.P),null===this.o&&(b.H=c),this.ja)a:{for(var d=0,e=0;e<this.l.length;e++){b:{var f=this.l[e];if("__data__"in f.g&&"string"==typeof(f=f.g.__data__)){f=f.length;break b}f=void 0}if(void 0===f)break;if(4096<(d+=f)){d=e;break a}if(4096===d||e===this.l.length-1){d=e+1;break a}}d=1000}else d=1000;d=gd(this,b,d),_b(e=Wb(this.F),"RID",a),_b(e,"CVER",22),this.D&&_b(e,"X-HTTP-Session-Id",this.D),fd(this,e),this.o&&c&&Yc(e,this.o,c),yc(this.i,b),this.Ra&&_b(e,"TYPE","init"),this.ja?(_b(e,"$req",d),_b(e,"SID","null"),b.$=!0,Fb(b,e,null)):Fb(b,e,d),this.G=2}}else 3==this.G&&(a?ed(this,a):0==this.l.length||vc(this.i)||ed(this))},k.Ga=function(){if(this.u=null,kd(this),this.$&&!(this.L||null==this.g||0>=this.O)){var a=2*this.O;this.h.info("BP detection timer enabled: "+a),this.B=qb(y(this.bb,this),a)}},k.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,ob(10),ad(this),kd(this))},k.ab=function(){null!=this.v&&(this.v=null,ad(this),id(this),ob(19))},k.jb=function(a){a?(this.h.info("Successfully pinged google.com"),ob(2)):(this.h.info("Failed to ping google.com"),ob(1))},(k=sd.prototype).xa=function(){},k.wa=function(){},k.va=function(){},k.ua=function(){},k.Oa=function(){},td.prototype.g=function(a,b){return new ud(a,b)},A(ud,Aa),ud.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var a=this.g,b=this.l,c=this.h||void 0;a.Wa&&(a.h.info("Origin Trials enabled."),Na(y(a.hb,a,b))),ob(0),a.W=b,a.aa=c||{},a.N=a.X,a.F=qd(a,null,a.W),dd(a)},ud.prototype.close=function(){_c(this.g)},ud.prototype.u=function(a){if("string"==typeof a){var b={};b.__data__=a,cd(this.g,b)}else this.v?((b={}).__data__=Da(a),cd(this.g,b)):cd(this.g,a)},ud.prototype.M=function(){this.g.j=null,delete this.j,_c(this.g),delete this.g,ud.Z.M.call(this)},A(vd,xb),A(wd,yb),A(xd,sd),xd.prototype.xa=function(){Ba(this.g,"a")},xd.prototype.wa=function(a){Ba(this.g,new vd(a))},xd.prototype.va=function(a){Ba(this.g,new wd(a))},xd.prototype.ua=function(){Ba(this.g,"b")},td.prototype.createWebChannel=td.prototype.g,ud.prototype.send=ud.prototype.u,ud.prototype.open=ud.prototype.m,ud.prototype.close=ud.prototype.close,rb.NO_ERROR=0,rb.TIMEOUT=8,rb.HTTP_ERROR=6,sb.COMPLETE="complete",vb.EventType=wb,wb.OPEN="a",wb.CLOSE="b",wb.ERROR="c",wb.MESSAGE="d",Aa.prototype.listen=Aa.prototype.N,Mc.prototype.listenOnce=Mc.prototype.O,Mc.prototype.getLastError=Mc.prototype.La,Mc.prototype.getLastErrorCode=Mc.prototype.Da,Mc.prototype.getStatus=Mc.prototype.ba,Mc.prototype.getResponseJson=Mc.prototype.Qa,Mc.prototype.getResponseText=Mc.prototype.ga,Mc.prototype.send=Mc.prototype.ea;var yd=q.createWebChannelTransport=function(){return new td},zd=q.getStatEventTarget=function(){return kb()},Ad=q.ErrorCode=rb,Bd=q.EventType=sb,Cd=q.Event=ib,Dd=q.Stat={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},Ed=q.FetchXmlHttpFactory=Fc,Fd=q.WebChannel=vb,Gd=q.XhrIo=Mc,Hd=c(4155);const Id="@firebase/firestore";class Jd{constructor(Kd){this.uid=Kd}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(Ld){return Ld.uid===this.uid}}Jd.UNAUTHENTICATED=new Jd(null),Jd.GOOGLE_CREDENTIALS=new Jd("google-credentials-uid"),Jd.FIRST_PARTY=new Jd("first-party-uid"),Jd.MOCK_USER=new Jd("mock-user");let Md="9.6.1";const Nd=new n.Yd("@firebase/firestore");function Od(){return Nd.logLevel}function Pd(a,...b){if(Nd.logLevel<=n.in.DEBUG){const c=b.map(Sd);Nd.debug(`Firestore (${Md}): ${a}`,...c)}}function Qd(a,...b){if(Nd.logLevel<=n.in.ERROR){const c=b.map(Sd);Nd.error(`Firestore (${Md}): ${a}`,...c)}}function Rd(a,...b){if(Nd.logLevel<=n.in.WARN){const c=b.map(Sd);Nd.warn(`Firestore (${Md}): ${a}`,...c)}}function Sd(a){var b;if("string"==typeof a)return a;try{return b=a,JSON.stringify(b)}catch(c){return a}}function Td(a="Unexpected state"){const b=`FIRESTORE (${Md}) INTERNAL ASSERTION FAILED: `+a;throw Qd(b),new Error(b)}function Ud(a,b){a||Td()}function Vd(a,b){return a}const Wd={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class Xd extends Error{constructor(Yd,Zd){super(Zd),this.code=Yd,this.message=Zd,this.name="FirebaseError",this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class $d{constructor(){this.promise=new Promise((a,b)=>{this.resolve=a,this.reject=b})}}class _d{constructor(ae,be){this.user=be,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${ae}`)}}class ce{getToken(){return Promise.resolve(null)}invalidateToken(){}start(de,ee){de.enqueueRetryable(()=>ee(Jd.UNAUTHENTICATED))}shutdown(){}}class fe{constructor(ge){this.t=ge,this.currentUser=Jd.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(he,ie){let je=this.i;const ke=a=>this.i!==je?(je=this.i,ie(a)):Promise.resolve();let le=new $d;this.o=()=>{this.i++,this.currentUser=this.u(),le.resolve(),le=new $d,he.enqueueRetryable(()=>ke(this.currentUser))};const me=()=>{const a=le;he.enqueueRetryable(async()=>{await a.promise,await ke(this.currentUser)})},ne=a=>{Pd("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=a,this.auth.addAuthTokenListener(this.o),me()};this.t.onInit(a=>ne(a)),setTimeout(()=>{if(!this.auth){const a=this.t.getImmediate({optional:!0});a?ne(a):(Pd("FirebaseAuthCredentialsProvider","Auth not yet detected"),le.resolve(),le=new $d)}},0),me()}getToken(){const oe=this.i,pe=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(pe).then(a=>this.i!==oe?(Pd("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):a?(Ud("string"==typeof a.accessToken),new _d(a.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){const qe=this.auth&&this.auth.getUid();return Ud(null===qe||"string"==typeof qe),new Jd(qe)}}class re{constructor(se,te,ue){this.type="FirstParty",this.user=Jd.FIRST_PARTY,this.headers=new Map,this.headers.set("X-Goog-AuthUser",te);const ve=se.auth.getAuthHeaderValueForFirstParty([]);ve&&this.headers.set("Authorization",ve),ue&&this.headers.set("X-Goog-Iam-Authorization-Token",ue)}}class we{constructor(xe,ye,ze){this.h=xe,this.l=ye,this.m=ze}getToken(){return Promise.resolve(new re(this.h,this.l,this.m))}start(Ae,Be){Ae.enqueueRetryable(()=>Be(Jd.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class Ce{constructor(De){this.value=De,this.type="AppCheck",this.headers=new Map,De&&De.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Ee{constructor(Fe){this.g=Fe,this.forceRefresh=!1,this.appCheck=null}start(Ge,He){this.o=a=>{Ge.enqueueRetryable(()=>{var b;return null!=(b=a).error&&Pd("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${b.error.message}`),He(b.token)})};const Ie=a=>{Pd("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=a,this.appCheck.addTokenListener(this.o)};this.g.onInit(a=>Ie(a)),setTimeout(()=>{if(!this.appCheck){const a=this.g.getImmediate({optional:!0});a?Ie(a):Pd("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){const Je=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(Je).then(a=>a?(Ud("string"==typeof a.token),new Ce(a.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}}class Ke{constructor(Le,Me){this.previousValue=Le,Me&&(Me.sequenceNumberHandler=a=>this.p(a),this.T=a=>Me.writeSequenceNumber(a))}p(Ne){return this.previousValue=Math.max(Ne,this.previousValue),this.previousValue}next(){const Oe=++this.previousValue;return this.T&&this.T(Oe),Oe}}function Pe(a){const b="undefined"!=typeof self&&(self.crypto||self.msCrypto),c=new Uint8Array(a);if(b&&"function"==typeof b.getRandomValues)b.getRandomValues(c);else for(let d=0;d<a;d++)c[d]=Math.floor(256*Math.random());return c}Ke.I=-1;class Qe{static A(){const Re="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",Se=Math.floor(256/Re.length)*Re.length;let Te="";for(;Te.length<20;){const Ue=Pe(40);for(let Ve=0;Ve<Ue.length;++Ve)Te.length<20&&Ue[Ve]<Se&&(Te+=Re.charAt(Ue[Ve]%Re.length))}return Te}}function We(a,b){return a<b?-1:a>b?1:0}function Xe(a,b,c){return a.length===b.length&&a.every((a,d)=>c(a,b[d]))}class Ye{constructor(Ze,$e){if(this.seconds=Ze,this.nanoseconds=$e,$e<0)throw new Xd(Wd.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+$e);if($e>=10e8)throw new Xd(Wd.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+$e);if(Ze< -62135596800)throw new Xd(Wd.INVALID_ARGUMENT,"Timestamp seconds out of range: "+Ze);if(Ze>=253402300800)throw new Xd(Wd.INVALID_ARGUMENT,"Timestamp seconds out of range: "+Ze)}static now(){return Ye.fromMillis(Date.now())}static fromDate(_e){return Ye.fromMillis(_e.getTime())}static fromMillis(af){const bf=Math.floor(af/1000);return new Ye(bf,Math.floor(10e5*(af-1000*bf)))}toDate(){return new Date(this.toMillis())}toMillis(){return 1000*this.seconds+this.nanoseconds/10e5}_compareTo(cf){return this.seconds===cf.seconds?We(this.nanoseconds,cf.nanoseconds):We(this.seconds,cf.seconds)}isEqual(df){return df.seconds===this.seconds&&df.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const ef=this.seconds- -62135596800;return String(ef).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class ff{constructor(gf){this.timestamp=gf}static fromTimestamp(hf){return new ff(hf)}static min(){return new ff(new Ye(0,0))}compareTo(jf){return this.timestamp._compareTo(jf.timestamp)}isEqual(kf){return this.timestamp.isEqual(kf.timestamp)}toMicroseconds(){return 10e5*this.timestamp.seconds+this.timestamp.nanoseconds/1000}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}function lf(a){let b=0;for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&b++;return b}function mf(a,b){for(const c in a)Object.prototype.hasOwnProperty.call(a,c)&&b(c,a[c])}function nf(a){for(const b in a)if(Object.prototype.hasOwnProperty.call(a,b))return!1;return!0}class of{constructor(pf,qf,rf){void 0===qf?qf=0:0>pf.length&&Td(),void 0===rf?rf=pf.length-0:rf>pf.length-0&&Td(),this.segments=pf,this.offset=0,this.len=rf}get length(){return this.len}isEqual(sf){return 0===of.comparator(this,sf)}child(tf){const uf=this.segments.slice(this.offset,this.limit());return tf instanceof of?tf.forEach(a=>{uf.push(a)}):uf.push(tf),this.construct(uf)}limit(){return this.offset+this.length}popFirst(vf){return vf=void 0===vf?1:vf,this.construct(this.segments,this.offset+vf,this.length-vf)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(wf){return this.segments[this.offset+wf]}isEmpty(){return 0===this.length}isPrefixOf(xf){if(xf.length<this.length)return!1;for(let yf=0;yf<this.length;yf++)if(this.get(yf)!==xf.get(yf))return!1;return!0}isImmediateParentOf(zf){if(this.length+1!==zf.length)return!1;for(let Af=0;Af<this.length;Af++)if(this.get(Af)!==zf.get(Af))return!1;return!0}forEach(Bf){for(let Cf=this.offset,Df=this.limit();Cf<Df;Cf++)Bf(this.segments[Cf])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(Ef,Ff){const Gf=Math.min(Ef.length,Ff.length);for(let Hf=0;Hf<Gf;Hf++){const If=Ef.get(Hf),Jf=Ff.get(Hf);if(If<Jf)return -1;if(If>Jf)return 1}return Ef.length<Ff.length?-1:Ef.length>Ff.length?1:0}}class Kf extends of{construct(Lf,Mf,Nf){return new Kf(Lf,Mf,Nf)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}static fromString(...Of){const Pf=[];for(const Qf of Of){if(Qf.indexOf("//")>=0)throw new Xd(Wd.INVALID_ARGUMENT,`Invalid segment (${Qf}). Paths must not contain // in them.`);Pf.push(...Qf.split("/").filter(a=>a.length>0))}return new Kf(Pf)}static emptyPath(){return new Kf([])}}const Rf=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Sf extends of{construct(Tf,Uf,Vf){return new Sf(Tf,Uf,Vf)}static isValidIdentifier(Wf){return Rf.test(Wf)}canonicalString(){return this.toArray().map(a=>(a=a.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Sf.isValidIdentifier(a)||(a="`"+a+"`"),a)).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new Sf(["__name__"])}static fromServerFormat(Xf){const Yf=[];let Zf="",$f=0;const _f=()=>{if(0===Zf.length)throw new Xd(Wd.INVALID_ARGUMENT,`Invalid field path (${Xf}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);Yf.push(Zf),Zf=""};let ag=!1;for(;$f<Xf.length;){const bg=Xf[$f];if("\\"===bg){if($f+1===Xf.length)throw new Xd(Wd.INVALID_ARGUMENT,"Path has trailing escape character: "+Xf);const cg=Xf[$f+1];if("\\"!==cg&&"."!==cg&&"`"!==cg)throw new Xd(Wd.INVALID_ARGUMENT,"Path has invalid escape sequence: "+Xf);Zf+=cg,$f+=2}else"`"===bg?(ag=!ag,$f++):"."!==bg||ag?(Zf+=bg,$f++):(_f(),$f++)}if(_f(),ag)throw new Xd(Wd.INVALID_ARGUMENT,"Unterminated ` in path: "+Xf);return new Sf(Yf)}static emptyPath(){return new Sf([])}}class dg{constructor(eg){this.fields=eg,eg.sort(Sf.comparator)}covers(fg){for(const gg of this.fields)if(gg.isPrefixOf(fg))return!0;return!1}isEqual(hg){return Xe(this.fields,hg.fields,(a,b)=>a.isEqual(b))}}class ig{constructor(jg){this.binaryString=jg}static fromBase64String(kg){const lg=atob(kg);return new ig(lg)}static fromUint8Array(mg){const ng=function(a){let b="";for(let c=0;c<a.length;++c)b+=String.fromCharCode(a[c]);return b}(mg);return new ig(ng)}toBase64(){return this.binaryString,btoa(this.binaryString)}toUint8Array(){return(function(a){const b=new Uint8Array(a.length);for(let c=0;c<a.length;c++)b[c]=a.charCodeAt(c);return b})(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(og){return We(this.binaryString,og.binaryString)}isEqual(pg){return this.binaryString===pg.binaryString}}ig.EMPTY_BYTE_STRING=new ig("");const qg=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function rg(a){if(Ud(!!a),"string"==typeof a){let b=0;const c=qg.exec(a);if(Ud(!!c),c[1]){let d=c[1];b=Number(d=(d+"000000000").substr(0,9))}const e=new Date(a);return{seconds:Math.floor(e.getTime()/1000),nanos:b}}return{seconds:sg(a.seconds),nanos:sg(a.nanos)}}function sg(a){return"number"==typeof a?a:"string"==typeof a?Number(a):0}function tg(a){return"string"==typeof a?ig.fromBase64String(a):ig.fromUint8Array(a)}function ug(a){var b,c;return"server_timestamp"===(null===(c=((null===(b=null==a?void 0:a.mapValue)|| void 0===b?void 0:b.fields)||{}).__type__)|| void 0===c?void 0:c.stringValue)}function vg(a){const b=a.mapValue.fields.__previous_value__;return ug(b)?vg(b):b}function wg(a){const b=rg(a.mapValue.fields.__local_write_time__.timestampValue);return new Ye(b.seconds,b.nanos)}function xg(a){return null==a}function yg(a){return 0===a&&1/a== -1/0}function zg(a){return"number"==typeof a&&Number.isInteger(a)&&!yg(a)&&a<=Number.MAX_SAFE_INTEGER&&a>=Number.MIN_SAFE_INTEGER}class Ag{constructor(Bg){this.path=Bg}static fromPath(Cg){return new Ag(Kf.fromString(Cg))}static fromName(Dg){return new Ag(Kf.fromString(Dg).popFirst(5))}hasCollectionId(Eg){return this.path.length>=2&&this.path.get(this.path.length-2)===Eg}isEqual(Fg){return null!==Fg&&0===Kf.comparator(this.path,Fg.path)}toString(){return this.path.toString()}static comparator(Gg,Hg){return Kf.comparator(Gg.path,Hg.path)}static isDocumentKey(Ig){return Ig.length%2==0}static fromSegments(Jg){return new Ag(new Kf(Jg.slice()))}}function Kg(a){return"nullValue"in a?0:"booleanValue"in a?1:"integerValue"in a||"doubleValue"in a?2:"timestampValue"in a?3:"stringValue"in a?5:"bytesValue"in a?6:"referenceValue"in a?7:"geoPointValue"in a?8:"arrayValue"in a?9:"mapValue"in a?ug(a)?4:10:Td()}function Lg(a,b){var c,d,e,f;const g=Kg(a);if(g!==Kg(b))return!1;switch(g){case 0:return!0;case 1:return a.booleanValue===b.booleanValue;case 4:return wg(a).isEqual(wg(b));case 3:return(function(a,b){if("string"==typeof a.timestampValue&&"string"==typeof b.timestampValue&&a.timestampValue.length===b.timestampValue.length)return a.timestampValue===b.timestampValue;const c=rg(a.timestampValue),d=rg(b.timestampValue);return c.seconds===d.seconds&&c.nanos===d.nanos})(a,b);case 5:return a.stringValue===b.stringValue;case 6:return c=a,d=b,tg(c.bytesValue).isEqual(tg(d.bytesValue));case 7:return a.referenceValue===b.referenceValue;case 8:return e=a,f=b,sg(e.geoPointValue.latitude)===sg(f.geoPointValue.latitude)&&sg(e.geoPointValue.longitude)===sg(f.geoPointValue.longitude);case 2:return(function(a,b){if("integerValue"in a&&"integerValue"in b)return sg(a.integerValue)===sg(b.integerValue);if("doubleValue"in a&&"doubleValue"in b){const c=sg(a.doubleValue),d=sg(b.doubleValue);return c===d?yg(c)===yg(d):isNaN(c)&&isNaN(d)}return!1})(a,b);case 9:return Xe(a.arrayValue.values||[],b.arrayValue.values||[],Lg);case 10:return(function(a,b){const c=a.mapValue.fields||{},d=b.mapValue.fields||{};if(lf(c)!==lf(d))return!1;for(const e in c)if(c.hasOwnProperty(e)&&(void 0===d[e]||!Lg(c[e],d[e])))return!1;return!0})(a,b);default:return Td()}}function Mg(a,b){return void 0!==(a.values||[]).find(a=>Lg(a,b))}function Ng(a,b){const c=Kg(a),d=Kg(b);if(c!==d)return We(c,d);switch(c){case 0:return 0;case 1:return We(a.booleanValue,b.booleanValue);case 2:return(function(a,b){const c=sg(a.integerValue||a.doubleValue),d=sg(b.integerValue||b.doubleValue);return c<d?-1:c>d?1:c===d?0:isNaN(c)?isNaN(d)?0:-1:1})(a,b);case 3:return Og(a.timestampValue,b.timestampValue);case 4:return Og(wg(a),wg(b));case 5:return We(a.stringValue,b.stringValue);case 6:return(function(a,b){const c=tg(a),d=tg(b);return c.compareTo(d)})(a.bytesValue,b.bytesValue);case 7:return(function(a,b){const c=a.split("/"),d=b.split("/");for(let e=0;e<c.length&&e<d.length;e++){const f=We(c[e],d[e]);if(0!==f)return f}return We(c.length,d.length)})(a.referenceValue,b.referenceValue);case 8:return(function(a,b){const c=We(sg(a.latitude),sg(b.latitude));return 0!==c?c:We(sg(a.longitude),sg(b.longitude))})(a.geoPointValue,b.geoPointValue);case 9:return(function(a,b){const c=a.values||[],d=b.values||[];for(let e=0;e<c.length&&e<d.length;++e){const f=Ng(c[e],d[e]);if(f)return f}return We(c.length,d.length)})(a.arrayValue,b.arrayValue);case 10:return(function(a,b){const c=a.fields||{},d=Object.keys(c),e=b.fields||{},f=Object.keys(e);d.sort(),f.sort();for(let g=0;g<d.length&&g<f.length;++g){const h=We(d[g],f[g]);if(0!==h)return h;const i=Ng(c[d[g]],e[f[g]]);if(0!==i)return i}return We(d.length,f.length)})(a.mapValue,b.mapValue);default:throw Td()}}function Og(a,b){if("string"==typeof a&&"string"==typeof b&&a.length===b.length)return We(a,b);const c=rg(a),d=rg(b),e=We(c.seconds,d.seconds);return 0!==e?e:We(c.nanos,d.nanos)}function Pg(a){return Qg(a)}function Qg(a){var b,c;return"nullValue"in a?"null":"booleanValue"in a?""+a.booleanValue:"integerValue"in a?""+a.integerValue:"doubleValue"in a?""+a.doubleValue:"timestampValue"in a?(function(a){const b=rg(a);return`time(${b.seconds},${b.nanos})`})(a.timestampValue):"stringValue"in a?a.stringValue:"bytesValue"in a?tg(a.bytesValue).toBase64():"referenceValue"in a?(c=a.referenceValue,Ag.fromName(c).toString()):"geoPointValue"in a?`geo(${(b=a.geoPointValue).latitude},${b.longitude})`:"arrayValue"in a?(function(a){let b="[",c=!0;for(const d of a.values||[])c?c=!1:b+=",",b+=Qg(d);return b+"]"})(a.arrayValue):"mapValue"in a?(function(a){const b=Object.keys(a.fields||{}).sort();let c="{",d=!0;for(const e of b)d?d=!1:c+=",",c+=`${e}:${Qg(a.fields[e])}`;return c+"}"})(a.mapValue):Td()}function Rg(a,b){return{referenceValue:`projects/${a.projectId}/databases/${a.database}/documents/${b.path.canonicalString()}`}}function Sg(a){return!!a&&"integerValue"in a}function Tg(a){return!!a&&"arrayValue"in a}function Ug(a){return!!a&&"nullValue"in a}function Vg(a){return!!a&&"doubleValue"in a&&isNaN(Number(a.doubleValue))}function Wg(a){return!!a&&"mapValue"in a}function Xg(a){if(a.geoPointValue)return{geoPointValue:Object.assign({},a.geoPointValue)};if(a.timestampValue&&"object"==typeof a.timestampValue)return{timestampValue:Object.assign({},a.timestampValue)};if(a.mapValue){const b={mapValue:{fields:{}}};return mf(a.mapValue.fields,(a,c)=>b.mapValue.fields[a]=Xg(c)),b}if(a.arrayValue){const c={arrayValue:{values:[]}};for(let d=0;d<(a.arrayValue.values||[]).length;++d)c.arrayValue.values[d]=Xg(a.arrayValue.values[d]);return c}return Object.assign({},a)}class Yg{constructor(Zg){this.value=Zg}static empty(){return new Yg({mapValue:{}})}field($g){if($g.isEmpty())return this.value;{let _g=this.value;for(let ah=0;ah<$g.length-1;++ah)if(!Wg(_g=(_g.mapValue.fields||{})[$g.get(ah)]))return null;return(_g=(_g.mapValue.fields||{})[$g.lastSegment()])||null}}set(bh,ch){this.getFieldsMap(bh.popLast())[bh.lastSegment()]=Xg(ch)}setAll(dh){let eh=Sf.emptyPath(),fh={},gh=[];dh.forEach((a,b)=>{if(!eh.isImmediateParentOf(b)){const c=this.getFieldsMap(eh);this.applyChanges(c,fh,gh),fh={},gh=[],eh=b.popLast()}a?fh[b.lastSegment()]=Xg(a):gh.push(b.lastSegment())});const hh=this.getFieldsMap(eh);this.applyChanges(hh,fh,gh)}delete(ih){const jh=this.field(ih.popLast());Wg(jh)&&jh.mapValue.fields&&delete jh.mapValue.fields[ih.lastSegment()]}isEqual(kh){return Lg(this.value,kh.value)}getFieldsMap(lh){let mh=this.value;mh.mapValue.fields||(mh.mapValue={fields:{}});for(let nh=0;nh<lh.length;++nh){let oh=mh.mapValue.fields[lh.get(nh)];Wg(oh)&&oh.mapValue.fields||(oh={mapValue:{fields:{}}},mh.mapValue.fields[lh.get(nh)]=oh),mh=oh}return mh.mapValue.fields}applyChanges(ph,qh,rh){for(const sh of(mf(qh,(a,b)=>ph[a]=b),rh))delete ph[sh]}clone(){return new Yg(Xg(this.value))}}function th(a){const b=[];return mf(a.fields,(a,c)=>{const d=new Sf([a]);if(Wg(c)){const e=th(c.mapValue).fields;if(0===e.length)b.push(d);else for(const f of e)b.push(d.child(f))}else b.push(d)}),new dg(b)}class uh{constructor(vh,wh,xh,yh,zh){this.key=vh,this.documentType=wh,this.version=xh,this.data=yh,this.documentState=zh}static newInvalidDocument(Ah){return new uh(Ah,0,ff.min(),Yg.empty(),0)}static newFoundDocument(Bh,Ch,Dh){return new uh(Bh,1,Ch,Dh,0)}static newNoDocument(Eh,Fh){return new uh(Eh,2,Fh,Yg.empty(),0)}static newUnknownDocument(Gh,Hh){return new uh(Gh,3,Hh,Yg.empty(),2)}convertToFoundDocument(Ih,Jh){return this.version=Ih,this.documentType=1,this.data=Jh,this.documentState=0,this}convertToNoDocument(Kh){return this.version=Kh,this.documentType=2,this.data=Yg.empty(),this.documentState=0,this}convertToUnknownDocument(Lh){return this.version=Lh,this.documentType=3,this.data=Yg.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(Mh){return Mh instanceof uh&&this.key.isEqual(Mh.key)&&this.version.isEqual(Mh.version)&&this.documentType===Mh.documentType&&this.documentState===Mh.documentState&&this.data.isEqual(Mh.data)}clone(){return new uh(this.key,this.documentType,this.version,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Nh{constructor(Oh,Ph=null,Qh=[],Rh=[],Sh=null,Th=null,Uh=null){this.path=Oh,this.collectionGroup=Ph,this.orderBy=Qh,this.filters=Rh,this.limit=Sh,this.startAt=Th,this.endAt=Uh,this.R=null}}function Vh(a,b=null,c=[],d=[],e=null,f=null,g=null){return new Nh(a,b,c,d,e,f,g)}function Wh(a){const b=Vd(a);if(null===b.R){let c=b.path.canonicalString();null!==b.collectionGroup&&(c+="|cg:"+b.collectionGroup),c+="|f:",c+=b.filters.map(a=>ki(a)).join(","),c+="|ob:",c+=b.orderBy.map(a=>{var b;return(b=a).field.canonicalString()+b.dir}).join(","),xg(b.limit)||(c+="|l:",c+=b.limit),b.startAt&&(c+="|lb:",c+=Xi(b.startAt)),b.endAt&&(c+="|ub:",c+=Xi(b.endAt)),b.R=c}return b.R}function Xh(a,b){var c,d;if(a.limit!==b.limit)return!1;if(a.orderBy.length!==b.orderBy.length)return!1;for(let e=0;e<a.orderBy.length;e++)if(!_i(a.orderBy[e],b.orderBy[e]))return!1;if(a.filters.length!==b.filters.length)return!1;for(let f=0;f<a.filters.length;f++)if(c=a.filters[f],d=b.filters[f],c.op!==d.op||!c.field.isEqual(d.field)||!Lg(c.value,d.value))return!1;return a.collectionGroup===b.collectionGroup&& !!a.path.isEqual(b.path)&& !!bj(a.startAt,b.startAt)&&bj(a.endAt,b.endAt)}function Yh(a){return Ag.isDocumentKey(a.path)&&null===a.collectionGroup&&0===a.filters.length}class Zh extends class{}{constructor($h,_h,ai){super(),this.field=$h,this.op=_h,this.value=ai}static create(bi,ci,di){return bi.isKeyField()?"in"===ci||"not-in"===ci?this.P(bi,ci,di):new li(bi,ci,di):"array-contains"===ci?new Ai(bi,di):"in"===ci?new Fi(bi,di):"not-in"===ci?new Ki(bi,di):"array-contains-any"===ci?new Pi(bi,di):new Zh(bi,ci,di)}static P(ei,fi,gi){return"in"===fi?new ri(ei,gi):new vi(ei,gi)}matches(hi){const ii=hi.data.field(this.field);return"!="===this.op?null!==ii&&this.v(Ng(ii,this.value)):null!==ii&&Kg(this.value)===Kg(ii)&&this.v(Ng(ii,this.value))}v(ji){switch(this.op){case"<":return ji<0;case"<=":return ji<=0;case"==":return 0===ji;case"!=":return 0!==ji;case">":return ji>0;case">=":return ji>=0;default:return Td()}}V(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}}function ki(a){return a.field.canonicalString()+a.op.toString()+Pg(a.value)}class li extends Zh{constructor(mi,ni,oi){super(mi,ni,oi),this.key=Ag.fromName(oi.referenceValue)}matches(pi){const qi=Ag.comparator(pi.key,this.key);return this.v(qi)}}class ri extends Zh{constructor(si,ti){super(si,"in",ti),this.keys=zi("in",ti)}matches(ui){return this.keys.some(a=>a.isEqual(ui.key))}}class vi extends Zh{constructor(wi,xi){super(wi,"not-in",xi),this.keys=zi("not-in",xi)}matches(yi){return!this.keys.some(a=>a.isEqual(yi.key))}}function zi(a,b){var c;return((null===(c=b.arrayValue)|| void 0===c?void 0:c.values)||[]).map(a=>Ag.fromName(a.referenceValue))}class Ai extends Zh{constructor(Bi,Ci){super(Bi,"array-contains",Ci)}matches(Di){const Ei=Di.data.field(this.field);return Tg(Ei)&&Mg(Ei.arrayValue,this.value)}}class Fi extends Zh{constructor(Gi,Hi){super(Gi,"in",Hi)}matches(Ii){const Ji=Ii.data.field(this.field);return null!==Ji&&Mg(this.value.arrayValue,Ji)}}class Ki extends Zh{constructor(Li,Mi){super(Li,"not-in",Mi)}matches(Ni){if(Mg(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const Oi=Ni.data.field(this.field);return null!==Oi&&!Mg(this.value.arrayValue,Oi)}}class Pi extends Zh{constructor(Qi,Ri){super(Qi,"array-contains-any",Ri)}matches(Si){const Ti=Si.data.field(this.field);return!(!Tg(Ti)||!Ti.arrayValue.values)&&Ti.arrayValue.values.some(a=>Mg(this.value.arrayValue,a))}}class Ui{constructor(Vi,Wi){this.position=Vi,this.before=Wi}}function Xi(a){return`${a.before?"b":"a"}:${a.position.map(a=>Pg(a)).join(",")}`}class Yi{constructor(Zi,$i="asc"){this.field=Zi,this.dir=$i}}function _i(a,b){return a.dir===b.dir&&a.field.isEqual(b.field)}function aj(a,b,c){let d=0;for(let e=0;e<a.position.length;e++){const f=b[e],g=a.position[e];if(d=f.field.isKeyField()?Ag.comparator(Ag.fromName(g.referenceValue),c.key):Ng(g,c.data.field(f.field)),"desc"===f.dir&&(d*=-1),0!==d)break}return a.before?d<=0:d<0}function bj(a,b){if(null===a)return null===b;if(null===b)return!1;if(a.before!==b.before||a.position.length!==b.position.length)return!1;for(let c=0;c<a.position.length;c++)if(!Lg(a.position[c],b.position[c]))return!1;return!0}class cj{constructor(dj,ej=null,fj=[],gj=[],hj=null,ij="F",jj=null,kj=null){this.path=dj,this.collectionGroup=ej,this.explicitOrderBy=fj,this.filters=gj,this.limit=hj,this.limitType=ij,this.startAt=jj,this.endAt=kj,this.S=null,this.D=null,this.startAt,this.endAt}}function lj(a){return new cj(a)}function mj(a){return!xg(a.limit)&&"F"===a.limitType}function nj(a){return!xg(a.limit)&&"L"===a.limitType}function oj(a){return a.explicitOrderBy.length>0?a.explicitOrderBy[0].field:null}function pj(a){for(const b of a.filters)if(b.V())return b.field;return null}function qj(a){return null!==a.collectionGroup}function rj(a){const b=Vd(a);if(null===b.S){b.S=[];const c=pj(b),d=oj(b);if(null!==c&&null===d)c.isKeyField()||b.S.push(new Yi(c)),b.S.push(new Yi(Sf.keyField(),"asc"));else{let e=!1;for(const f of b.explicitOrderBy)b.S.push(f),f.field.isKeyField()&&(e=!0);if(!e){const g=b.explicitOrderBy.length>0?b.explicitOrderBy[b.explicitOrderBy.length-1].dir:"asc";b.S.push(new Yi(Sf.keyField(),g))}}}return b.S}function sj(a){const b=Vd(a);if(!b.D)if("F"===b.limitType)b.D=Vh(b.path,b.collectionGroup,rj(b),b.filters,b.limit,b.startAt,b.endAt);else{const c=[];for(const d of rj(b)){const e="desc"===d.dir?"asc":"desc";c.push(new Yi(d.field,e))}const f=b.endAt?new Ui(b.endAt.position,!b.endAt.before):null,g=b.startAt?new Ui(b.startAt.position,!b.startAt.before):null;b.D=Vh(b.path,b.collectionGroup,c,b.filters,b.limit,f,g)}return b.D}function tj(a,b,c){return new cj(a.path,a.collectionGroup,a.explicitOrderBy.slice(),a.filters.slice(),b,c,a.startAt,a.endAt)}function uj(a,b){return Xh(sj(a),sj(b))&&a.limitType===b.limitType}function vj(a){return`${Wh(sj(a))}|lt:${a.limitType}`}function wj(a){var b;let c;return`Query(target=${c=(b=sj(a)).path.canonicalString(),null!==b.collectionGroup&&(c+=" collectionGroup="+b.collectionGroup),b.filters.length>0&&(c+=`, filters: [${b.filters.map(a=>{var b;return`${(b=a).field.canonicalString()} ${b.op} ${Pg(b.value)}`}).join(", ")}]`),xg(b.limit)||(c+=", limit: "+b.limit),b.orderBy.length>0&&(c+=`, orderBy: [${b.orderBy.map(a=>{var b;return b=a,`${b.field.canonicalString()} (${b.dir})`}).join(", ")}]`),b.startAt&&(c+=", startAt: "+Xi(b.startAt)),b.endAt&&(c+=", endAt: "+Xi(b.endAt)),`Target(${c})`}; limitType=${a.limitType})`}function xj(a,b){var c,d;return b.isFoundDocument()&&(function(a,b){const c=b.key.path;return null!==a.collectionGroup?b.key.hasCollectionId(a.collectionGroup)&&a.path.isPrefixOf(c):Ag.isDocumentKey(a.path)?a.path.isEqual(c):a.path.isImmediateParentOf(c)})(a,b)&&(function(a,b){for(const c of a.explicitOrderBy)if(!c.field.isKeyField()&&null===b.data.field(c.field))return!1;return!0})(a,b)&&(function(a,b){for(const c of a.filters)if(!c.matches(b))return!1;return!0})(a,b)&&(c=a,d=b,(!c.startAt||!!aj(c.startAt,rj(c),d))&&!(c.endAt&&aj(c.endAt,rj(c),d)))}function yj(a){return(b,c)=>{let d=!1;for(const e of rj(a)){const f=zj(e,b,c);if(0!==f)return f;d=d||e.field.isKeyField()}return 0}}function zj(a,b,c){const d=a.field.isKeyField()?Ag.comparator(b.key,c.key):function(a,b,c){const d=b.data.field(a),e=c.data.field(a);return null!==d&&null!==e?Ng(d,e):Td()}(a.field,b,c);switch(a.dir){case"asc":return d;case"desc":return -1*d;default:return Td()}}function Aj(a,b){if(a.C){if(isNaN(b))return{doubleValue:"NaN"};if(b===1/0)return{doubleValue:"Infinity"};if(b=== -1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yg(b)?"-0":b}}function Bj(a){return{integerValue:""+a}}function Cj(a,b){return zg(b)?Bj(b):Aj(a,b)}class Dj{constructor(){this._=void 0}}function Ej(a,b,c){return a instanceof Hj?(function(a,b){const c={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:a.seconds,nanos:a.nanoseconds}}}};return b&&(c.fields.__previous_value__=b),{mapValue:c}})(c,b):a instanceof Ij?Kj(a,b):a instanceof Lj?Nj(a,b):(function(a,b){const c=Gj(a,b),d=Rj(c)+Rj(a.N);return Sg(c)&&Sg(a.N)?Bj(d):Aj(a.k,d)})(a,b)}function Fj(a,b,c){return a instanceof Ij?Kj(a,b):a instanceof Lj?Nj(a,b):c}function Gj(a,b){var c,d;return a instanceof Oj?Sg(c=b)||(d=c)&&"doubleValue"in d?b:{integerValue:0}:null}class Hj extends Dj{}class Ij extends Dj{constructor(Jj){super(),this.elements=Jj}}function Kj(a,b){const c=Sj(b);for(const d of a.elements)c.some(a=>Lg(a,d))||c.push(d);return{arrayValue:{values:c}}}class Lj extends Dj{constructor(Mj){super(),this.elements=Mj}}function Nj(a,b){let c=Sj(b);for(const d of a.elements)c=c.filter(a=>!Lg(a,d));return{arrayValue:{values:c}}}class Oj extends Dj{constructor(Pj,Qj){super(),this.k=Pj,this.N=Qj}}function Rj(a){return sg(a.integerValue||a.doubleValue)}function Sj(a){return Tg(a)&&a.arrayValue.values?a.arrayValue.values.slice():[]}class Tj{constructor(Uj,Vj){this.field=Uj,this.transform=Vj}}class Wj{constructor(Xj,Yj){this.version=Xj,this.transformResults=Yj}}class Zj{constructor($j,_j){this.updateTime=$j,this.exists=_j}static none(){return new Zj}static exists(ak){return new Zj(void 0,ak)}static updateTime(bk){return new Zj(bk)}get isNone(){return void 0===this.updateTime&& void 0===this.exists}isEqual(ck){return this.exists===ck.exists&&(this.updateTime?!!ck.updateTime&&this.updateTime.isEqual(ck.updateTime):!ck.updateTime)}}function dk(a,b){return void 0!==a.updateTime?b.isFoundDocument()&&b.version.isEqual(a.updateTime):void 0===a.exists||a.exists===b.isFoundDocument()}class ek{}function fk(a,b,c){a instanceof kk?(function(a,b,c){const d=a.value.clone(),e=wk(a.fieldTransforms,b,c.transformResults);d.setAll(e),b.convertToFoundDocument(c.version,d).setHasCommittedMutations()})(a,b,c):a instanceof pk?(function(a,b,c){if(!dk(a.precondition,b))return void b.convertToUnknownDocument(c.version);const d=wk(a.fieldTransforms,b,c.transformResults),e=b.data;e.setAll(vk(a)),e.setAll(d),b.convertToFoundDocument(c.version,e).setHasCommittedMutations()})(a,b,c):(function(a,b,c){b.convertToNoDocument(c.version).setHasCommittedMutations()})(0,b,c)}function gk(a,b,c){var d,e;a instanceof kk?(function(a,b,c){if(dk(a.precondition,b)){const d=a.value.clone(),e=xk(a.fieldTransforms,c,b);d.setAll(e),b.convertToFoundDocument(jk(b),d).setHasLocalMutations()}})(a,b,c):a instanceof pk?(function(a,b,c){if(dk(a.precondition,b)){const d=xk(a.fieldTransforms,c,b),e=b.data;e.setAll(vk(a)),e.setAll(d),b.convertToFoundDocument(jk(b),e).setHasLocalMutations()}})(a,b,c):(d=a,e=b,dk(d.precondition,e)&&e.convertToNoDocument(ff.min()))}function hk(a,b){let c=null;for(const d of a.fieldTransforms){const e=b.data.field(d.field),f=Gj(d.transform,e||null);null!=f&&(null==c&&(c=Yg.empty()),c.set(d.field,f))}return c||null}function ik(a,b){var c,d;return a.type===b.type&& !!a.key.isEqual(b.key)&& !!a.precondition.isEqual(b.precondition)&&(c=a.fieldTransforms,d=b.fieldTransforms,!!(void 0===c&& void 0===d|| !(!c||!d)&&Xe(c,d,(a,b)=>{var c,d,e,f;return c=a,d=b,c.field.isEqual(d.field)&&(e=c.transform,f=d.transform,e instanceof Ij&&f instanceof Ij||e instanceof Lj&&f instanceof Lj?Xe(e.elements,f.elements,Lg):e instanceof Oj&&f instanceof Oj?Lg(e.N,f.N):e instanceof Hj&&f instanceof Hj)}))&&(0===a.type?a.value.isEqual(b.value):1!==a.type||a.data.isEqual(b.data)&&a.fieldMask.isEqual(b.fieldMask)))}function jk(a){return a.isFoundDocument()?a.version:ff.min()}class kk extends ek{constructor(lk,mk,nk,ok=[]){super(),this.key=lk,this.value=mk,this.precondition=nk,this.fieldTransforms=ok,this.type=0}}class pk extends ek{constructor(qk,rk,sk,tk,uk=[]){super(),this.key=qk,this.data=rk,this.fieldMask=sk,this.precondition=tk,this.fieldTransforms=uk,this.type=1}}function vk(a){const b=new Map;return a.fieldMask.fields.forEach(c=>{if(!c.isEmpty()){const d=a.data.field(c);b.set(c,d)}}),b}function wk(a,b,c){const d=new Map;Ud(a.length===c.length);for(let e=0;e<c.length;e++){const f=a[e],g=f.transform,h=b.data.field(f.field);d.set(f.field,Fj(g,h,c[e]))}return d}function xk(a,b,c){const d=new Map;for(const e of a){const f=e.transform,g=c.data.field(e.field);d.set(e.field,Ej(f,g,b))}return d}class yk extends ek{constructor(zk,Ak){super(),this.key=zk,this.precondition=Ak,this.type=2,this.fieldTransforms=[]}}class Bk extends ek{constructor(Ck,Dk){super(),this.key=Ck,this.precondition=Dk,this.type=3,this.fieldTransforms=[]}}class Ek{constructor(Fk){this.count=Fk}}function Gk(a){if(void 0===a)return Qd("GRPC error has no .code"),Wd.UNKNOWN;switch(a){case i.OK:return Wd.OK;case i.CANCELLED:return Wd.CANCELLED;case i.UNKNOWN:return Wd.UNKNOWN;case i.DEADLINE_EXCEEDED:return Wd.DEADLINE_EXCEEDED;case i.RESOURCE_EXHAUSTED:return Wd.RESOURCE_EXHAUSTED;case i.INTERNAL:return Wd.INTERNAL;case i.UNAVAILABLE:return Wd.UNAVAILABLE;case i.UNAUTHENTICATED:return Wd.UNAUTHENTICATED;case i.INVALID_ARGUMENT:return Wd.INVALID_ARGUMENT;case i.NOT_FOUND:return Wd.NOT_FOUND;case i.ALREADY_EXISTS:return Wd.ALREADY_EXISTS;case i.PERMISSION_DENIED:return Wd.PERMISSION_DENIED;case i.FAILED_PRECONDITION:return Wd.FAILED_PRECONDITION;case i.ABORTED:return Wd.ABORTED;case i.OUT_OF_RANGE:return Wd.OUT_OF_RANGE;case i.UNIMPLEMENTED:return Wd.UNIMPLEMENTED;case i.DATA_LOSS:return Wd.DATA_LOSS;default:return Td()}}(j=i||(i={}))[j.OK=0]="OK",j[j.CANCELLED=1]="CANCELLED",j[j.UNKNOWN=2]="UNKNOWN",j[j.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",j[j.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",j[j.NOT_FOUND=5]="NOT_FOUND",j[j.ALREADY_EXISTS=6]="ALREADY_EXISTS",j[j.PERMISSION_DENIED=7]="PERMISSION_DENIED",j[j.UNAUTHENTICATED=16]="UNAUTHENTICATED",j[j.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",j[j.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",j[j.ABORTED=10]="ABORTED",j[j.OUT_OF_RANGE=11]="OUT_OF_RANGE",j[j.UNIMPLEMENTED=12]="UNIMPLEMENTED",j[j.INTERNAL=13]="INTERNAL",j[j.UNAVAILABLE=14]="UNAVAILABLE",j[j.DATA_LOSS=15]="DATA_LOSS";class Hk{constructor(Ik,Jk){this.comparator=Ik,this.root=Jk||hl.EMPTY}insert(Kk,Lk){return new Hk(this.comparator,this.root.insert(Kk,Lk,this.comparator).copy(null,null,hl.BLACK,null,null))}remove(Mk){return new Hk(this.comparator,this.root.remove(Mk,this.comparator).copy(null,null,hl.BLACK,null,null))}get(Nk){let Ok=this.root;for(;!Ok.isEmpty();){const Pk=this.comparator(Nk,Ok.key);if(0===Pk)return Ok.value;Pk<0?Ok=Ok.left:Pk>0&&(Ok=Ok.right)}return null}indexOf(Qk){let Rk=0,Sk=this.root;for(;!Sk.isEmpty();){const Tk=this.comparator(Qk,Sk.key);if(0===Tk)return Rk+Sk.left.size;Tk<0?Sk=Sk.left:(Rk+=Sk.left.size+1,Sk=Sk.right)}return -1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(Uk){return this.root.inorderTraversal(Uk)}forEach(Vk){this.inorderTraversal((a,b)=>(Vk(a,b),!1))}toString(){const Wk=[];return this.inorderTraversal((a,b)=>(Wk.push(`${a}:${b}`),!1)),`{${Wk.join(", ")}}`}reverseTraversal(Xk){return this.root.reverseTraversal(Xk)}getIterator(){return new $k(this.root,null,this.comparator,!1)}getIteratorFrom(Yk){return new $k(this.root,Yk,this.comparator,!1)}getReverseIterator(){return new $k(this.root,null,this.comparator,!0)}getReverseIteratorFrom(Zk){return new $k(this.root,Zk,this.comparator,!0)}}class $k{constructor(_k,al,bl,cl){this.isReverse=cl,this.nodeStack=[];let dl=1;for(;!_k.isEmpty();)if(dl=al?bl(_k.key,al):1,cl&&(dl*=-1),dl<0)_k=this.isReverse?_k.left:_k.right;else{if(0===dl){this.nodeStack.push(_k);break}this.nodeStack.push(_k),_k=this.isReverse?_k.right:_k.left}}getNext(){let el=this.nodeStack.pop();const fl={key:el.key,value:el.value};if(this.isReverse)for(el=el.left;!el.isEmpty();)this.nodeStack.push(el),el=el.right;else for(el=el.right;!el.isEmpty();)this.nodeStack.push(el),el=el.left;return fl}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const gl=this.nodeStack[this.nodeStack.length-1];return{key:gl.key,value:gl.value}}}class hl{constructor(il,jl,kl,ll,ml){this.key=il,this.value=jl,this.color=null!=kl?kl:hl.RED,this.left=null!=ll?ll:hl.EMPTY,this.right=null!=ml?ml:hl.EMPTY,this.size=this.left.size+1+this.right.size}copy(nl,ol,pl,ql,rl){return new hl(null!=nl?nl:this.key,null!=ol?ol:this.value,null!=pl?pl:this.color,null!=ql?ql:this.left,null!=rl?rl:this.right)}isEmpty(){return!1}inorderTraversal(sl){return this.left.inorderTraversal(sl)||sl(this.key,this.value)||this.right.inorderTraversal(sl)}reverseTraversal(tl){return this.right.reverseTraversal(tl)||tl(this.key,this.value)||this.left.reverseTraversal(tl)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(ul,vl,wl){let xl=this;const yl=wl(ul,xl.key);return(xl=yl<0?xl.copy(null,null,null,xl.left.insert(ul,vl,wl),null):0===yl?xl.copy(null,vl,null,null,null):xl.copy(null,null,null,null,xl.right.insert(ul,vl,wl))).fixUp()}removeMin(){if(this.left.isEmpty())return hl.EMPTY;let zl=this;return zl.left.isRed()||zl.left.left.isRed()||(zl=zl.moveRedLeft()),(zl=zl.copy(null,null,null,zl.left.removeMin(),null)).fixUp()}remove(Al,Bl){let Cl,Dl=this;if(0>Bl(Al,Dl.key))Dl.left.isEmpty()||Dl.left.isRed()||Dl.left.left.isRed()||(Dl=Dl.moveRedLeft()),Dl=Dl.copy(null,null,null,Dl.left.remove(Al,Bl),null);else{if(Dl.left.isRed()&&(Dl=Dl.rotateRight()),Dl.right.isEmpty()||Dl.right.isRed()||Dl.right.left.isRed()||(Dl=Dl.moveRedRight()),0===Bl(Al,Dl.key)){if(Dl.right.isEmpty())return hl.EMPTY;Cl=Dl.right.min(),Dl=Dl.copy(Cl.key,Cl.value,null,null,Dl.right.removeMin())}Dl=Dl.copy(null,null,null,null,Dl.right.remove(Al,Bl))}return Dl.fixUp()}isRed(){return this.color}fixUp(){let El=this;return El.right.isRed()&&!El.left.isRed()&&(El=El.rotateLeft()),El.left.isRed()&&El.left.left.isRed()&&(El=El.rotateRight()),El.left.isRed()&&El.right.isRed()&&(El=El.colorFlip()),El}moveRedLeft(){let Fl=this.colorFlip();return Fl.right.left.isRed()&&(Fl=(Fl=(Fl=Fl.copy(null,null,null,null,Fl.right.rotateRight())).rotateLeft()).colorFlip()),Fl}moveRedRight(){let Gl=this.colorFlip();return Gl.left.left.isRed()&&(Gl=(Gl=Gl.rotateRight()).colorFlip()),Gl}rotateLeft(){const Hl=this.copy(null,null,hl.RED,null,this.right.left);return this.right.copy(null,null,this.color,Hl,null)}rotateRight(){const Il=this.copy(null,null,hl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,Il)}colorFlip(){const Jl=this.left.copy(null,null,!this.left.color,null,null),Kl=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,Jl,Kl)}checkMaxDepth(){const Ll=this.check();return Math.pow(2,Ll)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Td();if(this.right.isRed())throw Td();const Ml=this.left.check();if(Ml!==this.right.check())throw Td();return Ml+(this.isRed()?0:1)}}hl.EMPTY=null,hl.RED=!0,hl.BLACK=!1,hl.EMPTY=new class{constructor(){this.size=0}get key(){throw Td()}get value(){throw Td()}get color(){throw Td()}get left(){throw Td()}get right(){throw Td()}copy(Nl,Ol,Pl,Ql,Rl){return this}insert(Sl,Tl,Ul){return new hl(Sl,Tl)}remove(Vl,Wl){return this}isEmpty(){return!0}inorderTraversal(Xl){return!1}reverseTraversal(Yl){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Zl{constructor($l){this.comparator=$l,this.data=new Hk(this.comparator)}has(_l){return null!==this.data.get(_l)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(am){return this.data.indexOf(am)}forEach(bm){this.data.inorderTraversal((a,b)=>(bm(a),!1))}forEachInRange(cm,dm){const em=this.data.getIteratorFrom(cm[0]);for(;em.hasNext();){const fm=em.getNext();if(this.comparator(fm.key,cm[1])>=0)return;dm(fm.key)}}forEachWhile(gm,hm){let im;for(im=void 0!==hm?this.data.getIteratorFrom(hm):this.data.getIterator();im.hasNext();)if(!gm(im.getNext().key))return}firstAfterOrEqual(jm){const km=this.data.getIteratorFrom(jm);return km.hasNext()?km.getNext().key:null}getIterator(){return new zm(this.data.getIterator())}getIteratorFrom(lm){return new zm(this.data.getIteratorFrom(lm))}add(mm){return this.copy(this.data.remove(mm).insert(mm,!0))}delete(nm){return this.has(nm)?this.copy(this.data.remove(nm)):this}isEmpty(){return this.data.isEmpty()}unionWith(om){let pm=this;return pm.size<om.size&&(pm=om,om=this),om.forEach(a=>{pm=pm.add(a)}),pm}isEqual(qm){if(!(qm instanceof Zl))return!1;if(this.size!==qm.size)return!1;const rm=this.data.getIterator(),sm=qm.data.getIterator();for(;rm.hasNext();){const tm=rm.getNext().key,um=sm.getNext().key;if(0!==this.comparator(tm,um))return!1}return!0}toArray(){const vm=[];return this.forEach(a=>{vm.push(a)}),vm}toString(){const wm=[];return this.forEach(a=>wm.push(a)),"SortedSet("+wm.toString()+")"}copy(xm){const ym=new Zl(this.comparator);return ym.data=xm,ym}}class zm{constructor(Am){this.iter=Am}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}const Bm=new Hk(Ag.comparator);function Cm(){return Bm}const Dm=new Hk(Ag.comparator);function Em(){return Dm}const Fm=new Hk(Ag.comparator);function Gm(){return Fm}const Hm=new Zl(Ag.comparator);function Im(...a){let b=Hm;for(const c of a)b=b.add(c);return b}const Jm=new Zl(We);function Km(){return Jm}class Lm{constructor(Mm,Nm,Om,Pm,Qm){this.snapshotVersion=Mm,this.targetChanges=Nm,this.targetMismatches=Om,this.documentUpdates=Pm,this.resolvedLimboDocuments=Qm}static createSynthesizedRemoteEventForCurrentChange(Rm,Sm){const Tm=new Map;return Tm.set(Rm,Um.createSynthesizedTargetChangeForCurrentChange(Rm,Sm)),new Lm(ff.min(),Tm,Km(),Cm(),Im())}}class Um{constructor(Vm,Wm,Xm,Ym,Zm){this.resumeToken=Vm,this.current=Wm,this.addedDocuments=Xm,this.modifiedDocuments=Ym,this.removedDocuments=Zm}static createSynthesizedTargetChangeForCurrentChange($m,_m){return new Um(ig.EMPTY_BYTE_STRING,_m,Im(),Im(),Im())}}class an{constructor(bn,cn,dn,en){this.$=bn,this.removedTargetIds=cn,this.key=dn,this.F=en}}class fn{constructor(gn,hn){this.targetId=gn,this.O=hn}}class jn{constructor(kn,ln,mn=ig.EMPTY_BYTE_STRING,nn=null){this.state=kn,this.targetIds=ln,this.resumeToken=mn,this.cause=nn}}class on{constructor(){this.M=0,this.L=ko(),this.B=ig.EMPTY_BYTE_STRING,this.U=!1,this.q=!0}get current(){return this.U}get resumeToken(){return this.B}get K(){return 0!==this.M}get j(){return this.q}W(pn){pn.approximateByteSize()>0&&(this.q=!0,this.B=pn)}G(){let qn=Im(),rn=Im(),sn=Im();return this.L.forEach((a,b)=>{switch(b){case 0:qn=qn.add(a);break;case 2:rn=rn.add(a);break;case 1:sn=sn.add(a);break;default:Td()}}),new Um(this.B,this.U,qn,rn,sn)}H(){this.q=!1,this.L=ko()}J(tn,un){this.q=!0,this.L=this.L.insert(tn,un)}Y(vn){this.q=!0,this.L=this.L.remove(vn)}X(){this.M+=1}Z(){this.M-=1}tt(){this.q=!0,this.U=!0}}class wn{constructor(xn){this.et=xn,this.nt=new Map,this.st=Cm(),this.it=jo(),this.rt=new Zl(We)}ot(yn){for(const zn of yn.$)yn.F&&yn.F.isFoundDocument()?this.at(zn,yn.F):this.ct(zn,yn.key,yn.F);for(const An of yn.removedTargetIds)this.ct(An,yn.key,yn.F)}ut(Bn){this.forEachTarget(Bn,a=>{const b=this.ht(a);switch(Bn.state){case 0:this.lt(a)&&b.W(Bn.resumeToken);break;case 1:b.Z(),b.K||b.H(),b.W(Bn.resumeToken);break;case 2:b.Z(),b.K||this.removeTarget(a);break;case 3:this.lt(a)&&(b.tt(),b.W(Bn.resumeToken));break;case 4:this.lt(a)&&(this.ft(a),b.W(Bn.resumeToken));break;default:Td()}})}forEachTarget(Cn,Dn){Cn.targetIds.length>0?Cn.targetIds.forEach(Dn):this.nt.forEach((a,b)=>{this.lt(b)&&Dn(b)})}dt(En){const Fn=En.targetId,Gn=En.O.count,Hn=this.wt(Fn);if(Hn){const In=Hn.target;if(Yh(In))if(0===Gn){const Jn=new Ag(In.path);this.ct(Fn,Jn,uh.newNoDocument(Jn,ff.min()))}else Ud(1===Gn);else this._t(Fn)!==Gn&&(this.ft(Fn),this.rt=this.rt.add(Fn))}}gt(Kn){const Ln=new Map;this.nt.forEach((a,b)=>{const c=this.wt(b);if(c){if(a.current&&Yh(c.target)){const d=new Ag(c.target.path);null!==this.st.get(d)||this.yt(b,d)||this.ct(b,d,uh.newNoDocument(d,Kn))}a.j&&(Ln.set(b,a.G()),a.H())}});let Mn=Im();this.it.forEach((a,b)=>{let c=!0;b.forEachWhile(a=>{const b=this.wt(a);return!b||2===b.purpose||(c=!1,!1)}),c&&(Mn=Mn.add(a))});const Nn=new Lm(Kn,Ln,this.rt,this.st,Mn);return this.st=Cm(),this.it=jo(),this.rt=new Zl(We),Nn}at(On,Pn){if(this.lt(On)){const Qn=this.yt(On,Pn.key)?2:0;this.ht(On).J(Pn.key,Qn),this.st=this.st.insert(Pn.key,Pn),this.it=this.it.insert(Pn.key,this.Tt(Pn.key).add(On))}}ct(Rn,Sn,Tn){if(this.lt(Rn)){const Un=this.ht(Rn);this.yt(Rn,Sn)?Un.J(Sn,1):Un.Y(Sn),this.it=this.it.insert(Sn,this.Tt(Sn).delete(Rn)),Tn&&(this.st=this.st.insert(Sn,Tn))}}removeTarget(Vn){this.nt.delete(Vn)}_t(Wn){const Xn=this.ht(Wn).G();return this.et.getRemoteKeysForTarget(Wn).size+Xn.addedDocuments.size-Xn.removedDocuments.size}X(Yn){this.ht(Yn).X()}ht(Zn){let $n=this.nt.get(Zn);return $n||($n=new on,this.nt.set(Zn,$n)),$n}Tt(_n){let ao=this.it.get(_n);return ao||(ao=new Zl(We),this.it=this.it.insert(_n,ao)),ao}lt(bo){const co=null!==this.wt(bo);return co||Pd("WatchChangeAggregator","Detected inactive target",bo),co}wt(eo){const fo=this.nt.get(eo);return fo&&fo.K?null:this.et.Et(eo)}ft(go){this.nt.set(go,new on),this.et.getRemoteKeysForTarget(go).forEach(a=>{this.ct(go,a,null)})}yt(ho,io){return this.et.getRemoteKeysForTarget(ho).has(io)}}function jo(){return new Hk(Ag.comparator)}function ko(){return new Hk(Ag.comparator)}const lo={asc:"ASCENDING",desc:"DESCENDING"},mo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"};class no{constructor(oo,po){this.databaseId=oo,this.C=po}}function qo(a,b){return a.C?`${new Date(1000*b.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+b.nanoseconds).slice(-9)}Z`:{seconds:""+b.seconds,nanos:b.nanoseconds}}function ro(a,b){return a.C?b.toBase64():b.toUint8Array()}function so(a){return Ud(!!a),ff.fromTimestamp(function(a){const b=rg(a);return new Ye(b.seconds,b.nanos)}(a))}function to(a,b){var c;return(c=a,new Kf(["projects",c.projectId,"databases",c.database])).child("documents").child(b).canonicalString()}function uo(a){const b=Kf.fromString(a);return Ud(Lo(b)),b}function vo(a,b){return to(a.databaseId,b.path)}function wo(a,b){const c=uo(b);if(c.get(1)!==a.databaseId.projectId)throw new Xd(Wd.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+c.get(1)+" vs "+a.databaseId.projectId);if(c.get(3)!==a.databaseId.database)throw new Xd(Wd.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+c.get(3)+" vs "+a.databaseId.database);return new Ag(zo(c))}function xo(a,b){return to(a.databaseId,b)}function yo(a){return new Kf(["projects",a.databaseId.projectId,"databases",a.databaseId.database]).canonicalString()}function zo(a){return Ud(a.length>4&&"documents"===a.get(4)),a.popFirst(5)}function Ao(a,b,c){return{name:vo(a,b),fields:c.value.mapValue.fields}}function Bo(a,b){var c,d;let e;if(b instanceof kk)e={update:Ao(a,b.key,b.value)};else if(b instanceof yk)e={delete:vo(a,b.key)};else if(b instanceof pk)e={update:Ao(a,b.key,b.data),updateMask:Ko(b.fieldMask)};else{if(!(b instanceof Bk))return Td();e={verify:vo(a,b.key)}}return b.fieldTransforms.length>0&&(e.updateTransforms=b.fieldTransforms.map(a=>(function(a,b){const c=b.transform;if(c instanceof Hj)return{fieldPath:b.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(c instanceof Ij)return{fieldPath:b.field.canonicalString(),appendMissingElements:{values:c.elements}};if(c instanceof Lj)return{fieldPath:b.field.canonicalString(),removeAllFromArray:{values:c.elements}};if(c instanceof Oj)return{fieldPath:b.field.canonicalString(),increment:c.N};throw Td()})(0,a))),b.precondition.isNone||(e.currentDocument=(c=a,void 0!==(d=b.precondition).updateTime?{updateTime:qo(c,d.updateTime.toTimestamp())}:void 0!==d.exists?{exists:d.exists}:Td())),e}function Co(a,b){var c;const d=b.currentDocument?void 0!==(c=b.currentDocument).updateTime?Zj.updateTime(so(c.updateTime)):void 0!==c.exists?Zj.exists(c.exists):Zj.none():Zj.none(),e=b.updateTransforms?b.updateTransforms.map(b=>(function(a,b){let c=null;if("setToServerValue"in b)Ud("REQUEST_TIME"===b.setToServerValue),c=new Hj;else if("appendMissingElements"in b){const d=b.appendMissingElements.values||[];c=new Ij(d)}else if("removeAllFromArray"in b){const e=b.removeAllFromArray.values||[];c=new Lj(e)}else"increment"in b?c=new Oj(a,b.increment):Td();const f=Sf.fromServerFormat(b.fieldPath);return new Tj(f,c)})(a,b)):[];if(b.update){b.update.name;const f=wo(a,b.update.name),g=new Yg({mapValue:{fields:b.update.fields}});if(b.updateMask){const h=function(a){const b=a.fieldPaths||[];return new dg(b.map(a=>Sf.fromServerFormat(a)))}(b.updateMask);return new pk(f,g,h,d,e)}return new kk(f,g,d,e)}if(b.delete){const i=wo(a,b.delete);return new yk(i,d)}if(b.verify){const j=wo(a,b.verify);return new Bk(j,d)}return Td()}function Do(a){return a?void 0!==a.unaryFilter?[Jo(a)]:void 0!==a.fieldFilter?[Io(a)]:void 0!==a.compositeFilter?a.compositeFilter.filters.map(a=>Do(a)).reduce((a,b)=>a.concat(b)):Td():[]}function Eo(a){return{before:a.before,values:a.position}}function Fo(a){const b=!!a.before,c=a.values||[];return new Ui(c,b)}function Go(a){return{fieldPath:a.canonicalString()}}function Ho(a){return Sf.fromServerFormat(a.fieldPath)}function Io(a){return Zh.create(Ho(a.fieldFilter.field),function(a){switch(a){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return Td()}}(a.fieldFilter.op),a.fieldFilter.value)}function Jo(a){switch(a.unaryFilter.op){case"IS_NAN":const b=Ho(a.unaryFilter.field);return Zh.create(b,"==",{doubleValue:NaN});case"IS_NULL":const c=Ho(a.unaryFilter.field);return Zh.create(c,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const d=Ho(a.unaryFilter.field);return Zh.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const e=Ho(a.unaryFilter.field);return Zh.create(e,"!=",{nullValue:"NULL_VALUE"});default:return Td()}}function Ko(a){const b=[];return a.fields.forEach(a=>b.push(a.canonicalString())),{fieldPaths:b}}function Lo(a){return a.length>=4&&"projects"===a.get(0)&&"databases"===a.get(2)}function Mo(a){let b="";for(let c=0;c<a.length;c++)b.length>0&&(b=Oo(b)),b=No(a.get(c),b);return Oo(b)}function No(a,b){let c=b;const d=a.length;for(let e=0;e<d;e++){const f=a.charAt(e);switch(f){case"\x00":c+="\x01\x10";break;case"\x01":c+="\x01\x11";break;default:c+=f}}return c}function Oo(a){return a+"\x01\x01"}function Po(a){const b=a.length;if(Ud(b>=2),2===b)return Ud("\x01"===a.charAt(0)&&"\x01"===a.charAt(1)),Kf.emptyPath();const c=[];let d="";for(let e=0;e<b;){const f=a.indexOf("\x01",e);switch((f<0||f>g)&&Td(),a.charAt(f+1)){case"\x01":const g=a.substring(e,f);let h;0===d.length?h=g:(h=d+=g,d=""),c.push(h);break;case"\x10":d+=a.substring(e,f),d+="\x00";break;case"\x11":d+=a.substring(e,f+1);break;default:Td()}e=f+2}return new Kf(c)}class Qo{constructor(Ro,So,To){this.ownerId=Ro,this.allowTabSynchronization=So,this.leaseTimestampMs=To}}Qo.store="owner",Qo.key="owner";class Uo{constructor(Vo,Wo,Xo){this.userId=Vo,this.lastAcknowledgedBatchId=Wo,this.lastStreamToken=Xo}}Uo.store="mutationQueues",Uo.keyPath="userId";class Yo{constructor(Zo,$o,_o,ap,bp){this.userId=Zo,this.batchId=$o,this.localWriteTimeMs=_o,this.baseMutations=ap,this.mutations=bp}}Yo.store="mutations",Yo.keyPath="batchId",Yo.userMutationsIndex="userMutationsIndex",Yo.userMutationsKeyPath=["userId","batchId"];class cp{constructor(){}static prefixForUser(dp){return[dp]}static prefixForPath(ep,fp){return[ep,Mo(fp)]}static key(gp,hp,ip){return[gp,Mo(hp),ip]}}cp.store="documentMutations",cp.PLACEHOLDER=new cp;class jp{constructor(kp,lp,mp,np,op,pp){this.unknownDocument=kp,this.noDocument=lp,this.document=mp,this.hasCommittedMutations=np,this.readTime=op,this.parentPath=pp}}jp.store="remoteDocuments",jp.readTimeIndex="readTimeIndex",jp.readTimeIndexPath="readTime",jp.collectionReadTimeIndex="collectionReadTimeIndex",jp.collectionReadTimeIndexPath=["parentPath","readTime"];class qp{constructor(rp){this.byteSize=rp}}qp.store="remoteDocumentGlobal",qp.key="remoteDocumentGlobalKey";class sp{constructor(tp,up,vp,wp,xp,yp,zp){this.targetId=tp,this.canonicalId=up,this.readTime=vp,this.resumeToken=wp,this.lastListenSequenceNumber=xp,this.lastLimboFreeSnapshotVersion=yp,this.query=zp}}sp.store="targets",sp.keyPath="targetId",sp.queryTargetsIndexName="queryTargetsIndex",sp.queryTargetsKeyPath=["canonicalId","targetId"];class Ap{constructor(Bp,Cp,Dp){this.targetId=Bp,this.path=Cp,this.sequenceNumber=Dp}}Ap.store="targetDocuments",Ap.keyPath=["targetId","path"],Ap.documentTargetsIndex="documentTargetsIndex",Ap.documentTargetsKeyPath=["path","targetId"];class Ep{constructor(Fp,Gp,Hp,Ip){this.highestTargetId=Fp,this.highestListenSequenceNumber=Gp,this.lastRemoteSnapshotVersion=Hp,this.targetCount=Ip}}Ep.key="targetGlobalKey",Ep.store="targetGlobal";class Jp{constructor(Kp,Lp){this.collectionId=Kp,this.parent=Lp}}Jp.store="collectionParents",Jp.keyPath=["collectionId","parent"];class Mp{constructor(Np,Op,Pp,Qp){this.clientId=Np,this.updateTimeMs=Op,this.networkEnabled=Pp,this.inForeground=Qp}}Mp.store="clientMetadata",Mp.keyPath="clientId";class Rp{constructor(Sp,Tp,Up){this.bundleId=Sp,this.createTime=Tp,this.version=Up}}Rp.store="bundles",Rp.keyPath="bundleId";class Vp{constructor(Wp,Xp,Yp){this.name=Wp,this.readTime=Xp,this.bundledQuery=Yp}}Vp.store="namedQueries",Vp.keyPath="name";class Zp{constructor(){this.onCommittedListeners=[]}addOnCommittedListener($p){this.onCommittedListeners.push($p)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(a=>a())}}class _p{constructor(aq){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,aq(a=>{this.isDone=!0,this.result=a,this.nextCallback&&this.nextCallback(a)},a=>{this.isDone=!0,this.error=a,this.catchCallback&&this.catchCallback(a)})}catch(bq){return this.next(void 0,bq)}next(cq,dq){return this.callbackAttached&&Td(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(dq,this.error):this.wrapSuccess(cq,this.result):new _p((a,b)=>{this.nextCallback=c=>{this.wrapSuccess(cq,c).next(a,b)},this.catchCallback=c=>{this.wrapFailure(dq,c).next(a,b)}})}toPromise(){return new Promise((a,b)=>{this.next(a,b)})}wrapUserFunction(eq){try{const fq=eq();return fq instanceof _p?fq:_p.resolve(fq)}catch(gq){return _p.reject(gq)}}wrapSuccess(hq,iq){return hq?this.wrapUserFunction(()=>hq(iq)):_p.resolve(iq)}wrapFailure(jq,kq){return jq?this.wrapUserFunction(()=>jq(kq)):_p.reject(kq)}static resolve(lq){return new _p((a,b)=>{a(lq)})}static reject(mq){return new _p((a,b)=>{b(mq)})}static waitFor(nq){return new _p((a,b)=>{let c=0,d=0,e=!1;nq.forEach(f=>{++c,f.next(()=>{++d,e&&d===c&&a()},a=>b(a))}),e=!0,d===c&&a()})}static or(oq){let pq=_p.resolve(!1);for(const qq of oq)pq=pq.next(a=>a?_p.resolve(a):qq());return pq}static forEach(rq,sq){const tq=[];return rq.forEach((a,b)=>{tq.push(sq.call(this,a,b))}),this.waitFor(tq)}}class uq{constructor(vq,wq){this.action=vq,this.transaction=wq,this.aborted=!1,this.It=new $d,this.transaction.oncomplete=()=>{this.It.resolve()},this.transaction.onabort=()=>{wq.error?this.It.reject(new mr(vq,wq.error)):this.It.resolve()},this.transaction.onerror=a=>{const b=Xr(a.target.error);this.It.reject(new mr(vq,b))}}static open(xq,yq,zq,Aq){try{return new uq(yq,xq.transaction(Aq,zq))}catch(Bq){throw new mr(yq,Bq)}}get At(){return this.It.promise}abort(Cq){Cq&&this.It.reject(Cq),this.aborted||(Pd("SimpleDb","Aborting transaction:",Cq?Cq.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}store(Dq){const Eq=this.transaction.objectStore(Dq);return new qr(Eq)}}class Fq{constructor(Gq,Hq,Iq){this.name=Gq,this.version=Hq,this.Rt=Iq,12.2===Fq.Pt(getUA())&&Qd("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(Jq){return Pd("SimpleDb","Removing database:",Jq),Vr(window.indexedDB.deleteDatabase(Jq)).toPromise()}static bt(){if(!isIndexedDBAvailable())return!1;if(Fq.vt())return!0;const Kq=getUA(),Lq=Fq.Pt(Kq),Mq=0<Lq&&Lq<10,Nq=Fq.Vt(Kq),Oq=0<Nq&&Nq<4.5;return!(Kq.indexOf("MSIE ")>0||Kq.indexOf("Trident/")>0||Kq.indexOf("Edge/")>0||Mq||Oq)}static vt(){var Pq;return void 0!==Hd&&"YES"===(null===(Pq=Hd.env)|| void 0===Pq?void 0:Pq.St)}static Dt(Qq,Rq){return Qq.store(Rq)}static Pt(Sq){const Tq=Sq.match(/i(?:phone|pad|pod) os ([\d_]+)/i),Uq=Tq?Tq[1].split("_").slice(0,2).join("."):"-1";return Number(Uq)}static Vt(Vq){const Wq=Vq.match(/Android ([\d.]+)/i),Xq=Wq?Wq[1].split(".").slice(0,2).join("."):"-1";return Number(Xq)}async Ct(Yq){return this.db||(Pd("SimpleDb","Opening database:",this.name),this.db=await new Promise((a,b)=>{const c=indexedDB.open(this.name,this.version);c.onsuccess=b=>{const c=b.target.result;a(c)},c.onblocked=()=>{b(new mr(Yq,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},c.onerror=a=>{const c=a.target.error;"VersionError"===c.name?b(new Xd(Wd.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===c.name?b(new Xd(Wd.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+c)):b(new mr(Yq,c))},c.onupgradeneeded=a=>{Pd("SimpleDb","Database \""+this.name+"\" requires upgrade from version:",a.oldVersion);const b=a.target.result;this.Rt.Nt(b,c.transaction,a.oldVersion,this.version).next(()=>{Pd("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.kt&&(this.db.onversionchange=a=>this.kt(a)),this.db}xt(Zq){this.kt=Zq,this.db&&(this.db.onversionchange=a=>Zq(a))}async runTransaction($q,_q,ar,br){const cr="readonly"===_q;let dr=0;for(;;){++dr;try{this.db=await this.Ct($q);const er=uq.open(this.db,$q,cr?"readonly":"readwrite",ar),fr=br(er).catch(a=>(er.abort(a),_p.reject(a))).toPromise();return fr.catch(()=>{}),await er.At,fr}catch(gr){const hr="FirebaseError"!==gr.name&&dr<3;if(Pd("SimpleDb","Transaction failed with error:",gr.message,"Retrying:",hr),this.close(),!hr)return Promise.reject(gr)}}}close(){this.db&&this.db.close(),this.db=void 0}}class ir{constructor(jr){this.$t=jr,this.Ft=!1,this.Ot=null}get isDone(){return this.Ft}get Mt(){return this.Ot}set cursor(kr){this.$t=kr}done(){this.Ft=!0}Lt(lr){this.Ot=lr}delete(){return Vr(this.$t.delete())}}class mr extends null{constructor(nr,or){super(Wd.UNAVAILABLE,`IndexedDB transaction '${nr}' failed: ${or}`),this.name="IndexedDbTransactionError"}}function pr(a){return"IndexedDbTransactionError"===a.name}class qr{constructor(rr){this.store=rr}put(sr,tr){let ur;return void 0!==tr?(Pd("SimpleDb","PUT",this.store.name,sr,tr),ur=this.store.put(tr,sr)):(Pd("SimpleDb","PUT",this.store.name,"<auto-key>",sr),ur=this.store.put(sr)),Vr(ur)}add(vr){return Pd("SimpleDb","ADD",this.store.name,vr,vr),Vr(this.store.add(vr))}get(wr){return Vr(this.store.get(wr)).next(a=>(void 0===a&&(a=null),Pd("SimpleDb","GET",this.store.name,wr,a),a))}delete(xr){return Pd("SimpleDb","DELETE",this.store.name,xr),Vr(this.store.delete(xr))}count(){return Pd("SimpleDb","COUNT",this.store.name),Vr(this.store.count())}Bt(yr,zr){const Ar=this.cursor(this.options(yr,zr)),Br=[];return this.Ut(Ar,(a,b)=>{Br.push(b)}).next(()=>Br)}qt(Cr,Dr){Pd("SimpleDb","DELETE ALL",this.store.name);const Er=this.options(Cr,Dr);Er.Kt=!1;const Fr=this.cursor(Er);return this.Ut(Fr,(a,b,c)=>c.delete())}jt(Gr,Hr){let Ir;Hr?Ir=Gr:(Ir={},Hr=Gr);const Jr=this.cursor(Ir);return this.Ut(Jr,Hr)}Qt(Kr){const Lr=this.cursor({});return new _p((a,b)=>{Lr.onerror=a=>{const c=Xr(a.target.error);b(c)},Lr.onsuccess=b=>{const c=b.target.result;c?Kr(c.primaryKey,c.value).next(b=>{b?c.continue():a()}):a()}})}Ut(Mr,Nr){const Or=[];return new _p((a,b)=>{Mr.onerror=a=>{b(a.target.error)},Mr.onsuccess=b=>{const c=b.target.result;if(!c)return void a();const d=new ir(c),e=Nr(c.primaryKey,c.value,d);if(e instanceof _p){const f=e.catch(a=>(d.done(),_p.reject(a)));Or.push(f)}d.isDone?a():null===d.Mt?c.continue():c.continue(d.Mt)}}).next(()=>_p.waitFor(Or))}options(Pr,Qr){let Rr;return void 0!==Pr&&("string"==typeof Pr?Rr=Pr:Qr=Pr),{index:Rr,range:Qr}}cursor(Sr){let Tr="next";if(Sr.reverse&&(Tr="prev"),Sr.index){const Ur=this.store.index(Sr.index);return Sr.Kt?Ur.openKeyCursor(Sr.range,Tr):Ur.openCursor(Sr.range,Tr)}return this.store.openCursor(Sr.range,Tr)}}function Vr(a){return new _p((b,c)=>{a.onsuccess=a=>{const c=a.target.result;b(c)},a.onerror=a=>{const b=Xr(a.target.error);c(b)}})}let Wr=null;function Xr(a){const b=Fq.Pt(getUA());if(b>=12.2&&b<13){const c="An internal error was encountered in the Indexed Database server";if(a.message.indexOf(c)>=0){const d=new Xd("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${c}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Wr||(Wr=!0,setTimeout(()=>{throw d},0)),d}}return a}function Yr(a,b){const c=Vd(a);return Fq.Dt(c.Wt,b)}class Zr{constructor($r,_r,as,bs){this.batchId=$r,this.localWriteTime=_r,this.baseMutations=as,this.mutations=bs}applyToRemoteDocument(cs,ds){const es=ds.mutationResults;for(let fs=0;fs<this.mutations.length;fs++){const gs=this.mutations[fs];gs.key.isEqual(cs.key)&&fk(gs,cs,es[fs])}}applyToLocalView(hs){for(const is of this.baseMutations)is.key.isEqual(hs.key)&&gk(is,hs,this.localWriteTime);for(const js of this.mutations)js.key.isEqual(hs.key)&&gk(js,hs,this.localWriteTime)}applyToLocalDocumentSet(ks){this.mutations.forEach(a=>{const b=ks.get(a.key),c=b;this.applyToLocalView(c),b.isValidDocument()||c.convertToNoDocument(ff.min())})}keys(){return this.mutations.reduce((a,b)=>a.add(b.key),Im())}isEqual(ls){return this.batchId===ls.batchId&&Xe(this.mutations,ls.mutations,(a,b)=>ik(a,b))&&Xe(this.baseMutations,ls.baseMutations,(a,b)=>ik(a,b))}}class ms{constructor(ns,os,ps,qs){this.batch=ns,this.commitVersion=os,this.mutationResults=ps,this.docVersions=qs}static from(rs,ss,ts){Ud(rs.mutations.length===ts.length);let us=Gm();const vs=rs.mutations;for(let ws=0;ws<vs.length;ws++)us=us.insert(vs[ws].key,ts[ws].version);return new ms(rs,ss,ts,us)}}class xs{constructor(ys,zs,As,Bs,Cs=ff.min(),Ds=ff.min(),Es=ig.EMPTY_BYTE_STRING){this.target=ys,this.targetId=zs,this.purpose=As,this.sequenceNumber=Bs,this.snapshotVersion=Cs,this.lastLimboFreeSnapshotVersion=Ds,this.resumeToken=Es}withSequenceNumber(Fs){return new xs(this.target,this.targetId,this.purpose,Fs,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)}withResumeToken(Gs,Hs){return new xs(this.target,this.targetId,this.purpose,this.sequenceNumber,Hs,this.lastLimboFreeSnapshotVersion,Gs)}withLastLimboFreeSnapshotVersion(Is){return new xs(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,Is,this.resumeToken)}}function Js(a,b){const c=(b.baseMutations||[]).map(b=>Co(a.Gt,b));for(let d=0;d<b.mutations.length-1;++d){const e=b.mutations[d];if(d+1<b.mutations.length&& void 0!==b.mutations[d+1].transform){const f=b.mutations[d+1];e.updateTransforms=f.transform.fieldTransforms,b.mutations.splice(d+1,1),++d}}const g=b.mutations.map(b=>Co(a.Gt,b)),h=Ye.fromMillis(b.localWriteTimeMs);return new Zr(b.batchId,h,c,g)}class Ks{constructor(Ls,Ms,Ns){this.cacheSizeCollectionThreshold=Ls,this.percentileToCollect=Ms,this.maximumSequenceNumbersToCollect=Ns}static withCacheSize(Os){return new Ks(Os,Ks.DEFAULT_COLLECTION_PERCENTILE,Ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}Ks.DEFAULT_COLLECTION_PERCENTILE=10,Ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1000,Ks.DEFAULT=new Ks(41943040,Ks.DEFAULT_COLLECTION_PERCENTILE,Ks.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Ks.DISABLED=new Ks(-1,0,0);class Ps{constructor(Qs,Rs,Ss,Ts){this.userId=Qs,this.k=Rs,this.Jt=Ss,this.referenceDelegate=Ts,this.Yt={}}static Xt(Us,Vs,Ws,Xs){Ud(""!==Us.uid);const Ys=Us.isAuthenticated()?Us.uid:"";return new Ps(Ys,Vs,Ws,Xs)}checkEmpty(Zs){let $s=!0;const _s=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Wt(Zs).jt({index:Yo.userMutationsIndex,range:_s},(a,b,c)=>{$s=!1,c.done()}).next(()=>$s)}addMutationBatch(at,bt,ct,dt){const et=Xt(at),ft=Wt(at);return ft.add({}).next(a=>{Ud("number"==typeof a);const b=new Zr(a,bt,ct,dt),c=function(a,b,c){const d=c.baseMutations.map(b=>Bo(a.Gt,b)),e=c.mutations.map(b=>Bo(a.Gt,b));return new Yo(b,c.batchId,c.localWriteTime.toMillis(),d,e)}(this.k,this.userId,b),d=[];let e=new Zl((a,b)=>We(a.canonicalString(),b.canonicalString()));for(const f of dt){const g=cp.key(this.userId,f.key.path,a);e=e.add(f.key.path.popLast()),d.push(ft.put(c)),d.push(et.put(g,cp.PLACEHOLDER))}return e.forEach(a=>{d.push(this.Jt.addToCollectionParentIndex(at,a))}),at.addOnCommittedListener(()=>{this.Yt[a]=b.keys()}),_p.waitFor(d).next(()=>b)})}lookupMutationBatch(gt,ht){return Wt(gt).get(ht).next(a=>a?(Ud(a.userId===this.userId),Js(this.k,a)):null)}Zt(it,jt){return this.Yt[jt]?_p.resolve(this.Yt[jt]):this.lookupMutationBatch(it,jt).next(a=>{if(a){const b=a.keys();return this.Yt[jt]=b,b}return null})}getNextMutationBatchAfterBatchId(kt,lt){const mt=lt+1,nt=IDBKeyRange.lowerBound([this.userId,mt]);let ot=null;return Wt(kt).jt({index:Yo.userMutationsIndex,range:nt},(a,b,c)=>{b.userId===this.userId&&(Ud(b.batchId>=mt),ot=Js(this.k,b)),c.done()}).next(()=>ot)}getHighestUnacknowledgedBatchId(pt){const qt=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let rt=-1;return Wt(pt).jt({index:Yo.userMutationsIndex,range:qt,reverse:!0},(a,b,c)=>{rt=b.batchId,c.done()}).next(()=>rt)}getAllMutationBatches(st){const tt=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Wt(st).Bt(Yo.userMutationsIndex,tt).next(a=>a.map(a=>Js(this.k,a)))}getAllMutationBatchesAffectingDocumentKey(ut,vt){const wt=cp.prefixForPath(this.userId,vt.path),xt=IDBKeyRange.lowerBound(wt),yt=[];return Xt(ut).jt({range:xt},(a,b,c)=>{const[d,e,f]=a,g=Po(e);if(d===this.userId&&vt.path.isEqual(g))return Wt(ut).get(f).next(a=>{if(!a)throw Td();Ud(a.userId===this.userId),yt.push(Js(this.k,a))});c.done()}).next(()=>yt)}getAllMutationBatchesAffectingDocumentKeys(zt,At){let Bt=new Zl(We);const Ct=[];return At.forEach(a=>{const b=cp.prefixForPath(this.userId,a.path),c=IDBKeyRange.lowerBound(b),d=Xt(zt).jt({range:c},(b,c,d)=>{const[e,f,g]=b,h=Po(f);e===this.userId&&a.path.isEqual(h)?Bt=Bt.add(g):d.done()});Ct.push(d)}),_p.waitFor(Ct).next(()=>this.te(zt,Bt))}getAllMutationBatchesAffectingQuery(Dt,Et){const Ft=Et.path,Gt=Ft.length+1,Ht=cp.prefixForPath(this.userId,Ft),It=IDBKeyRange.lowerBound(Ht);let Jt=new Zl(We);return Xt(Dt).jt({range:It},(a,b,c)=>{const[d,e,f]=a,g=Po(e);d===this.userId&&Ft.isPrefixOf(g)?g.length===Gt&&(Jt=Jt.add(f)):c.done()}).next(()=>this.te(Dt,Jt))}te(Kt,Lt){const Mt=[],Nt=[];return Lt.forEach(a=>{Nt.push(Wt(Kt).get(a).next(a=>{if(null===a)throw Td();Ud(a.userId===this.userId),Mt.push(Js(this.k,a))}))}),_p.waitFor(Nt).next(()=>Mt)}removeMutationBatch(Ot,Pt){return(function(a,b,c){const d=a.store(Yo.store),e=a.store(cp.store),f=[],g=IDBKeyRange.only(c.batchId);let h=0;const i=d.jt({range:g},(a,b,c)=>(h++,c.delete()));f.push(i.next(()=>{Ud(1===h)}));const j=[];for(const k of c.mutations){const l=cp.key(b,k.key.path,c.batchId);f.push(e.delete(l)),j.push(k.key)}return _p.waitFor(f).next(()=>j)})(Ot.Wt,this.userId,Pt).next(a=>(Ot.addOnCommittedListener(()=>{this.ee(Pt.batchId)}),_p.forEach(a,a=>this.referenceDelegate.markPotentiallyOrphaned(Ot,a))))}ee(Qt){delete this.Yt[Qt]}performConsistencyCheck(Rt){return this.checkEmpty(Rt).next(a=>{if(!a)return _p.resolve();const b=IDBKeyRange.lowerBound(cp.prefixForUser(this.userId)),c=[];return Xt(Rt).jt({range:b},(a,b,d)=>{if(a[0]===this.userId){const e=Po(a[1]);c.push(e)}else d.done()}).next(()=>{Ud(0===c.length)})})}containsKey(St,Tt){return Vt(St,this.userId,Tt)}ne(Ut){return Yt(Ut).get(this.userId).next(a=>a||new Uo(this.userId,-1,""))}}function Vt(a,b,c){const d=cp.prefixForPath(b,c.path),e=d[1],f=IDBKeyRange.lowerBound(d);let g=!1;return Xt(a).jt({range:f,Kt:!0},(a,c,d)=>{const[f,h,i]=a;f===b&&h===e&&(g=!0),d.done()}).next(()=>g)}function Wt(a){return Yr(a,Yo.store)}function Xt(a){return Yr(a,cp.store)}function Yt(a){return Yr(a,Uo.store)}class Zt{constructor($t){this.se=$t}next(){return this.se+=2,this.se}static ie(){return new Zt(0)}static re(){return new Zt(-1)}}async function _t(a){if(a.code!==Wd.FAILED_PRECONDITION||"The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab."!==a.message)throw a;Pd("LocalStore","Unexpectedly lost primary lease")}class au{constructor(bu,cu){this.mapKeyFn=bu,this.equalsFn=cu,this.inner={}}get(du){const eu=this.mapKeyFn(du),fu=this.inner[eu];if(void 0!==fu){for(const[gu,hu]of fu)if(this.equalsFn(gu,du))return hu}}has(iu){return void 0!==this.get(iu)}set(ju,ku){const lu=this.mapKeyFn(ju),mu=this.inner[lu];if(void 0!==mu){for(let nu=0;nu<mu.length;nu++)if(this.equalsFn(mu[nu][0],ju))return void(mu[nu]=[ju,ku]);mu.push([ju,ku])}else this.inner[lu]=[[ju,ku]]}delete(ou){const pu=this.mapKeyFn(ou),qu=this.inner[pu];if(void 0===qu)return!1;for(let ru=0;ru<qu.length;ru++)if(this.equalsFn(qu[ru][0],ou))return 1===qu.length?delete this.inner[pu]:qu.splice(ru,1),!0;return!1}forEach(su){mf(this.inner,(a,b)=>{for(const[c,d]of b)su(c,d)})}isEmpty(){return nf(this.inner)}}class tu{constructor(){this.changes=new au(a=>a.toString(),(a,b)=>a.isEqual(b)),this.changesApplied=!1}getReadTime(uu){const vu=this.changes.get(uu);return vu?vu.readTime:ff.min()}addEntry(wu,xu){this.assertNotApplied(),this.changes.set(wu.key,{document:wu,readTime:xu})}removeEntry(yu,zu=null){this.assertNotApplied(),this.changes.set(yu,{document:uh.newInvalidDocument(yu),readTime:zu})}getEntry(Au,Bu){this.assertNotApplied();const Cu=this.changes.get(Bu);return void 0!==Cu?_p.resolve(Cu.document):this.getFromCache(Au,Bu)}getEntries(Du,Eu){return this.getAllFromCache(Du,Eu)}apply(Fu){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(Fu)}assertNotApplied(){}}class Gu{constructor(Hu,Iu,Ju){this.Je=Hu,this.An=Iu,this.Jt=Ju}Rn(Ku,Lu){return this.An.getAllMutationBatchesAffectingDocumentKey(Ku,Lu).next(a=>this.Pn(Ku,Lu,a))}Pn(Mu,Nu,Ou){return this.Je.getEntry(Mu,Nu).next(a=>{for(const b of Ou)b.applyToLocalView(a);return a})}bn(Pu,Qu){Pu.forEach((a,b)=>{for(const c of Qu)c.applyToLocalView(b)})}vn(Ru,Su){return this.Je.getEntries(Ru,Su).next(a=>this.Vn(Ru,a).next(()=>a))}Vn(Tu,Uu){return this.An.getAllMutationBatchesAffectingDocumentKeys(Tu,Uu).next(a=>this.bn(Uu,a))}getDocumentsMatchingQuery(Vu,Wu,Xu){var Yu;return(Yu=Wu,Ag.isDocumentKey(Yu.path)&&null===Yu.collectionGroup&&0===Yu.filters.length)?this.Sn(Vu,Wu.path):qj(Wu)?this.Dn(Vu,Wu,Xu):this.Cn(Vu,Wu,Xu)}Sn(Zu,$u){return this.Rn(Zu,new Ag($u)).next(a=>{let b=Em();return a.isFoundDocument()&&(b=b.insert(a.key,a)),b})}Dn(_u,av,bv){const cv=av.collectionGroup;let dv=Em();return this.Jt.getCollectionParents(_u,cv).next(a=>_p.forEach(a,a=>{var b,c;const d=(b=av,c=a.child(cv),new cj(c,null,b.explicitOrderBy.slice(),b.filters.slice(),b.limit,b.limitType,b.startAt,b.endAt));return this.Cn(_u,d,bv).next(a=>{a.forEach((a,b)=>{dv=dv.insert(a,b)})})}).next(()=>dv))}Cn(ev,fv,gv){let hv,iv;return this.Je.getDocumentsMatchingQuery(ev,fv,gv).next(a=>(hv=a,this.An.getAllMutationBatchesAffectingQuery(ev,fv))).next(a=>(iv=a,this.Nn(ev,iv,hv).next(a=>{for(const b of(hv=a,iv))for(const c of b.mutations){const d=c.key;let e=hv.get(d);null==e&&(e=uh.newInvalidDocument(d),hv=hv.insert(d,e)),gk(c,e,b.localWriteTime),e.isFoundDocument()||(hv=hv.remove(d))}}))).next(()=>(hv.forEach((a,b)=>{xj(fv,b)||(hv=hv.remove(a))}),hv))}Nn(jv,kv,lv){let mv=Im();for(const nv of kv)for(const ov of nv.mutations)ov instanceof pk&&null===lv.get(ov.key)&&(mv=mv.add(ov.key));let pv=lv;return this.Je.getEntries(jv,mv).next(a=>(a.forEach((a,b)=>{b.isFoundDocument()&&(pv=pv.insert(a,b))}),pv))}}class qv{constructor(rv,sv,tv,uv){this.targetId=rv,this.fromCache=sv,this.kn=tv,this.xn=uv}static $n(vv,wv){let xv=Im(),yv=Im();for(const zv of wv.docChanges)switch(zv.type){case 0:xv=xv.add(zv.doc.key);break;case 1:yv=yv.add(zv.doc.key)}return new qv(vv,wv.fromCache,xv,yv)}}class Av{Fn(Bv){this.On=Bv}getDocumentsMatchingQuery(Cv,Dv,Ev,Fv){var Gv;return 0===(Gv=Dv).filters.length&&null===Gv.limit&&null==Gv.startAt&&null==Gv.endAt&&(0===Gv.explicitOrderBy.length||1===Gv.explicitOrderBy.length&&Gv.explicitOrderBy[0].field.isKeyField())||Ev.isEqual(ff.min())?this.Mn(Cv,Dv):this.On.vn(Cv,Fv).next(a=>{const b=this.Ln(Dv,a);return(mj(Dv)||nj(Dv))&&this.Bn(Dv.limitType,b,Fv,Ev)?this.Mn(Cv,Dv):(Od()<=n.in.DEBUG&&Pd("QueryEngine","Re-using previous result from %s to execute query: %s",Ev.toString(),wj(Dv)),this.On.getDocumentsMatchingQuery(Cv,Dv,Ev).next(a=>(b.forEach(b=>{a=a.insert(b.key,b)}),a)))})}Ln(Hv,Iv){let Jv=new Zl(yj(Hv));return Iv.forEach((a,b)=>{xj(Hv,b)&&(Jv=Jv.add(b))}),Jv}Bn(Kv,Lv,Mv,Nv){if(Mv.size!==Lv.size)return!0;const Ov="F"===Kv?Lv.last():Lv.first();return!!Ov&&(Ov.hasPendingWrites||Ov.version.compareTo(Nv)>0)}Mn(Pv,Qv){return Od()<=n.in.DEBUG&&Pd("QueryEngine","Using full collection scan to execute query:",wj(Qv)),this.On.getDocumentsMatchingQuery(Pv,Qv,ff.min())}}class Rv{constructor(Sv,Tv,Uv,Vv){this.persistence=Sv,this.Un=Tv,this.k=Vv,this.qn=new Hk(We),this.Kn=new au(a=>Wh(a),Xh),this.jn=ff.min(),this.An=Sv.getMutationQueue(Uv),this.Qn=Sv.getRemoteDocumentCache(),this.He=Sv.getTargetCache(),this.Wn=new Gu(this.Qn,this.An,this.persistence.getIndexManager()),this.Ye=Sv.getBundleCache(),this.Un.Fn(this.Wn)}collectGarbage(Wv){return this.persistence.runTransaction("Collect garbage","readwrite-primary",a=>Wv.collect(a,this.qn))}}async function Xv(a,b){const c=Vd(a);let d=c.An,e=c.Wn;const f=await c.persistence.runTransaction("Handle user change","readonly",a=>{let f;return c.An.getAllMutationBatches(a).next(g=>(f=g,d=c.persistence.getMutationQueue(b),e=new Gu(c.Qn,d,c.persistence.getIndexManager()),d.getAllMutationBatches(a))).next(b=>{const c=[],d=[];let g=Im();for(const h of f)for(const i of(c.push(h.batchId),h.mutations))g=g.add(i.key);for(const j of b)for(const k of(d.push(j.batchId),j.mutations))g=g.add(k.key);return e.vn(a,g).next(a=>({Gn:a,removedBatchIds:c,addedBatchIds:d}))})});return c.An=d,c.Wn=e,c.Un.Fn(c.Wn),f}function Yv(a){const b=Vd(a);return b.persistence.runTransaction("Get last remote snapshot version","readonly",a=>b.He.getLastRemoteSnapshotVersion(a))}function Zv(a,b){const c=Vd(a);return c.persistence.runTransaction("Get next mutation batch","readonly",a=>(void 0===b&&(b=-1),c.An.getNextMutationBatchAfterBatchId(a,b)))}async function $v(a,b,c){const d=Vd(a),e=d.qn.get(b);try{c||await d.persistence.runTransaction("Release target",c?"readwrite":"readwrite-primary",a=>d.persistence.referenceDelegate.removeTarget(a,e))}catch(f){if(!pr(f))throw f;Pd("LocalStore",`Failed to update sequence numbers for target ${b}: ${f}`)}d.qn=d.qn.remove(b),d.Kn.delete(e.target)}function _v(a,b,c){const d=Vd(a);let e=ff.min(),f=Im();return d.persistence.runTransaction("Execute query","readonly",a=>(function(a,b,c){const d=Vd(a),e=d.Kn.get(c);return void 0!==e?_p.resolve(d.qn.get(e)):d.He.getTargetData(b,c)})(d,a,sj(b)).next(b=>{if(b)return e=b.lastLimboFreeSnapshotVersion,d.He.getMatchingKeysForTargetId(a,b.targetId).next(a=>{f=a})}).next(()=>d.Un.getDocumentsMatchingQuery(a,b,c?e:ff.min(),c?f:Im())).next(a=>({documents:a,zn:f})))}class aw{constructor(){this.ts=new Zl(yw.es),this.ns=new Zl(yw.ss)}isEmpty(){return this.ts.isEmpty()}addReference(bw,cw){const dw=new yw(bw,cw);this.ts=this.ts.add(dw),this.ns=this.ns.add(dw)}rs(ew,fw){ew.forEach(a=>this.addReference(a,fw))}removeReference(gw,hw){this.os(new yw(gw,hw))}cs(iw,jw){iw.forEach(a=>this.removeReference(a,jw))}us(kw){const lw=new Ag(new Kf([])),mw=new yw(lw,kw),nw=new yw(lw,kw+1),ow=[];return this.ns.forEachInRange([mw,nw],a=>{this.os(a),ow.push(a.key)}),ow}hs(){this.ts.forEach(a=>this.os(a))}os(pw){this.ts=this.ts.delete(pw),this.ns=this.ns.delete(pw)}ls(qw){const rw=new Ag(new Kf([])),sw=new yw(rw,qw),tw=new yw(rw,qw+1);let uw=Im();return this.ns.forEachInRange([sw,tw],a=>{uw=uw.add(a.key)}),uw}containsKey(vw){const ww=new yw(vw,0),xw=this.ts.firstAfterOrEqual(ww);return null!==xw&&vw.isEqual(xw.key)}}class yw{constructor(zw,Aw){this.key=zw,this.fs=Aw}static es(Bw,Cw){return Ag.comparator(Bw.key,Cw.key)||We(Bw.fs,Cw.fs)}static ss(Dw,Ew){return We(Dw.fs,Ew.fs)||Ag.comparator(Dw.key,Ew.key)}}class Fw{constructor(Gw,Hw){this.Jt=Gw,this.referenceDelegate=Hw,this.An=[],this.ds=1,this.ws=new Zl(yw.es)}checkEmpty(Iw){return _p.resolve(0===this.An.length)}addMutationBatch(Jw,Kw,Lw,Mw){const Nw=this.ds;this.ds++,this.An.length>0&&this.An[this.An.length-1];const Ow=new Zr(Nw,Kw,Lw,Mw);for(const Pw of(this.An.push(Ow),Mw))this.ws=this.ws.add(new yw(Pw.key,Nw)),this.Jt.addToCollectionParentIndex(Jw,Pw.key.path.popLast());return _p.resolve(Ow)}lookupMutationBatch(Qw,Rw){return _p.resolve(this._s(Rw))}getNextMutationBatchAfterBatchId(Sw,Tw){const Uw=this.gs(Tw+1),Vw=Uw<0?0:Uw;return _p.resolve(this.An.length>Vw?this.An[Vw]:null)}getHighestUnacknowledgedBatchId(){return _p.resolve(0===this.An.length?-1:this.ds-1)}getAllMutationBatches(Ww){return _p.resolve(this.An.slice())}getAllMutationBatchesAffectingDocumentKey(Xw,Yw){const Zw=new yw(Yw,0),$w=new yw(Yw,Number.POSITIVE_INFINITY),_w=[];return this.ws.forEachInRange([Zw,$w],a=>{const b=this._s(a.fs);_w.push(b)}),_p.resolve(_w)}getAllMutationBatchesAffectingDocumentKeys(ax,bx){let cx=new Zl(We);return bx.forEach(a=>{const b=new yw(a,0),c=new yw(a,Number.POSITIVE_INFINITY);this.ws.forEachInRange([b,c],a=>{cx=cx.add(a.fs)})}),_p.resolve(this.ys(cx))}getAllMutationBatchesAffectingQuery(dx,ex){const fx=ex.path,gx=fx.length+1;let hx=fx;Ag.isDocumentKey(hx)||(hx=hx.child(""));const ix=new yw(new Ag(hx),0);let jx=new Zl(We);return this.ws.forEachWhile(a=>{const b=a.key.path;return!!fx.isPrefixOf(b)&&(b.length===gx&&(jx=jx.add(a.fs)),!0)},ix),_p.resolve(this.ys(jx))}ys(kx){const lx=[];return kx.forEach(a=>{const b=this._s(a);null!==b&&lx.push(b)}),lx}removeMutationBatch(mx,nx){Ud(0===this.ps(nx.batchId,"removed")),this.An.shift();let ox=this.ws;return _p.forEach(nx.mutations,a=>{const b=new yw(a.key,nx.batchId);return ox=ox.delete(b),this.referenceDelegate.markPotentiallyOrphaned(mx,a.key)}).next(()=>{this.ws=ox})}ee(px){}containsKey(qx,rx){const sx=new yw(rx,0),tx=this.ws.firstAfterOrEqual(sx);return _p.resolve(rx.isEqual(tx&&tx.key))}performConsistencyCheck(ux){return this.An.length,_p.resolve()}ps(vx,wx){return this.gs(vx)}gs(xx){return 0===this.An.length?0:xx-this.An[0].batchId}_s(yx){const zx=this.gs(yx);return zx<0||zx>=this.An.length?null:this.An[zx]}}class Ax{constructor(Bx,Cx){this.Jt=Bx,this.Ts=Cx,this.docs=new Hk(Ag.comparator),this.size=0}addEntry(Dx,Ex,Fx){const Gx=Ex.key,Hx=this.docs.get(Gx),Ix=Hx?Hx.size:0,Jx=this.Ts(Ex);return this.docs=this.docs.insert(Gx,{document:Ex.clone(),size:Jx,readTime:Fx}),this.size+=Jx-Ix,this.Jt.addToCollectionParentIndex(Dx,Gx.path.popLast())}removeEntry(Kx){const Lx=this.docs.get(Kx);Lx&&(this.docs=this.docs.remove(Kx),this.size-=Lx.size)}getEntry(Mx,Nx){const Ox=this.docs.get(Nx);return _p.resolve(Ox?Ox.document.clone():uh.newInvalidDocument(Nx))}getEntries(Px,Qx){let Rx=Cm();return Qx.forEach(a=>{const b=this.docs.get(a);Rx=Rx.insert(a,b?b.document.clone():uh.newInvalidDocument(a))}),_p.resolve(Rx)}getDocumentsMatchingQuery(Sx,Tx,Ux){let Vx=Cm();const Wx=new Ag(Tx.path.child("")),Xx=this.docs.getIteratorFrom(Wx);for(;Xx.hasNext();){const{key:Yx,value:{document:Zx,readTime:$x}}=Xx.getNext();if(!Tx.path.isPrefixOf(Yx.path))break;0>=$x.compareTo(Ux)||xj(Tx,Zx)&&(Vx=Vx.insert(Zx.key,Zx.clone()))}return _p.resolve(Vx)}Es(_x,ay){return _p.forEach(this.docs,a=>ay(a))}newChangeBuffer(by){return new dy(this)}getSize(cy){return _p.resolve(this.size)}}class dy extends tu{constructor(ey){super(),this.De=ey}applyChanges(fy){const gy=[];return this.changes.forEach((a,b)=>{b.document.isValidDocument()?gy.push(this.De.addEntry(fy,b.document,this.getReadTime(a))):this.De.removeEntry(a)}),_p.waitFor(gy)}getFromCache(hy,iy){return this.De.getEntry(hy,iy)}getAllFromCache(jy,ky){return this.De.getEntries(jy,ky)}}class ly{constructor(my,ny){this.bs={},this.Be=new Ke(0),this.Ue=!1,this.Ue=!0,this.referenceDelegate=my(this),this.He=new class{constructor(oy){this.persistence=oy,this.Is=new au(a=>Wh(a),Xh),this.lastRemoteSnapshotVersion=ff.min(),this.highestTargetId=0,this.As=0,this.Rs=new aw,this.targetCount=0,this.Ps=Zt.ie()}forEachTarget(py,qy){return this.Is.forEach((a,b)=>qy(b)),_p.resolve()}getLastRemoteSnapshotVersion(ry){return _p.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(sy){return _p.resolve(this.As)}allocateTargetId(ty){return this.highestTargetId=this.Ps.next(),_p.resolve(this.highestTargetId)}setTargetsMetadata(uy,vy,wy){return wy&&(this.lastRemoteSnapshotVersion=wy),vy>this.As&&(this.As=vy),_p.resolve()}ce(xy){this.Is.set(xy.target,xy);const yy=xy.targetId;yy>this.highestTargetId&&(this.Ps=new Zt(yy),this.highestTargetId=yy),xy.sequenceNumber>this.As&&(this.As=xy.sequenceNumber)}addTargetData(zy,Ay){return this.ce(Ay),this.targetCount+=1,_p.resolve()}updateTargetData(By,Cy){return this.ce(Cy),_p.resolve()}removeTargetData(Dy,Ey){return this.Is.delete(Ey.target),this.Rs.us(Ey.targetId),this.targetCount-=1,_p.resolve()}removeTargets(Fy,Gy,Hy){let Iy=0;const Jy=[];return this.Is.forEach((a,b)=>{b.sequenceNumber<=Gy&&null===Hy.get(b.targetId)&&(this.Is.delete(a),Jy.push(this.removeMatchingKeysForTargetId(Fy,b.targetId)),Iy++)}),_p.waitFor(Jy).next(()=>Iy)}getTargetCount(Ky){return _p.resolve(this.targetCount)}getTargetData(Ly,My){const Ny=this.Is.get(My)||null;return _p.resolve(Ny)}addMatchingKeys(Oy,Py,Qy){return this.Rs.rs(Py,Qy),_p.resolve()}removeMatchingKeys(Ry,Sy,Ty){this.Rs.cs(Sy,Ty);const Uy=this.persistence.referenceDelegate,Vy=[];return Uy&&Sy.forEach(a=>{Vy.push(Uy.markPotentiallyOrphaned(Ry,a))}),_p.waitFor(Vy)}removeMatchingKeysForTargetId(Wy,Xy){return this.Rs.us(Xy),_p.resolve()}getMatchingKeysForTargetId(Yy,Zy){const $y=this.Rs.ls(Zy);return _p.resolve($y)}containsKey(_y,az){return _p.resolve(this.Rs.containsKey(az))}}(this),this.Jt=new class{constructor(){this.zt=new class{constructor(){this.index={}}add(bz){const cz=bz.lastSegment(),dz=bz.popLast(),ez=this.index[cz]||new Zl(Kf.comparator),fz=!ez.has(dz);return this.index[cz]=ez.add(dz),fz}has(gz){const hz=gz.lastSegment(),iz=gz.popLast(),jz=this.index[hz];return jz&&jz.has(iz)}getEntries(kz){return(this.index[kz]||new Zl(Kf.comparator)).toArray()}}}addToCollectionParentIndex(lz,mz){return this.zt.add(mz),_p.resolve()}getCollectionParents(nz,oz){return _p.resolve(this.zt.getEntries(oz))}},this.Je=(function(a,b){return new Ax(a,b)})(this.Jt,a=>this.referenceDelegate.vs(a)),this.k=new class{constructor(pz){this.Gt=pz}}(ny),this.Ye=new class{constructor(qz){this.k=qz,this.Xn=new Map,this.Zn=new Map}getBundleMetadata(rz,sz){return _p.resolve(this.Xn.get(sz))}saveBundleMetadata(tz,uz){var vz;return this.Xn.set(uz.id,{id:(vz=uz).id,version:vz.version,createTime:so(vz.createTime)}),_p.resolve()}getNamedQuery(wz,xz){return _p.resolve(this.Zn.get(xz))}saveNamedQuery(yz,zz){var Az;return this.Zn.set(zz.name,{name:(Az=zz).name,query:function(a){const b=function(a){var b,c,d,e,f,g,h,i;let j=function(a){const b=uo(a);return 4===b.length?Kf.emptyPath():zo(b)}(a.parent);const k=a.structuredQuery,l=k.from?k.from.length:0;let m=null;if(l>0){Ud(1===l);const n=k.from[0];n.allDescendants?m=n.collectionId:j=j.child(n.collectionId)}let o=[];k.where&&(o=Do(k.where));let p=[];k.orderBy&&(p=k.orderBy.map(a=>{var b;return b=a,new Yi(Ho(b.field),function(a){switch(a){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(b.direction))}));let q=null,r;k.limit&&(q=xg(r="object"==typeof(b=k.limit)?b.value:b)?null:r);let s=null;k.startAt&&(s=Fo(k.startAt));let t=null;return k.endAt&&(t=Fo(k.endAt)),c=j,d=m,e=p,f=o,g=q,h=s,i=t,new cj(c,d,e,f,g,"F",h,i)}({parent:a.parent,structuredQuery:a.structuredQuery});return"LAST"===a.limitType?tj(b,b.limit,"L"):b}(Az.bundledQuery),readTime:so(Az.readTime)}),_p.resolve()}}(this.k)}start(){return Promise.resolve()}shutdown(){return this.Ue=!1,Promise.resolve()}get started(){return this.Ue}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(){return this.Jt}getMutationQueue(Bz){let Cz=this.bs[Bz.toKey()];return Cz||(Cz=new Fw(this.Jt,this.referenceDelegate),this.bs[Bz.toKey()]=Cz),Cz}getTargetCache(){return this.He}getRemoteDocumentCache(){return this.Je}getBundleCache(){return this.Ye}runTransaction(Dz,Ez,Fz){Pd("MemoryPersistence","Starting transaction:",Dz);const Gz=new Jz(this.Be.next());return this.referenceDelegate.Vs(),Fz(Gz).next(a=>this.referenceDelegate.Ss(Gz).next(()=>a)).toPromise().then(a=>(Gz.raiseOnCommittedEvent(),a))}Ds(Hz,Iz){return _p.or(Object.values(this.bs).map(a=>()=>a.containsKey(Hz,Iz)))}}class Jz extends Zp{constructor(Kz){super(),this.currentSequenceNumber=Kz}}class Lz{constructor(Mz){this.persistence=Mz,this.Cs=new aw,this.Ns=null}static ks(Nz){return new Lz(Nz)}get xs(){if(this.Ns)return this.Ns;throw Td()}addReference(Oz,Pz,Qz){return this.Cs.addReference(Qz,Pz),this.xs.delete(Qz.toString()),_p.resolve()}removeReference(Rz,Sz,Tz){return this.Cs.removeReference(Tz,Sz),this.xs.add(Tz.toString()),_p.resolve()}markPotentiallyOrphaned(Uz,Vz){return this.xs.add(Vz.toString()),_p.resolve()}removeTarget(Wz,Xz){this.Cs.us(Xz.targetId).forEach(a=>this.xs.add(a.toString()));const Yz=this.persistence.getTargetCache();return Yz.getMatchingKeysForTargetId(Wz,Xz.targetId).next(a=>{a.forEach(a=>this.xs.add(a.toString()))}).next(()=>Yz.removeTargetData(Wz,Xz))}Vs(){this.Ns=new Set}Ss(Zz){const $z=this.persistence.getRemoteDocumentCache().newChangeBuffer();return _p.forEach(this.xs,a=>{const b=Ag.fromPath(a);return this.$s(Zz,b).next(a=>{a||$z.removeEntry(b)})}).next(()=>(this.Ns=null,$z.apply(Zz)))}updateLimboDocument(_z,aA){return this.$s(_z,aA).next(a=>{a?this.xs.delete(aA.toString()):this.xs.add(aA.toString())})}vs(bA){return 0}$s(cA,dA){return _p.or([()=>_p.resolve(this.Cs.containsKey(dA)),()=>this.persistence.getTargetCache().containsKey(cA,dA),()=>this.persistence.Ds(cA,dA)])}}class eA{constructor(fA,gA,hA,iA){this.user=fA,this.batchId=gA,this.state=hA,this.error=iA}static Fs(jA,kA,lA){const mA=JSON.parse(lA);let nA,oA="object"==typeof mA&& -1!==["pending","acknowledged","rejected"].indexOf(mA.state)&&(void 0===mA.error||"object"==typeof mA.error);return oA&&mA.error&&(oA="string"==typeof mA.error.message&&"string"==typeof mA.error.code)&&(nA=new Xd(mA.error.code,mA.error.message)),oA?new eA(jA,kA,mA.state,nA):(Qd("SharedClientState",`Failed to parse mutation state for ID '${kA}': ${lA}`),null)}Os(){const pA={state:this.state,updateTimeMs:Date.now()};return this.error&&(pA.error={code:this.error.code,message:this.error.message}),JSON.stringify(pA)}}class qA{constructor(rA,sA,tA){this.targetId=rA,this.state=sA,this.error=tA}static Fs(uA,vA){const wA=JSON.parse(vA);let xA,yA="object"==typeof wA&& -1!==["not-current","current","rejected"].indexOf(wA.state)&&(void 0===wA.error||"object"==typeof wA.error);return yA&&wA.error&&(yA="string"==typeof wA.error.message&&"string"==typeof wA.error.code)&&(xA=new Xd(wA.error.code,wA.error.message)),yA?new qA(uA,wA.state,xA):(Qd("SharedClientState",`Failed to parse target state for ID '${uA}': ${vA}`),null)}Os(){const zA={state:this.state,updateTimeMs:Date.now()};return this.error&&(zA.error={code:this.error.code,message:this.error.message}),JSON.stringify(zA)}}class AA{constructor(BA,CA){this.clientId=BA,this.activeTargetIds=CA}static Fs(DA,EA){const FA=JSON.parse(EA);let GA="object"==typeof FA&&FA.activeTargetIds instanceof Array,HA=Km();for(let IA=0;GA&&IA<FA.activeTargetIds.length;++IA)GA=zg(FA.activeTargetIds[IA]),HA=HA.add(FA.activeTargetIds[IA]);return GA?new AA(DA,HA):(Qd("SharedClientState",`Failed to parse client data for instance '${DA}': ${EA}`),null)}}class JA{constructor(KA,LA){this.clientId=KA,this.onlineState=LA}static Fs(MA){const NA=JSON.parse(MA);return"object"==typeof NA&& -1!==["Unknown","Online","Offline"].indexOf(NA.onlineState)&&"string"==typeof NA.clientId?new JA(NA.clientId,NA.onlineState):(Qd("SharedClientState",`Failed to parse online state: ${MA}`),null)}}class OA{constructor(){this.activeTargetIds=Km()}Ms(PA){this.activeTargetIds=this.activeTargetIds.add(PA)}Ls(QA){this.activeTargetIds=this.activeTargetIds.delete(QA)}Os(){const RA={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(RA)}}class SA{constructor(){this.pi=new OA,this.Ti={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(TA){}updateMutationState(UA,VA,WA){}addLocalQueryTarget(XA){return this.pi.Ms(XA),this.Ti[XA]||"not-current"}updateQueryState(YA,ZA,$A){this.Ti[YA]=ZA}removeLocalQueryTarget(_A){this.pi.Ls(_A)}isLocalQueryTarget(aB){return this.pi.activeTargetIds.has(aB)}clearQueryState(bB){delete this.Ti[bB]}getAllActiveQueryTargets(){return this.pi.activeTargetIds}isActiveQueryTarget(cB){return this.pi.activeTargetIds.has(cB)}start(){return this.pi=new OA,Promise.resolve()}handleUserChange(dB,eB,fB){}setOnlineState(gB){}shutdown(){}writeSequenceNumber(hB){}notifyBundleLoaded(){}}class iB{Ei(jB){}shutdown(){}}class kB{constructor(){this.Ii=()=>this.Ai(),this.Ri=()=>this.Pi(),this.bi=[],this.vi()}Ei(lB){this.bi.push(lB)}shutdown(){window.removeEventListener("online",this.Ii),window.removeEventListener("offline",this.Ri)}vi(){window.addEventListener("online",this.Ii),window.addEventListener("offline",this.Ri)}Ai(){for(const mB of(Pd("ConnectivityMonitor","Network connectivity changed: AVAILABLE"),this.bi))mB(0)}Pi(){for(const nB of(Pd("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE"),this.bi))nB(1)}static bt(){return"undefined"!=typeof window&& void 0!==window.addEventListener&& void 0!==window.removeEventListener}}const oB={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"};class pB{constructor(qB){this.Vi=qB.Vi,this.Si=qB.Si}Di(rB){this.Ci=rB}Ni(sB){this.ki=sB}onMessage(tB){this.xi=tB}close(){this.Si()}send(uB){this.Vi(uB)}$i(){this.Ci()}Fi(vB){this.ki(vB)}Oi(wB){this.xi(wB)}}class xB extends class{constructor(QB){this.databaseInfo=QB,this.databaseId=QB.databaseId;const RB=QB.ssl?"https":"http";this.Mi=RB+"://"+QB.host,this.Li="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}Bi(SB,TB,UB,VB,WB){const XB=this.Ui(SB,TB);Pd("RestConnection","Sending: ",XB,UB);const YB={};return this.qi(YB,VB,WB),this.Ki(SB,XB,YB,UB).then(a=>(Pd("RestConnection","Received: ",a),a),a=>{throw Rd("RestConnection",`${SB} failed with error: `,a,"url: ",XB,"request:",UB),a})}ji(ZB,$B,_B,aC,bC){return this.Bi(ZB,$B,_B,aC,bC)}qi(cC,dC,eC){cC["X-Goog-Api-Client"]="gl-js/ fire/"+Md,cC["Content-Type"]="text/plain",this.databaseInfo.appId&&(cC["X-Firebase-GMPID"]=this.databaseInfo.appId),dC&&dC.headers.forEach((a,b)=>cC[b]=a),eC&&eC.headers.forEach((a,b)=>cC[b]=a)}Ui(fC,gC){const hC=oB[fC];return`${this.Mi}/v1/${gC}:${hC}`}}{constructor(yB){super(yB),this.forceLongPolling=yB.forceLongPolling,this.autoDetectLongPolling=yB.autoDetectLongPolling,this.useFetchStreams=yB.useFetchStreams}Ki(zB,AB,BB,CB){return new Promise((a,b)=>{const c=new Gd;c.listenOnce(Bd.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Ad.NO_ERROR:const d=c.getResponseJson();Pd("Connection","XHR received:",JSON.stringify(d)),a(d);break;case Ad.TIMEOUT:Pd("Connection","RPC \""+zB+"\" timed out"),b(new Xd(Wd.DEADLINE_EXCEEDED,"Request time out"));break;case Ad.HTTP_ERROR:const e=c.getStatus();if(Pd("Connection","RPC \""+zB+"\" failed with status:",e,"response text:",c.getResponseText()),e>0){const f=c.getResponseJson().error;if(f&&f.status&&f.message){const g=function(a){const b=a.toLowerCase().replace(/_/g,"-");return Object.values(Wd).indexOf(b)>=0?b:Wd.UNKNOWN}(f.status);b(new Xd(g,f.message))}else b(new Xd(Wd.UNKNOWN,"Server responded with status "+c.getStatus()))}else b(new Xd(Wd.UNAVAILABLE,"Connection failed."));break;default:Td()}}finally{Pd("Connection","RPC \""+zB+"\" completed.")}});const d=JSON.stringify(CB);c.send(AB,"POST",d,BB,15)})}Qi(DB,EB,FB){const GB=[this.Mi,"/","google.firestore.v1.Firestore","/",DB,"/channel"],HB=yd(),IB=zd(),JB={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:60e4},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(JB.xmlHttpFactory=new Ed({})),this.qi(JB.initMessageHeaders,EB,FB),(0,o.uI)()||(0,o.b$)()||(0,o.d)()||(0,o.w1)()||(0,o.Mn)()||(0,o.ru)()||(JB.httpHeadersOverwriteParam="$httpHeaders");const KB=GB.join("");Pd("Connection","Creating WebChannel: "+KB,JB);const LB=HB.createWebChannel(KB,JB);let MB=!1,NB=!1;const OB=new pB({Vi:a=>{NB?Pd("Connection","Not sending because WebChannel is closed:",a):(MB||(Pd("Connection","Opening WebChannel transport."),LB.open(),MB=!0),Pd("Connection","WebChannel sending:",a),LB.send(a))},Si:()=>LB.close()}),PB=(a,b,c)=>{a.listen(b,a=>{try{c(a)}catch(b){setTimeout(()=>{throw b},0)}})};return PB(LB,Fd.EventType.OPEN,()=>{NB||Pd("Connection","WebChannel transport opened.")}),PB(LB,Fd.EventType.CLOSE,()=>{NB||(NB=!0,Pd("Connection","WebChannel transport closed"),OB.Fi())}),PB(LB,Fd.EventType.ERROR,a=>{NB||(NB=!0,Rd("Connection","WebChannel transport errored:",a),OB.Fi(new Xd(Wd.UNAVAILABLE,"The operation could not be completed")))}),PB(LB,Fd.EventType.MESSAGE,a=>{var b;if(!NB){const c=a.data[0];Ud(!!c);const d=c,e=d.error||(null===(b=d[0])|| void 0===b?void 0:b.error);if(e){Pd("Connection","WebChannel received error:",e);const f=e.status;let g=function(a){const b=i[a];if(void 0!==b)return Gk(b)}(f),h=e.message;void 0===g&&(g=Wd.INTERNAL,h="Unknown error status: "+f+" with message "+e.message),NB=!0,OB.Fi(new Xd(g,h)),LB.close()}else Pd("Connection","WebChannel received:",c),OB.Oi(c)}}),PB(IB,Cd.STAT_EVENT,a=>{a.stat===Dd.PROXY?Pd("Connection","Detected buffering proxy"):a.stat===Dd.NOPROXY&&Pd("Connection","Detected no buffering proxy")}),setTimeout(()=>{OB.$i()},0),OB}}function iC(){return"undefined"!=typeof document?document:null}function jC(a){return new no(a,!0)}class kC{constructor(lC,mC,nC=1000,oC=1.5,pC=60e3){this.Oe=lC,this.timerId=mC,this.Wi=nC,this.Gi=oC,this.zi=pC,this.Hi=0,this.Ji=null,this.Yi=Date.now(),this.reset()}reset(){this.Hi=0}Xi(){this.Hi=this.zi}Zi(qC){this.cancel();const rC=Math.floor(this.Hi+this.tr()),sC=Math.max(0,Date.now()-this.Yi),tC=Math.max(0,rC-sC);tC>0&&Pd("ExponentialBackoff",`Backing off for ${tC} ms (base delay: ${this.Hi} ms, delay with jitter: ${rC} ms, last attempt: ${sC} ms ago)`),this.Ji=this.Oe.enqueueAfterDelay(this.timerId,tC,()=>(this.Yi=Date.now(),qC())),this.Hi*=this.Gi,this.Hi<this.Wi&&(this.Hi=this.Wi),this.Hi>this.zi&&(this.Hi=this.zi)}er(){null!==this.Ji&&(this.Ji.skipDelay(),this.Ji=null)}cancel(){null!==this.Ji&&(this.Ji.cancel(),this.Ji=null)}tr(){return(Math.random()-0.5)*this.Hi}}class uC{constructor(vC,wC,xC,yC,zC,AC,BC,CC){this.Oe=vC,this.nr=xC,this.sr=yC,this.ir=zC,this.authCredentialsProvider=AC,this.appCheckCredentialsProvider=BC,this.listener=CC,this.state=0,this.rr=0,this.ar=null,this.cr=null,this.stream=null,this.ur=new kC(vC,wC)}hr(){return 1===this.state||5===this.state||this.lr()}lr(){return 2===this.state||3===this.state}start(){4!==this.state?this.auth():this.dr()}async stop(){this.hr()&&await this.close(0)}wr(){this.state=0,this.ur.reset()}_r(){this.lr()&&null===this.ar&&(this.ar=this.Oe.enqueueAfterDelay(this.nr,60e3,()=>this.mr()))}gr(DC){this.yr(),this.stream.send(DC)}async mr(){if(this.lr())return this.close(0)}yr(){this.ar&&(this.ar.cancel(),this.ar=null)}pr(){this.cr&&(this.cr.cancel(),this.cr=null)}async close(EC,FC){this.yr(),this.pr(),this.ur.cancel(),this.rr++,4!==EC?this.ur.reset():FC&&FC.code===Wd.RESOURCE_EXHAUSTED?(Qd(FC.toString()),Qd("Using maximum backoff delay to prevent overloading the backend."),this.ur.Xi()):FC&&FC.code===Wd.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.Tr(),this.stream.close(),this.stream=null),this.state=EC,await this.listener.Ni(FC)}Tr(){}auth(){this.state=1;const GC=this.Er(this.rr),HC=this.rr;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([a,b])=>{this.rr===HC&&this.Ir(a,b)},a=>{GC(()=>{const b=new Xd(Wd.UNKNOWN,"Fetching auth token failed: "+a.message);return this.Ar(b)})})}Ir(IC,JC){const KC=this.Er(this.rr);this.stream=this.Rr(IC,JC),this.stream.Di(()=>{KC(()=>(this.state=2,this.cr=this.Oe.enqueueAfterDelay(this.sr,10e3,()=>(this.lr()&&(this.state=3),Promise.resolve())),this.listener.Di()))}),this.stream.Ni(a=>{KC(()=>this.Ar(a))}),this.stream.onMessage(a=>{KC(()=>this.onMessage(a))})}dr(){this.state=5,this.ur.Zi(async()=>{this.state=0,this.start()})}Ar(LC){return Pd("PersistentStream",`close with error: ${LC}`),this.stream=null,this.close(4,LC)}Er(MC){return a=>{this.Oe.enqueueAndForget(()=>this.rr===MC?a():(Pd("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class NC extends uC{constructor(OC,PC,QC,RC,SC,TC){super(OC,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",PC,QC,RC,TC),this.k=SC}Rr(UC,VC){return this.ir.Qi("Listen",UC,VC)}onMessage(WC){this.ur.reset();const XC=function(a,b){let c;if("targetChange"in b){var d,e,f;b.targetChange;const g="NO_CHANGE"===(d=b.targetChange.targetChangeType||"NO_CHANGE")?0:"ADD"===d?1:"REMOVE"===d?2:"CURRENT"===d?3:"RESET"===d?4:Td(),h=b.targetChange.targetIds||[],i=(e=a,f=b.targetChange.resumeToken,e.C?(Ud(void 0===f||"string"==typeof f),ig.fromBase64String(f||"")):(Ud(void 0===f||f instanceof Uint8Array),ig.fromUint8Array(f||new Uint8Array))),j=b.targetChange.cause,k=j&&function(a){const b=void 0===a.code?Wd.UNKNOWN:Gk(a.code);return new Xd(b,a.message||"")}(j);c=new jn(g,h,i,k||null)}else if("documentChange"in b){b.documentChange;const l=b.documentChange;l.document,l.document.name,l.document.updateTime;const m=wo(a,l.document.name),n=so(l.document.updateTime),o=new Yg({mapValue:{fields:l.document.fields}}),p=uh.newFoundDocument(m,n,o),q=l.targetIds||[],r=l.removedTargetIds||[];c=new an(q,r,p.key,p)}else if("documentDelete"in b){b.documentDelete;const s=b.documentDelete;s.document;const t=wo(a,s.document),u=s.readTime?so(s.readTime):ff.min(),v=uh.newNoDocument(t,u),w=s.removedTargetIds||[];c=new an([],w,v.key,v)}else if("documentRemove"in b){b.documentRemove;const x=b.documentRemove;x.document;const y=wo(a,x.document),z=x.removedTargetIds||[];c=new an([],z,y,null)}else{if(!("filter"in b))return Td();{b.filter;const A=b.filter;A.targetId;const B=A.count||0,C=new Ek(B),D=A.targetId;c=new fn(D,C)}}return c}(this.k,WC),YC=function(a){if(!("targetChange"in a))return ff.min();const b=a.targetChange;return b.targetIds&&b.targetIds.length?ff.min():b.readTime?so(b.readTime):ff.min()}(WC);return this.listener.Pr(XC,YC)}br(ZC){const $C={};$C.database=yo(this.k),$C.addTarget=(function(a,b){let c;const d=b.target;return(c=Yh(d)?{documents:{documents:[xo(a,d.path)]}}:{query:(function(a,b){var c,d;const e={structuredQuery:{}},f=b.path;null!==b.collectionGroup?(e.parent=xo(a,f),e.structuredQuery.from=[{collectionId:b.collectionGroup,allDescendants:!0}]):(e.parent=xo(a,f.popLast()),e.structuredQuery.from=[{collectionId:f.lastSegment()}]);const g=function(a){if(0!==a.length){const b=a.map(a=>(function(a){if("=="===a.op){if(Vg(a.value))return{unaryFilter:{field:Go(a.field),op:"IS_NAN"}};if(Ug(a.value))return{unaryFilter:{field:Go(a.field),op:"IS_NULL"}}}else if("!="===a.op){if(Vg(a.value))return{unaryFilter:{field:Go(a.field),op:"IS_NOT_NAN"}};if(Ug(a.value))return{unaryFilter:{field:Go(a.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Go(a.field),op:mo[a.op],value:a.value}}})(a));return 1===b.length?b[0]:{compositeFilter:{op:"AND",filters:b}}}}(b.filters);g&&(e.structuredQuery.where=g);const h=function(a){if(0!==a.length)return a.map(a=>{var b;return{field:Go((b=a).field),direction:lo[b.dir]}})}(b.orderBy);h&&(e.structuredQuery.orderBy=h);const i=(c=a,d=b.limit,c.C||xg(d)?d:{value:d});return null!==i&&(e.structuredQuery.limit=i),b.startAt&&(e.structuredQuery.startAt=Eo(b.startAt)),b.endAt&&(e.structuredQuery.endAt=Eo(b.endAt)),e})(a,d)}).targetId=b.targetId,b.resumeToken.approximateByteSize()>0?c.resumeToken=ro(a,b.resumeToken):b.snapshotVersion.compareTo(ff.min())>0&&(c.readTime=qo(a,b.snapshotVersion.toTimestamp())),c})(this.k,ZC);const _C=function(a,b){const c=function(a,b){switch(b){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return Td()}}(0,b.purpose);return null==c?null:{"goog-listen-tags":c}}(this.k,ZC);_C&&($C.labels=_C),this.gr($C)}vr(aD){const bD={};bD.database=yo(this.k),bD.removeTarget=aD,this.gr(bD)}}class cD extends uC{constructor(dD,eD,fD,gD,hD,iD){super(dD,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",eD,fD,gD,iD),this.k=hD,this.Vr=!1}get Sr(){return this.Vr}start(){this.Vr=!1,this.lastStreamToken=void 0,super.start()}Tr(){this.Vr&&this.Dr([])}Rr(jD,kD){return this.ir.Qi("Write",jD,kD)}onMessage(lD){if(Ud(!!lD.streamToken),this.lastStreamToken=lD.streamToken,this.Vr){var mD,nD;this.ur.reset();const oD=(mD=lD.writeResults,nD=lD.commitTime,mD&&mD.length>0?(Ud(void 0!==nD),mD.map(a=>{var b,c;let d;return b=a,c=nD,(d=b.updateTime?so(b.updateTime):so(c)).isEqual(ff.min())&&(d=so(c)),new Wj(d,b.transformResults||[])})):[]),pD=so(lD.commitTime);return this.listener.Cr(pD,oD)}return Ud(!lD.writeResults||0===lD.writeResults.length),this.Vr=!0,this.listener.Nr()}kr(){const qD={};qD.database=yo(this.k),this.gr(qD)}Dr(rD){const sD={streamToken:this.lastStreamToken,writes:rD.map(a=>Bo(this.k,a))};this.gr(sD)}}class tD extends class{}{constructor(uD,vD,wD,xD){super(),this.authCredentials=uD,this.appCheckCredentials=vD,this.ir=wD,this.k=xD,this.$r=!1}Fr(){if(this.$r)throw new Xd(Wd.FAILED_PRECONDITION,"The client has already been terminated.")}Bi(yD,zD,AD){return this.Fr(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,b])=>this.ir.Bi(yD,zD,AD,a,b)).catch(a=>{throw"FirebaseError"===a.name?(a.code===Wd.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Xd(Wd.UNKNOWN,a.toString())})}ji(BD,CD,DD){return this.Fr(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([a,b])=>this.ir.ji(BD,CD,DD,a,b)).catch(a=>{throw"FirebaseError"===a.name?(a.code===Wd.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),a):new Xd(Wd.UNKNOWN,a.toString())})}terminate(){this.$r=!0}}class ED{constructor(FD,GD,HD,ID,JD){this.localStore=FD,this.datastore=GD,this.asyncQueue=HD,this.remoteSyncer={},this.Qr=[],this.Wr=new Map,this.Gr=new Set,this.zr=[],this.Hr=JD,this.Hr.Ei(a=>{HD.enqueueAndForget(async()=>{ZD(this)&&(Pd("RemoteStore","Restarting streams for network reachability change."),await async function(a){const b=Vd(a);b.Gr.add(4),await SD(b),b.Jr.set("Unknown"),b.Gr.delete(4),await RD(b)}(this))})}),this.Jr=new class{constructor(KD,LD){this.asyncQueue=KD,this.onlineStateHandler=LD,this.state="Unknown",this.Or=0,this.Mr=null,this.Lr=!0}Br(){0===this.Or&&(this.Ur("Unknown"),this.Mr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",10e3,()=>(this.Mr=null,this.qr("Backend didn't respond within 10 seconds."),this.Ur("Offline"),Promise.resolve())))}Kr(MD){"Online"===this.state?this.Ur("Unknown"):(this.Or++,this.Or>=1&&(this.jr(),this.qr(`Connection failed 1 times. Most recent error: ${MD.toString()}`),this.Ur("Offline")))}set(ND){this.jr(),this.Or=0,"Online"===ND&&(this.Lr=!1),this.Ur(ND)}Ur(OD){OD!==this.state&&(this.state=OD,this.onlineStateHandler(OD))}qr(PD){const QD=`Could not reach Cloud Firestore backend. ${PD}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Lr?(Qd(QD),this.Lr=!1):Pd("OnlineStateTracker",QD)}jr(){null!==this.Mr&&(this.Mr.cancel(),this.Mr=null)}}(HD,ID)}}async function RD(a){if(ZD(a))for(const b of a.zr)await b(!0)}async function SD(a){for(const b of a.zr)await b(!1)}function TD(a,b){const c=Vd(a);c.Wr.has(b.targetId)||(c.Wr.set(b.targetId,b),YD(c)?XD(c):oE(c).lr()&&VD(c,b))}function UD(a,b){const c=Vd(a),d=oE(c);c.Wr.delete(b),d.lr()&&WD(c,b),0===c.Wr.size&&(d.lr()?d._r():ZD(c)&&c.Jr.set("Unknown"))}function VD(a,b){a.Yr.X(b.targetId),oE(a).br(b)}function WD(a,b){a.Yr.X(b),oE(a).vr(b)}function XD(a){a.Yr=new wn({getRemoteKeysForTarget:b=>a.remoteSyncer.getRemoteKeysForTarget(b),Et:b=>a.Wr.get(b)||null}),oE(a).start(),a.Jr.Br()}function YD(a){return ZD(a)&&!oE(a).hr()&&a.Wr.size>0}function ZD(a){return 0===Vd(a).Gr.size}function $D(a){a.Yr=void 0}async function _D(a){a.Wr.forEach((b,c)=>{VD(a,b)})}async function aE(a,b){$D(a),YD(a)?(a.Jr.Kr(b),XD(a)):a.Jr.set("Unknown")}async function bE(a,b,c){if(a.Jr.set("Online"),b instanceof jn&&2===b.state&&b.cause)try{await async function(a,b){const c=b.cause;for(const d of b.targetIds)a.Wr.has(d)&&(await a.remoteSyncer.rejectListen(d,c),a.Wr.delete(d),a.Yr.removeTarget(d))}(a,b)}catch(d){Pd("RemoteStore","Failed to remove targets %s: %s ",b.targetIds.join(","),d),await cE(a,d)}else if(b instanceof an?a.Yr.ot(b):b instanceof fn?a.Yr.dt(b):a.Yr.ut(b),!c.isEqual(ff.min()))try{const e=await Yv(a.localStore);c.compareTo(e)>=0&&await function(a,b){const c=a.Yr.gt(b);return c.targetChanges.forEach((c,d)=>{if(c.resumeToken.approximateByteSize()>0){const e=a.Wr.get(d);e&&a.Wr.set(d,e.withResumeToken(c.resumeToken,b))}}),c.targetMismatches.forEach(b=>{const c=a.Wr.get(b);if(c){a.Wr.set(b,c.withResumeToken(ig.EMPTY_BYTE_STRING,c.snapshotVersion)),WD(a,b);const d=new xs(c.target,b,1,c.sequenceNumber);VD(a,d)}}),a.remoteSyncer.applyRemoteEvent(c)}(a,c)}catch(f){Pd("RemoteStore","Failed to raise snapshot:",f),await cE(a,f)}}async function cE(a,b,c){if(!pr(b))throw b;a.Gr.add(1),await SD(a),a.Jr.set("Offline"),c||(c=()=>Yv(a.localStore)),a.asyncQueue.enqueueRetryable(async()=>{Pd("RemoteStore","Retrying IndexedDB access"),await c(),a.Gr.delete(1),await RD(a)})}function dE(a,b){return b().catch(c=>cE(a,c,b))}async function eE(a){const b=Vd(a),c=pE(b);let d=b.Qr.length>0?b.Qr[b.Qr.length-1].batchId:-1;for(;fE(b);)try{const e=await Zv(b.localStore,d);if(null===e){0===b.Qr.length&&c._r();break}d=e.batchId,gE(b,e)}catch(f){await cE(b,f)}hE(b)&&iE(b)}function fE(a){return ZD(a)&&a.Qr.length<10}function gE(a,b){a.Qr.push(b);const c=pE(a);c.lr()&&c.Sr&&c.Dr(b.mutations)}function hE(a){return ZD(a)&&!pE(a).hr()&&a.Qr.length>0}function iE(a){pE(a).start()}async function jE(a){pE(a).kr()}async function kE(a){const b=pE(a);for(const c of a.Qr)b.Dr(c.mutations)}async function lE(a,b,c){const d=a.Qr.shift(),e=ms.from(d,b,c);await dE(a,()=>a.remoteSyncer.applySuccessfulWrite(e)),await eE(a)}async function mE(a,b){b&&pE(a).Sr&&await async function(a,b){var c;if((function(a){switch(a){default:return Td();case Wd.CANCELLED:case Wd.UNKNOWN:case Wd.DEADLINE_EXCEEDED:case Wd.RESOURCE_EXHAUSTED:case Wd.INTERNAL:case Wd.UNAVAILABLE:case Wd.UNAUTHENTICATED:return!1;case Wd.INVALID_ARGUMENT:case Wd.NOT_FOUND:case Wd.ALREADY_EXISTS:case Wd.PERMISSION_DENIED:case Wd.FAILED_PRECONDITION:case Wd.ABORTED:case Wd.OUT_OF_RANGE:case Wd.UNIMPLEMENTED:case Wd.DATA_LOSS:return!0}})(c=b.code)&&c!==Wd.ABORTED){const d=a.Qr.shift();pE(a).wr(),await dE(a,()=>a.remoteSyncer.rejectFailedWrite(d.batchId,b)),await eE(a)}}(a,b),hE(a)&&iE(a)}async function nE(a,b){const c=Vd(a);b?(c.Gr.delete(2),await RD(c)):b||(c.Gr.add(2),await SD(c),c.Jr.set("Unknown"))}function oE(a){return a.Xr||(a.Xr=(function(a,b,c){const d=Vd(a);return d.Fr(),new NC(b,d.ir,d.authCredentials,d.appCheckCredentials,d.k,c)})(a.datastore,a.asyncQueue,{Di:_D.bind(null,a),Ni:aE.bind(null,a),Pr:bE.bind(null,a)}),a.zr.push(async b=>{b?(a.Xr.wr(),YD(a)?XD(a):a.Jr.set("Unknown")):(await a.Xr.stop(),$D(a))})),a.Xr}function pE(a){return a.Zr||(a.Zr=(function(a,b,c){const d=Vd(a);return d.Fr(),new cD(b,d.ir,d.authCredentials,d.appCheckCredentials,d.k,c)})(a.datastore,a.asyncQueue,{Di:jE.bind(null,a),Ni:mE.bind(null,a),Nr:kE.bind(null,a),Cr:lE.bind(null,a)}),a.zr.push(async b=>{b?(a.Zr.wr(),await eE(a)):(await a.Zr.stop(),a.Qr.length>0&&(Pd("RemoteStore",`Stopping write stream with ${a.Qr.length} pending writes`),a.Qr=[]))})),a.Zr}class qE{constructor(rE,sE,tE,uE,vE){this.asyncQueue=rE,this.timerId=sE,this.targetTimeMs=tE,this.op=uE,this.removalCallback=vE,this.deferred=new $d,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(a=>{})}static createAndSchedule(wE,xE,yE,zE,AE){const BE=Date.now()+yE,CE=new qE(wE,xE,BE,zE,AE);return CE.start(yE),CE}start(DE){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),DE)}skipDelay(){return this.handleDelayElapsed()}cancel(EE){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new Xd(Wd.CANCELLED,"Operation cancelled"+(EE?": "+EE:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then(a=>this.deferred.resolve(a))):Promise.resolve())}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function FE(a,b){if(Qd("AsyncQueue",`${b}: ${a}`),pr(a))return new Xd(Wd.UNAVAILABLE,`${b}: ${a}`);throw a}class GE{constructor(HE){this.comparator=HE?(a,b)=>HE(a,b)||Ag.comparator(a.key,b.key):(a,b)=>Ag.comparator(a.key,b.key),this.keyedMap=Em(),this.sortedSet=new Hk(this.comparator)}static emptySet(IE){return new GE(IE.comparator)}has(JE){return null!=this.keyedMap.get(JE)}get(KE){return this.keyedMap.get(KE)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(LE){const ME=this.keyedMap.get(LE);return ME?this.sortedSet.indexOf(ME):-1}get size(){return this.sortedSet.size}forEach(NE){this.sortedSet.inorderTraversal((a,b)=>(NE(a),!1))}add(OE){const PE=this.delete(OE.key);return PE.copy(PE.keyedMap.insert(OE.key,OE),PE.sortedSet.insert(OE,null))}delete(QE){const RE=this.get(QE);return RE?this.copy(this.keyedMap.remove(QE),this.sortedSet.remove(RE)):this}isEqual(SE){if(!(SE instanceof GE))return!1;if(this.size!==SE.size)return!1;const TE=this.sortedSet.getIterator(),UE=SE.sortedSet.getIterator();for(;TE.hasNext();){const VE=TE.getNext().key,WE=UE.getNext().key;if(!VE.isEqual(WE))return!1}return!0}toString(){const XE=[];return this.forEach(a=>{XE.push(a.toString())}),0===XE.length?"DocumentSet ()":"DocumentSet (\n  "+XE.join("  \n")+"\n)"}copy(YE,ZE){const $E=new GE;return $E.comparator=this.comparator,$E.keyedMap=YE,$E.sortedSet=ZE,$E}}class _E{constructor(){this.eo=new Hk(Ag.comparator)}track(aF){const bF=aF.doc.key,cF=this.eo.get(bF);cF?0!==aF.type&&3===cF.type?this.eo=this.eo.insert(bF,aF):3===aF.type&&1!==cF.type?this.eo=this.eo.insert(bF,{type:cF.type,doc:aF.doc}):2===aF.type&&2===cF.type?this.eo=this.eo.insert(bF,{type:2,doc:aF.doc}):2===aF.type&&0===cF.type?this.eo=this.eo.insert(bF,{type:0,doc:aF.doc}):1===aF.type&&0===cF.type?this.eo=this.eo.remove(bF):1===aF.type&&2===cF.type?this.eo=this.eo.insert(bF,{type:1,doc:cF.doc}):0===aF.type&&1===cF.type?this.eo=this.eo.insert(bF,{type:2,doc:aF.doc}):Td():this.eo=this.eo.insert(bF,aF)}no(){const dF=[];return this.eo.inorderTraversal((a,b)=>{dF.push(b)}),dF}}class eF{constructor(fF,gF,hF,iF,jF,kF,lF,mF){this.query=fF,this.docs=gF,this.oldDocs=hF,this.docChanges=iF,this.mutatedKeys=jF,this.fromCache=kF,this.syncStateChanged=lF,this.excludesMetadataChanges=mF}static fromInitialDocuments(nF,oF,pF,qF){const rF=[];return oF.forEach(a=>{rF.push({type:0,doc:a})}),new eF(nF,oF,GE.emptySet(oF),rF,pF,qF,!0,!1)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(sF){if(!(this.fromCache===sF.fromCache&&this.syncStateChanged===sF.syncStateChanged&&this.mutatedKeys.isEqual(sF.mutatedKeys)&&uj(this.query,sF.query)&&this.docs.isEqual(sF.docs)&&this.oldDocs.isEqual(sF.oldDocs)))return!1;const tF=this.docChanges,uF=sF.docChanges;if(tF.length!==uF.length)return!1;for(let vF=0;vF<tF.length;vF++)if(tF[vF].type!==uF[vF].type||!tF[vF].doc.isEqual(uF[vF].doc))return!1;return!0}}class wF{constructor(){this.so=void 0,this.listeners=[]}}class xF{constructor(){this.queries=new au(a=>vj(a),uj),this.onlineState="Unknown",this.io=new Set}}async function yF(a,b){const c=Vd(a),d=b.query;let e=!1,f=c.queries.get(d);if(f||(e=!0,f=new wF),e)try{f.so=await c.onListen(d)}catch(g){const h=FE(g,`Initialization of query '${wj(b.query)}' failed`);return void b.onError(h)}c.queries.set(d,f),f.listeners.push(b),b.ro(c.onlineState),f.so&&b.oo(f.so)&&CF(c)}async function zF(a,b){const c=Vd(a),d=b.query;let e=!1;const f=c.queries.get(d);if(f){const g=f.listeners.indexOf(b);g>=0&&(f.listeners.splice(g,1),e=0===f.listeners.length)}if(e)return c.queries.delete(d),c.onUnlisten(d)}function AF(a,b){const c=Vd(a);let d=!1;for(const e of b){const f=e.query,g=c.queries.get(f);if(g){for(const h of g.listeners)h.oo(e)&&(d=!0);g.so=e}}d&&CF(c)}function BF(a,b,c){const d=Vd(a),e=d.queries.get(b);if(e)for(const f of e.listeners)f.onError(c);d.queries.delete(b)}function CF(a){a.io.forEach(a=>{a.next()})}class DF{constructor(EF,FF,GF){this.query=EF,this.ao=FF,this.co=!1,this.uo=null,this.onlineState="Unknown",this.options=GF||{}}oo(HF){if(!this.options.includeMetadataChanges){const IF=[];for(const JF of HF.docChanges)3!==JF.type&&IF.push(JF);HF=new eF(HF.query,HF.docs,HF.oldDocs,IF,HF.mutatedKeys,HF.fromCache,HF.syncStateChanged,!0)}let KF=!1;return this.co?this.ho(HF)&&(this.ao.next(HF),KF=!0):this.lo(HF,this.onlineState)&&(this.fo(HF),KF=!0),this.uo=HF,KF}onError(LF){this.ao.error(LF)}ro(MF){this.onlineState=MF;let NF=!1;return this.uo&&!this.co&&this.lo(this.uo,MF)&&(this.fo(this.uo),NF=!0),NF}lo(OF,PF){if(!OF.fromCache)return!0;const QF="Offline"!==PF;return(!this.options.wo||!QF)&&(!OF.docs.isEmpty()||"Offline"===PF)}ho(RF){if(RF.docChanges.length>0)return!0;const SF=this.uo&&this.uo.hasPendingWrites!==RF.hasPendingWrites;return!(!RF.syncStateChanged&&!SF)&& !0===this.options.includeMetadataChanges}fo(TF){TF=eF.fromInitialDocuments(TF.query,TF.docs,TF.mutatedKeys,TF.fromCache),this.co=!0,this.ao.next(TF)}}class UF{constructor(VF){this.key=VF}}class WF{constructor(XF){this.key=XF}}class YF{constructor(ZF,$F){this.query=ZF,this.To=$F,this.Eo=null,this.current=!1,this.Io=Im(),this.mutatedKeys=Im(),this.Ao=yj(ZF),this.Ro=new GE(this.Ao)}get Po(){return this.To}bo(_F,aG){const bG=aG?aG.vo:new _E,cG=aG?aG.Ro:this.Ro;let dG=aG?aG.mutatedKeys:this.mutatedKeys,eG=cG,fG=!1;const gG=mj(this.query)&&cG.size===this.query.limit?cG.last():null,hG=nj(this.query)&&cG.size===this.query.limit?cG.first():null;if(_F.inorderTraversal((a,b)=>{const c=cG.get(a),d=xj(this.query,b)?b:null,e=!!c&&this.mutatedKeys.has(c.key),f=!!d&&(d.hasLocalMutations||this.mutatedKeys.has(d.key)&&d.hasCommittedMutations);let g=!1;c&&d?c.data.isEqual(d.data)?e!==f&&(bG.track({type:3,doc:d}),g=!0):this.Vo(c,d)||(bG.track({type:2,doc:d}),g=!0,(gG&&this.Ao(d,gG)>0||hG&&0>this.Ao(d,hG))&&(fG=!0)):!c&&d?(bG.track({type:0,doc:d}),g=!0):c&&!d&&(bG.track({type:1,doc:c}),g=!0,(gG||hG)&&(fG=!0)),g&&(d?(eG=eG.add(d),dG=f?dG.add(a):dG.delete(a)):(eG=eG.delete(a),dG=dG.delete(a)))}),mj(this.query)||nj(this.query))for(;eG.size>this.query.limit;){const iG=mj(this.query)?eG.last():eG.first();eG=eG.delete(iG.key),dG=dG.delete(iG.key),bG.track({type:1,doc:iG})}return{Ro:eG,vo:bG,Bn:fG,mutatedKeys:dG}}Vo(jG,kG){return jG.hasLocalMutations&&kG.hasCommittedMutations&&!kG.hasLocalMutations}applyChanges(lG,mG,nG){const oG=this.Ro;this.Ro=lG.Ro,this.mutatedKeys=lG.mutatedKeys;const pG=lG.vo.no();pG.sort((a,b)=>(function(a,b){const c=a=>{switch(a){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Td()}};return c(a)-c(b)})(a.type,b.type)||this.Ao(a.doc,b.doc)),this.So(nG);const qG=mG?this.Do():[],rG=0===this.Io.size&&this.current?1:0,sG=rG!==this.Eo;return(this.Eo=rG,0!==pG.length||sG)?{snapshot:new eF(this.query,lG.Ro,oG,pG,lG.mutatedKeys,0===rG,sG,!1),Co:qG}:{Co:qG}}ro(tG){return this.current&&"Offline"===tG?(this.current=!1,this.applyChanges({Ro:this.Ro,vo:new _E,mutatedKeys:this.mutatedKeys,Bn:!1},!1)):{Co:[]}}No(uG){return!this.To.has(uG)&& !!this.Ro.has(uG)&&!this.Ro.get(uG).hasLocalMutations}So(vG){vG&&(vG.addedDocuments.forEach(a=>this.To=this.To.add(a)),vG.modifiedDocuments.forEach(a=>{}),vG.removedDocuments.forEach(a=>this.To=this.To.delete(a)),this.current=vG.current)}Do(){if(!this.current)return[];const wG=this.Io;this.Io=Im(),this.Ro.forEach(a=>{this.No(a.key)&&(this.Io=this.Io.add(a.key))});const xG=[];return wG.forEach(a=>{this.Io.has(a)||xG.push(new WF(a))}),this.Io.forEach(a=>{wG.has(a)||xG.push(new UF(a))}),xG}ko(yG){this.To=yG.zn,this.Io=Im();const zG=this.bo(yG.documents);return this.applyChanges(zG,!0)}xo(){return eF.fromInitialDocuments(this.query,this.Ro,this.mutatedKeys,0===this.Eo)}}class AG{constructor(BG,CG,DG){this.query=BG,this.targetId=CG,this.view=DG}}class EG{constructor(FG){this.key=FG,this.$o=!1}}class GG{constructor(HG,IG,JG,KG,LG,MG){this.localStore=HG,this.remoteStore=IG,this.eventManager=JG,this.sharedClientState=KG,this.currentUser=LG,this.maxConcurrentLimboResolutions=MG,this.Fo={},this.Oo=new au(a=>vj(a),uj),this.Mo=new Map,this.Lo=new Set,this.Bo=new Hk(Ag.comparator),this.Uo=new Map,this.qo=new aw,this.Ko={},this.jo=new Map,this.Qo=Zt.re(),this.onlineState="Unknown",this.Wo=void 0}get isPrimaryClient(){return!0===this.Wo}}async function NG(a,b){const c=eH(a);let d,e;const f=c.Oo.get(b);if(f)d=f.targetId,c.sharedClientState.addLocalQueryTarget(d),e=f.view.xo();else{const g=await function(a,b){const c=Vd(a);return c.persistence.runTransaction("Allocate target","readwrite",a=>{let d;return c.He.getTargetData(a,b).next(e=>e?(d=e,_p.resolve(d)):c.He.allocateTargetId(a).next(e=>(d=new xs(b,e,0,a.currentSequenceNumber),c.He.addTargetData(a,d).next(()=>d))))}).then(a=>{const d=c.qn.get(a.targetId);return(null===d||a.snapshotVersion.compareTo(d.snapshotVersion)>0)&&(c.qn=c.qn.insert(a.targetId,a),c.Kn.set(b,a.targetId)),a})}(c.localStore,sj(b)),h=c.sharedClientState.addLocalQueryTarget(g.targetId);e=await OG(c,b,d=g.targetId,"current"===h),c.isPrimaryClient&&TD(c.remoteStore,g)}return e}async function OG(a,b,c,d){a.Go=(b,c,d)=>(async function(a,b,c,d){let e=b.view.bo(c);e.Bn&&(e=await _v(a.localStore,b.query,!1).then(({documents:a})=>b.view.bo(a,e)));const f=d&&d.targetChanges.get(b.targetId),g=b.view.applyChanges(e,a.isPrimaryClient,f);return $G(a,b.targetId,g.Co),g.snapshot})(a,b,c,d);const e=await _v(a.localStore,b,!0),f=new YF(b,e.zn),g=f.bo(e.documents),h=Um.createSynthesizedTargetChangeForCurrentChange(c,d&&"Offline"!==a.onlineState),i=f.applyChanges(g,a.isPrimaryClient,h);$G(a,c,i.Co);const j=new AG(b,c,f);return a.Oo.set(b,j),a.Mo.has(c)?a.Mo.get(c).push(b):a.Mo.set(c,[b]),i.snapshot}async function PG(a,b){const c=Vd(a),d=c.Oo.get(b),e=c.Mo.get(d.targetId);if(e.length>1)return c.Mo.set(d.targetId,e.filter(a=>!uj(a,b))),void c.Oo.delete(b);c.isPrimaryClient?(c.sharedClientState.removeLocalQueryTarget(d.targetId),c.sharedClientState.isActiveQueryTarget(d.targetId)||await $v(c.localStore,d.targetId,!1).then(()=>{c.sharedClientState.clearQueryState(d.targetId),UD(c.remoteStore,d.targetId),YG(c,d.targetId)}).catch(_t)):(YG(c,d.targetId),await $v(c.localStore,d.targetId,!0))}async function QG(a,b,c){const d=fH(a);try{var e,f,g;const h=await function(a,b){const c=Vd(a),d=Ye.now(),e=b.reduce((a,b)=>a.add(b.key),Im());let f;return c.persistence.runTransaction("Locally write mutations","readwrite",a=>c.Wn.vn(a,e).next(e=>{f=e;const g=[];for(const h of b){const i=hk(h,f.get(h.key));null!=i&&g.push(new pk(h.key,i,th(i.value.mapValue),Zj.exists(!0)))}return c.An.addMutationBatch(a,d,g,b)})).then(a=>(a.applyToLocalDocumentSet(f),{batchId:a.batchId,changes:f}))}(d.localStore,b);let i;d.sharedClientState.addPendingMutation(h.batchId),e=d,f=h.batchId,g=c,(i=e.Ko[e.currentUser.toKey()])||(i=new Hk(We)),i=i.insert(f,g),e.Ko[e.currentUser.toKey()]=i,await bH(d,h.changes),await eE(d.remoteStore)}catch(j){const k=FE(j,"Failed to persist write");c.reject(k)}}async function RG(a,b){const c=Vd(a);try{const d=await function(a,b){const c=Vd(a),d=b.snapshotVersion;let e=c.qn;return c.persistence.runTransaction("Apply remote event","readwrite-primary",a=>{var f,g,h,i,j;const k=c.Qn.newChangeBuffer({trackRemovals:!0});e=c.qn;const l=[];b.targetChanges.forEach((b,f)=>{const g=e.get(f);if(g){l.push(c.He.removeMatchingKeys(a,b.removedDocuments,f).next(()=>c.He.addMatchingKeys(a,b.addedDocuments,f)));const h=b.resumeToken;if(h.approximateByteSize()>0){var i,j,k;const m=g.withResumeToken(h,d).withSequenceNumber(a.currentSequenceNumber);e=e.insert(f,m),i=g,j=m,k=b,((Ud(j.resumeToken.approximateByteSize()>0),0===i.resumeToken.approximateByteSize())?0:j.snapshotVersion.toMicroseconds()-i.snapshotVersion.toMicroseconds()>=30e7?0:!(k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0))||l.push(c.He.updateTargetData(a,m))}}});let m=Cm(),n;if(b.documentUpdates.forEach((d,e)=>{b.resolvedLimboDocuments.has(d)&&l.push(c.persistence.referenceDelegate.updateLimboDocument(a,d))}),l.push((f=a,g=k,h=b.documentUpdates,i=d,j=void 0,n=Im(),h.forEach(a=>n=n.add(a)),g.getEntries(f,n).next(a=>{let b=Cm();return h.forEach((c,d)=>{const e=a.get(c),f=(null==j?void 0:j.get(c))||i;d.isNoDocument()&&d.version.isEqual(ff.min())?(g.removeEntry(c,f),b=b.insert(c,d)):!e.isValidDocument()||d.version.compareTo(e.version)>0||0===d.version.compareTo(e.version)&&e.hasPendingWrites?(g.addEntry(d,f),b=b.insert(c,d)):Pd("LocalStore","Ignoring outdated watch update for ",c,". Current version:",e.version," Watch version:",d.version)}),b})).next(a=>{m=a})),!d.isEqual(ff.min())){const o=c.He.getLastRemoteSnapshotVersion(a).next(b=>c.He.setTargetsMetadata(a,a.currentSequenceNumber,d));l.push(o)}return _p.waitFor(l).next(()=>k.apply(a)).next(()=>c.Wn.Vn(a,m)).next(()=>m)}).then(a=>(c.qn=e,a))}(c.localStore,b);b.targetChanges.forEach((a,b)=>{const d=c.Uo.get(b);d&&(Ud(a.addedDocuments.size+a.modifiedDocuments.size+a.removedDocuments.size<=1),a.addedDocuments.size>0?d.$o=!0:a.modifiedDocuments.size>0?Ud(d.$o):a.removedDocuments.size>0&&(Ud(d.$o),d.$o=!1))}),await bH(c,d,b)}catch(e){await _t(e)}}function SG(a,b,c){const d=Vd(a);if(d.isPrimaryClient&&0===c|| !d.isPrimaryClient&&1===c){const e=[];d.Oo.forEach((a,c)=>{const d=c.view.ro(b);d.snapshot&&e.push(d.snapshot)}),(function(a,b){const c=Vd(a);c.onlineState=b;let d=!1;c.queries.forEach((a,c)=>{for(const e of c.listeners)e.ro(b)&&(d=!0)}),d&&CF(c)})(d.eventManager,b),e.length&&d.Fo.Pr(e),d.onlineState=b,d.isPrimaryClient&&d.sharedClientState.setOnlineState(b)}}async function TG(a,b,c){const d=Vd(a);d.sharedClientState.updateQueryState(b,"rejected",c);const e=d.Uo.get(b),f=e&&e.key;if(f){let g=new Hk(Ag.comparator);g=g.insert(f,uh.newNoDocument(f,ff.min()));const h=Im().add(f),i=new Lm(ff.min(),new Map,new Zl(We),g,h);await RG(d,i),d.Bo=d.Bo.remove(f),d.Uo.delete(b),aH(d)}else await $v(d.localStore,b,!1).then(()=>YG(d,b,c)).catch(_t)}async function UG(a,b){const c=Vd(a),d=b.batch.batchId;try{const e=await function(a,b){const c=Vd(a);return c.persistence.runTransaction("Acknowledge batch","readwrite-primary",a=>{const d=b.batch.keys(),e=c.Qn.newChangeBuffer({trackRemovals:!0});return(function(a,b,c,d){const e=c.batch,f=e.keys();let g=_p.resolve();return f.forEach(a=>{g=g.next(()=>d.getEntry(b,a)).next(b=>{const f=c.docVersions.get(a);Ud(null!==f),0>b.version.compareTo(f)&&(e.applyToRemoteDocument(b,c),b.isValidDocument()&&d.addEntry(b,c.commitVersion))})}),g.next(()=>a.An.removeMutationBatch(b,e))})(c,a,b,e).next(()=>e.apply(a)).next(()=>c.An.performConsistencyCheck(a)).next(()=>c.Wn.vn(a,d))})}(c.localStore,b);XG(c,d,null),WG(c,d),c.sharedClientState.updateMutationState(d,"acknowledged"),await bH(c,e)}catch(f){await _t(f)}}async function VG(a,b,c){const d=Vd(a);try{const e=await function(a,b){const c=Vd(a);return c.persistence.runTransaction("Reject batch","readwrite-primary",a=>{let d;return c.An.lookupMutationBatch(a,b).next(b=>(Ud(null!==b),d=b.keys(),c.An.removeMutationBatch(a,b))).next(()=>c.An.performConsistencyCheck(a)).next(()=>c.Wn.vn(a,d))})}(d.localStore,b);XG(d,b,c),WG(d,b),d.sharedClientState.updateMutationState(b,"rejected",c),await bH(d,e)}catch(f){await _t(f)}}function WG(a,b){(a.jo.get(b)||[]).forEach(a=>{a.resolve()}),a.jo.delete(b)}function XG(a,b,c){const d=Vd(a);let e=d.Ko[d.currentUser.toKey()];if(e){const f=e.get(b);f&&(c?f.reject(c):f.resolve(),e=e.remove(b)),d.Ko[d.currentUser.toKey()]=e}}function YG(a,b,c=null){for(const d of(a.sharedClientState.removeLocalQueryTarget(b),a.Mo.get(b)))a.Oo.delete(d),c&&a.Fo.zo(d,c);a.Mo.delete(b),a.isPrimaryClient&&a.qo.us(b).forEach(b=>{a.qo.containsKey(b)||ZG(a,b)})}function ZG(a,b){a.Lo.delete(b.path.canonicalString());const c=a.Bo.get(b);null!==c&&(UD(a.remoteStore,c),a.Bo=a.Bo.remove(b),a.Uo.delete(c),aH(a))}function $G(a,b,c){for(const d of c)d instanceof UF?(a.qo.addReference(d.key,b),_G(a,d)):d instanceof WF?(Pd("SyncEngine","Document no longer in limbo: "+d.key),a.qo.removeReference(d.key,b),a.qo.containsKey(d.key)||ZG(a,d.key)):Td()}function _G(a,b){const c=b.key,d=c.path.canonicalString();a.Bo.get(c)||a.Lo.has(d)||(Pd("SyncEngine","New document in limbo: "+c),a.Lo.add(d),aH(a))}function aH(a){for(;a.Lo.size>0&&a.Bo.size<a.maxConcurrentLimboResolutions;){const b=a.Lo.values().next().value;a.Lo.delete(b);const c=new Ag(Kf.fromString(b)),d=a.Qo.next();a.Uo.set(d,new EG(c)),a.Bo=a.Bo.insert(c,d),TD(a.remoteStore,new xs(sj(lj(c.path)),d,2,Ke.I))}}async function bH(a,b,c){const d=Vd(a),e=[],f=[],g=[];d.Oo.isEmpty()||(d.Oo.forEach((a,h)=>{g.push(d.Go(h,b,c).then(a=>{if(a){d.isPrimaryClient&&d.sharedClientState.updateQueryState(h.targetId,a.fromCache?"not-current":"current"),e.push(a);const b=qv.$n(h.targetId,a);f.push(b)}}))}),await Promise.all(g),d.Fo.Pr(e),await async function(a,b){const c=Vd(a);try{await c.persistence.runTransaction("notifyLocalViewChanges","readwrite",a=>_p.forEach(b,b=>_p.forEach(b.kn,d=>c.persistence.referenceDelegate.addReference(a,b.targetId,d)).next(()=>_p.forEach(b.xn,d=>c.persistence.referenceDelegate.removeReference(a,b.targetId,d)))))}catch(d){if(!pr(d))throw d;Pd("LocalStore","Failed to update sequence numbers: "+d)}for(const e of b){const f=e.targetId;if(!e.fromCache){const g=c.qn.get(f),h=g.snapshotVersion,i=g.withLastLimboFreeSnapshotVersion(h);c.qn=c.qn.insert(f,i)}}}(d.localStore,f))}async function cH(a,b){const c=Vd(a);if(!c.currentUser.isEqual(b)){var d,e;Pd("SyncEngine","User change. New user:",b.toKey());const f=await Xv(c.localStore,b);c.currentUser=b,e="'waitForPendingWrites' promise is rejected due to a user change.",(d=c).jo.forEach(a=>{a.forEach(a=>{a.reject(new Xd(Wd.CANCELLED,e))})}),d.jo.clear(),c.sharedClientState.handleUserChange(b,f.removedBatchIds,f.addedBatchIds),await bH(c,f.Gn)}}function dH(a,b){const c=Vd(a),d=c.Uo.get(b);if(d&&d.$o)return Im().add(d.key);{let e=Im();const f=c.Mo.get(b);if(!f)return e;for(const g of f){const h=c.Oo.get(g);e=e.unionWith(h.view.Po)}return e}}function eH(a){const b=Vd(a);return b.remoteStore.remoteSyncer.applyRemoteEvent=RG.bind(null,b),b.remoteStore.remoteSyncer.getRemoteKeysForTarget=dH.bind(null,b),b.remoteStore.remoteSyncer.rejectListen=TG.bind(null,b),b.Fo.Pr=AF.bind(null,b.eventManager),b.Fo.zo=BF.bind(null,b.eventManager),b}function fH(a){const b=Vd(a);return b.remoteStore.remoteSyncer.applySuccessfulWrite=UG.bind(null,b),b.remoteStore.remoteSyncer.rejectFailedWrite=VG.bind(null,b),b}class gH{constructor(){this.synchronizeTabs=!1}async initialize(hH){this.k=jC(hH.databaseInfo.databaseId),this.sharedClientState=this.Jo(hH),this.persistence=this.Yo(hH),await this.persistence.start(),this.gcScheduler=this.Xo(hH),this.localStore=this.Zo(hH)}Xo(iH){return null}Zo(jH){var kH;return this.persistence,kH=new Av,jH.initialUser,this.k,new Rv(this.persistence,kH,jH.initialUser,this.k)}Yo(lH){return new ly(Lz.ks,this.k)}Jo(mH){return new SA}async terminate(){this.gcScheduler&&this.gcScheduler.stop(),await this.sharedClientState.shutdown(),await this.persistence.shutdown()}}class nH{async initialize(oH,pH){this.localStore||(this.localStore=oH.localStore,this.sharedClientState=oH.sharedClientState,this.datastore=this.createDatastore(pH),this.remoteStore=this.createRemoteStore(pH),this.eventManager=this.createEventManager(pH),this.syncEngine=this.createSyncEngine(pH,!oH.synchronizeTabs),this.sharedClientState.onlineStateHandler=a=>SG(this.syncEngine,a,1),this.remoteStore.remoteSyncer.handleCredentialChange=cH.bind(null,this.syncEngine),await nE(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(qH){return new xF}createDatastore(rH){var sH,tH;const uH=jC(rH.databaseInfo.databaseId),vH=(rH.databaseInfo,new xB(rH.databaseInfo));return rH.authCredentials,rH.appCheckCredentials,sH=vH,tH=uH,new tD(rH.authCredentials,rH.appCheckCredentials,sH,tH)}createRemoteStore(wH){var xH,yH;return this.localStore,this.datastore,wH.asyncQueue,xH=a=>SG(this.syncEngine,a,0),yH=kB.bt()?new kB:new iB,new ED(this.localStore,this.datastore,wH.asyncQueue,xH,yH)}createSyncEngine(zH,AH){return(function(a,b,c,d,e,f,g){const h=new GG(a,b,c,d,e,f);return g&&(h.Wo=!0),h})(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,zH.initialUser,zH.maxConcurrentLimboResolutions,AH)}terminate(){return(async function(a){const b=Vd(a);Pd("RemoteStore","RemoteStore shutting down."),b.Gr.add(5),await SD(b),b.Hr.shutdown(),b.Jr.set("Unknown")})(this.remoteStore)}}class BH{constructor(CH){this.observer=CH,this.muted=!1}next(DH){this.observer.next&&this.ea(this.observer.next,DH)}error(EH){this.observer.error?this.ea(this.observer.error,EH):console.error("Uncaught Error in snapshot listener:",EH)}na(){this.muted=!0}ea(FH,GH){this.muted||setTimeout(()=>{this.muted||FH(GH)},0)}}class HH{constructor(IH,JH,KH,LH){this.authCredentials=IH,this.appCheckCredentials=JH,this.asyncQueue=KH,this.databaseInfo=LH,this.user=Jd.UNAUTHENTICATED,this.clientId=Qe.A(),this.authCredentialListener=()=>Promise.resolve(),this.authCredentials.start(KH,async a=>{Pd("FirestoreClient","Received user=",a.uid),await this.authCredentialListener(a),this.user=a}),this.appCheckCredentials.start(KH,()=>Promise.resolve())}async getConfiguration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(MH){this.authCredentialListener=MH}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new Xd(Wd.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();const NH=new $d;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this.onlineComponents&&await this.onlineComponents.terminate(),this.offlineComponents&&await this.offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),NH.resolve()}catch(a){const b=FE(a,"Failed to shutdown persistence");NH.reject(b)}}),NH.promise}}async function OH(a,b){a.asyncQueue.verifyOperationInProgress(),Pd("FirestoreClient","Initializing OfflineComponentProvider");const c=await a.getConfiguration();await b.initialize(c);let d=c.initialUser;a.setCredentialChangeListener(async a=>{d.isEqual(a)||(await Xv(b.localStore,a),d=a)}),b.persistence.setDatabaseDeletedListener(()=>a.terminate()),a.offlineComponents=b}async function PH(a,b){a.asyncQueue.verifyOperationInProgress();const c=await QH(a);Pd("FirestoreClient","Initializing OnlineComponentProvider");const d=await a.getConfiguration();await b.initialize(c,d),a.setCredentialChangeListener(a=>(async function(a,b){const c=Vd(a);c.asyncQueue.verifyOperationInProgress(),Pd("RemoteStore","RemoteStore received new credentials");const d=ZD(c);c.Gr.add(3),await SD(c),d&&c.Jr.set("Unknown"),await c.remoteSyncer.handleCredentialChange(b),c.Gr.delete(3),await RD(c)})(b.remoteStore,a)),a.onlineComponents=b}async function QH(a){return a.offlineComponents||(Pd("FirestoreClient","Using default OfflineComponentProvider"),await OH(a,new gH)),a.offlineComponents}async function RH(a){return a.onlineComponents||(Pd("FirestoreClient","Using default OnlineComponentProvider"),await PH(a,new nH)),a.onlineComponents}function SH(a){return QH(a).then(a=>a.localStore)}async function TH(a){const b=await RH(a),c=b.eventManager;return c.onListen=NG.bind(null,b.syncEngine),c.onUnlisten=PG.bind(null,b.syncEngine),c}function UH(a,b,c={}){const d=new $d;return a.asyncQueue.enqueueAndForget(async()=>(function(a,b,c,d,e){const f=new BH({next:f=>{b.enqueueAndForget(()=>zF(a,g));const h=f.docs.has(c);!h&&f.fromCache?e.reject(new Xd(Wd.UNAVAILABLE,"Failed to get document because the client is offline.")):h&&f.fromCache&&d&&"server"===d.source?e.reject(new Xd(Wd.UNAVAILABLE,"Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to \"server\" to retrieve the cached document.)")):e.resolve(f)},error:a=>e.reject(a)}),g=new DF(lj(c.path),f,{includeMetadataChanges:!0,wo:!0});return yF(a,g)})(await TH(a),a.asyncQueue,b,c,d)),d.promise}function VH(a,b,c={}){const d=new $d;return a.asyncQueue.enqueueAndForget(async()=>(function(a,b,c,d,e){const f=new BH({next:c=>{b.enqueueAndForget(()=>zF(a,g)),c.fromCache&&"server"===d.source?e.reject(new Xd(Wd.UNAVAILABLE,"Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to \"server\" to retrieve the cached documents.)")):e.resolve(c)},error:a=>e.reject(a)}),g=new DF(c,f,{includeMetadataChanges:!0,wo:!0});return yF(a,g)})(await TH(a),a.asyncQueue,b,c,d)),d.promise}class WH{constructor(XH,YH,ZH,$H,_H,aI,bI,cI){this.databaseId=XH,this.appId=YH,this.persistenceKey=ZH,this.host=$H,this.ssl=_H,this.forceLongPolling=aI,this.autoDetectLongPolling=bI,this.useFetchStreams=cI}}class dI{constructor(eI,fI){this.projectId=eI,this.database=fI||"(default)"}get isDefaultDatabase(){return"(default)"===this.database}isEqual(gI){return gI instanceof dI&&gI.projectId===this.projectId&&gI.database===this.database}}const hI=new Map;function iI(a,b,c){if(!c)throw new Xd(Wd.INVALID_ARGUMENT,`Function ${a}() cannot be called with an empty ${b}.`)}function jI(a){if(!Ag.isDocumentKey(a))throw new Xd(Wd.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${a} has ${a.length}.`)}function kI(a){if(Ag.isDocumentKey(a))throw new Xd(Wd.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${a} has ${a.length}.`)}function lI(a){if(void 0===a)return"undefined";if(null===a)return"null";if("string"==typeof a)return a.length>20&&(a=`${a.substring(0,20)}...`),JSON.stringify(a);if("number"==typeof a||"boolean"==typeof a)return""+a;if("object"==typeof a){if(a instanceof Array)return"an array";{var b;const c=(b=a).constructor?b.constructor.name:null;return c?`a custom ${c} object`:"an object"}}return"function"==typeof a?"a function":Td()}function mI(a,b){if("_delegate"in a&&(a=a._delegate),!(a instanceof b)){if(b.name===a.constructor.name)throw new Xd(Wd.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const c=lI(a);throw new Xd(Wd.INVALID_ARGUMENT,`Expected type '${b.name}', but it was: ${c}`)}}return a}class nI{constructor(oI){var pI;if(void 0===oI.host){if(void 0!==oI.ssl)throw new Xd(Wd.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=oI.host,this.ssl=null===(pI=oI.ssl)|| void 0===pI||pI;if(this.credentials=oI.credentials,this.ignoreUndefinedProperties=!!oI.ignoreUndefinedProperties,void 0===oI.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==oI.cacheSizeBytes&&oI.cacheSizeBytes<1048576)throw new Xd(Wd.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=oI.cacheSizeBytes}this.experimentalForceLongPolling=!!oI.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!oI.experimentalAutoDetectLongPolling,this.useFetchStreams=!!oI.useFetchStreams,(function(a,b,c,d){if(!0===b&& !0===d)throw new Xd(Wd.INVALID_ARGUMENT,`${a} and ${c} cannot be used together.`)})("experimentalForceLongPolling",oI.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",oI.experimentalAutoDetectLongPolling)}isEqual(qI){return this.host===qI.host&&this.ssl===qI.ssl&&this.credentials===qI.credentials&&this.cacheSizeBytes===qI.cacheSizeBytes&&this.experimentalForceLongPolling===qI.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===qI.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===qI.ignoreUndefinedProperties&&this.useFetchStreams===qI.useFetchStreams}}class rI{constructor(sI,tI,uI){this._authCredentials=tI,this._appCheckCredentials=uI,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new nI({}),this._settingsFrozen=!1,sI instanceof dI?this._databaseId=sI:(this._app=sI,this._databaseId=(function(a){if(!Object.prototype.hasOwnProperty.apply(a.options,["projectId"]))throw new Xd(Wd.INVALID_ARGUMENT,"\"projectId\" not provided in firebase.initializeApp.");return new dI(a.options.projectId)})(sI))}get app(){if(!this._app)throw new Xd(Wd.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return void 0!==this._terminateTask}_setSettings(vI){if(this._settingsFrozen)throw new Xd(Wd.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new nI(vI),void 0!==vI.credentials&&(this._authCredentials=(function(a){if(!a)return new ce;switch(a.type){case"gapi":const b=a.client;return Ud(!("object"!=typeof b||null===b||!b.auth||!b.auth.getAuthHeaderValueForFirstParty)),new we(b,a.sessionIndex||"0",a.iamToken||null);case"provider":return a.client;default:throw new Xd(Wd.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}})(vI.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return(function(a){const b=hI.get(a);b&&(Pd("ComponentProvider","Removing Datastore"),hI.delete(a),b.terminate())})(this),Promise.resolve()}}class wI{constructor(xI,yI,zI){this.converter=yI,this._key=zI,this.type="document",this.firestore=xI}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new GI(this.firestore,this.converter,this._key.path.popLast())}withConverter(AI){return new wI(this.firestore,AI,this._key)}}class BI{constructor(CI,DI,EI){this.converter=DI,this._query=EI,this.type="query",this.firestore=CI}withConverter(FI){return new BI(this.firestore,FI,this._query)}}class GI extends BI{constructor(HI,II,JI){super(HI,II,lj(JI)),this._path=JI,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const KI=this._path.popLast();return KI.isEmpty()?null:new wI(this.firestore,null,new Ag(KI))}withConverter(LI){return new GI(this.firestore,LI,this._path)}}function MI(a,b,...c){if(a=(0,o.m9)(a),iI("collection","path",b),a instanceof rI){const d=Kf.fromString(b,...c);return kI(d),new GI(a,null,d)}{if(!(a instanceof wI||a instanceof GI))throw new Xd(Wd.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const e=a._path.child(Kf.fromString(b,...c));return kI(e),new GI(a.firestore,null,e)}}function NI(a,b){var c;if(a=mI(a,rI),iI("collectionGroup","collection id",b),b.indexOf("/")>=0)throw new Xd(Wd.INVALID_ARGUMENT,`Invalid collection ID '${b}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new BI(a,null,(c=b,new cj(Kf.emptyPath(),c)))}function OI(a,b,...c){if(a=(0,o.m9)(a),1===arguments.length&&(b=Qe.A()),iI("doc","path",b),a instanceof rI){const d=Kf.fromString(b,...c);return jI(d),new wI(a,null,new Ag(d))}{if(!(a instanceof wI||a instanceof GI))throw new Xd(Wd.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const e=a._path.child(Kf.fromString(b,...c));return jI(e),new wI(a.firestore,a instanceof GI?a.converter:null,new Ag(e))}}function PI(a,b){return a=(0,o.m9)(a),b=(0,o.m9)(b),(a instanceof wI||a instanceof GI)&&(b instanceof wI||b instanceof GI)&&a.firestore===b.firestore&&a.path===b.path&&a.converter===b.converter}function QI(a,b){return a=(0,o.m9)(a),b=(0,o.m9)(b),a instanceof BI&&b instanceof BI&&a.firestore===b.firestore&&uj(a._query,b._query)&&a.converter===b.converter}function RI(a){return(function(a,b){if("object"!=typeof a||null===a)return!1;const c=a;for(const d of b)if(d in c&&"function"==typeof c[d])return!0;return!1})(a,["next","error","complete"])}class SI extends rI{constructor(TI,UI,VI){super(TI,UI,VI),this.type="firestore",this._queue=new class{constructor(){this.ma=Promise.resolve(),this.ga=[],this.ya=!1,this.pa=[],this.Ta=null,this.Ea=!1,this.Ia=!1,this.Aa=[],this.ur=new kC(this,"async_queue_retry"),this.Ra=()=>{const a=iC();a&&Pd("AsyncQueue","Visibility state changed to "+a.visibilityState),this.ur.er()};const WI=iC();WI&&"function"==typeof WI.addEventListener&&WI.addEventListener("visibilitychange",this.Ra)}get isShuttingDown(){return this.ya}enqueueAndForget(XI){this.enqueue(XI)}enqueueAndForgetEvenWhileRestricted(YI){this.Pa(),this.ba(YI)}enterRestrictedMode(ZI){if(!this.ya){this.ya=!0,this.Ia=ZI||!1;const $I=iC();$I&&"function"==typeof $I.removeEventListener&&$I.removeEventListener("visibilitychange",this.Ra)}}enqueue(_I){if(this.Pa(),this.ya)return new Promise(()=>{});const aJ=new $d;return this.ba(()=>this.ya&&this.Ia?Promise.resolve():(_I().then(aJ.resolve,aJ.reject),aJ.promise)).then(()=>aJ.promise)}enqueueRetryable(bJ){this.enqueueAndForget(()=>(this.ga.push(bJ),this.va()))}async va(){if(0!==this.ga.length){try{await this.ga[0](),this.ga.shift(),this.ur.reset()}catch(cJ){if(!pr(cJ))throw cJ;Pd("AsyncQueue","Operation failed with retryable error: "+cJ)}this.ga.length>0&&this.ur.Zi(()=>this.va())}}ba(dJ){const eJ=this.ma.then(()=>(this.Ea=!0,dJ().catch(a=>{var b;this.Ta=a,this.Ea=!1;let c;const d=(c=(b=a).message||"",b.stack&&(c=b.stack.includes(b.message)?b.stack:b.message+"\n"+b.stack),c);throw Qd("INTERNAL UNHANDLED ERROR: ",d),a}).then(a=>(this.Ea=!1,a))));return this.ma=eJ,eJ}enqueueAfterDelay(fJ,gJ,hJ){this.Pa(),this.Aa.indexOf(fJ)> -1&&(gJ=0);const iJ=qE.createAndSchedule(this,fJ,gJ,hJ,a=>this.Va(a));return this.pa.push(iJ),iJ}Pa(){this.Ta&&Td()}verifyOperationInProgress(){}async Sa(){let jJ;do await (jJ=this.ma);while(jJ!==this.ma)}Da(kJ){for(const lJ of this.pa)if(lJ.timerId===kJ)return!0;return!1}Ca(mJ){return this.Sa().then(()=>{for(const a of(this.pa.sort((a,b)=>a.targetTimeMs-b.targetTimeMs),this.pa))if(a.skipDelay(),"all"!==mJ&&a.timerId===mJ)break;return this.Sa()})}Na(nJ){this.Aa.push(nJ)}Va(oJ){const pJ=this.pa.indexOf(oJ);this.pa.splice(pJ,1)}},this._persistenceKey="name"in TI?TI.name:"[DEFAULT]"}_terminate(){return this._firestoreClient||sJ(this),this._firestoreClient.terminate()}}function qJ(a=(0,l.Mq)()){return(0,l.qX)(a,"firestore").getImmediate()}function rJ(a){return a._firestoreClient||sJ(a),a._firestoreClient.verifyNotTerminated(),a._firestoreClient}function sJ(a){var b,c,d;const e=a._freezeSettings(),f=(a._databaseId,c=(null===(b=a._app)|| void 0===b?void 0:b.options.appId)||"",a._persistenceKey,d=e,new WH(a._databaseId,c,a._persistenceKey,d.host,d.ssl,d.experimentalForceLongPolling,d.experimentalAutoDetectLongPolling,d.useFetchStreams));a._firestoreClient=new HH(a._authCredentials,a._appCheckCredentials,a._queue,f)}class tJ{constructor(...uJ){for(let vJ=0;vJ<uJ.length;++vJ)if(0===uJ[vJ].length)throw new Xd(Wd.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Sf(uJ)}isEqual(wJ){return this._internalPath.isEqual(wJ._internalPath)}}class xJ{constructor(yJ){this._byteString=yJ}static fromBase64String(zJ){try{return new xJ(ig.fromBase64String(zJ))}catch(AJ){throw new Xd(Wd.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+AJ)}}static fromUint8Array(BJ){return new xJ(ig.fromUint8Array(BJ))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(CJ){return this._byteString.isEqual(CJ._byteString)}}class DJ{constructor(EJ){this._methodName=EJ}}class FJ{constructor(GJ,HJ){if(!isFinite(GJ)||GJ< -90||GJ>90)throw new Xd(Wd.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+GJ);if(!isFinite(HJ)||HJ< -180||HJ>180)throw new Xd(Wd.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+HJ);this._lat=GJ,this._long=HJ}get latitude(){return this._lat}get longitude(){return this._long}isEqual(IJ){return this._lat===IJ._lat&&this._long===IJ._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(JJ){return We(this._lat,JJ._lat)||We(this._long,JJ._long)}}const KJ=/^__.*__$/;class LJ{constructor(MJ,NJ,OJ){this.data=MJ,this.fieldMask=NJ,this.fieldTransforms=OJ}toMutation(PJ,QJ){return null!==this.fieldMask?new pk(PJ,this.data,this.fieldMask,QJ,this.fieldTransforms):new kk(PJ,this.data,QJ,this.fieldTransforms)}}class RJ{constructor(SJ,TJ,UJ){this.data=SJ,this.fieldMask=TJ,this.fieldTransforms=UJ}toMutation(VJ,WJ){return new pk(VJ,this.data,this.fieldMask,WJ,this.fieldTransforms)}}function XJ(a){switch(a){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Td()}}class YJ{constructor(ZJ,$J,_J,aK,bK,cK){this.settings=ZJ,this.databaseId=$J,this.k=_J,this.ignoreUndefinedProperties=aK,void 0===bK&&this.ka(),this.fieldTransforms=bK||[],this.fieldMask=cK||[]}get path(){return this.settings.path}get xa(){return this.settings.xa}$a(dK){return new YJ(Object.assign(Object.assign({},this.settings),dK),this.databaseId,this.k,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Fa(eK){var fK;const gK=null===(fK=this.path)|| void 0===fK?void 0:fK.child(eK),hK=this.$a({path:gK,Oa:!1});return hK.Ma(eK),hK}La(iK){var jK;const kK=null===(jK=this.path)|| void 0===jK?void 0:jK.child(iK),lK=this.$a({path:kK,Oa:!1});return lK.ka(),lK}Ba(mK){return this.$a({path:void 0,Oa:!0})}Ua(nK){return XK(nK,this.settings.methodName,this.settings.qa||!1,this.path,this.settings.Ka)}contains(oK){return void 0!==this.fieldMask.find(a=>oK.isPrefixOf(a))|| void 0!==this.fieldTransforms.find(a=>oK.isPrefixOf(a.field))}ka(){if(this.path)for(let pK=0;pK<this.path.length;pK++)this.Ma(this.path.get(pK))}Ma(qK){if(0===qK.length)throw this.Ua("Document fields must not be empty");if(XJ(this.xa)&&KJ.test(qK))throw this.Ua("Document fields cannot begin and end with \"__\"")}}class rK{constructor(sK,tK,uK){this.databaseId=sK,this.ignoreUndefinedProperties=tK,this.k=uK||jC(sK)}ja(vK,wK,xK,yK=!1){return new YJ({xa:vK,methodName:wK,Ka:xK,path:Sf.emptyPath(),Oa:!1,qa:yK},this.databaseId,this.k,this.ignoreUndefinedProperties)}}function zK(a){const b=a._freezeSettings(),c=jC(a._databaseId);return new rK(a._databaseId,!!b.ignoreUndefinedProperties,c)}function AK(a,b,c,d,e,f={}){const g=a.ja(f.merge||f.mergeFields?2:0,b,c,e);TK("Data must be an object, but it was:",g,d);const h=RK(d,g);let i,j;if(f.merge)i=new dg(g.fieldMask),j=g.fieldTransforms;else if(f.mergeFields){const k=[];for(const l of f.mergeFields){const m=UK(b,l,c);if(!g.contains(m))throw new Xd(Wd.INVALID_ARGUMENT,`Field '${m}' is specified in your field mask but missing from your input data.`);YK(k,m)||k.push(m)}i=new dg(k),j=g.fieldTransforms.filter(a=>i.covers(a.field))}else i=null,j=g.fieldTransforms;return new LJ(new Yg(h),i,j)}class BK extends DJ{_toFieldTransform(CK){if(2!==CK.xa)throw 1===CK.xa?CK.Ua(`${this._methodName}() can only appear at the top level of your update data`):CK.Ua(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return CK.fieldMask.push(CK.path),null}isEqual(DK){return DK instanceof BK}}class EK extends DJ{_toFieldTransform(FK){return new Tj(FK.path,new Hj)}isEqual(GK){return GK instanceof EK}}class HK extends DJ{constructor(IK,JK){super(IK),this.Wa=JK}_toFieldTransform(KK){const LK=new Oj(KK.k,Cj(KK.k,this.Wa));return new Tj(KK.path,LK)}isEqual(MK){return this===MK}}function NK(a,b,c,d){const e=a.ja(1,b,c);TK("Data must be an object, but it was:",e,d);const f=[],g=Yg.empty();mf(d,(a,d)=>{const h=WK(b,a,c);d=(0,o.m9)(d);const i=e.La(h);if(d instanceof BK)f.push(h);else{const j=QK(d,i);null!=j&&(f.push(h),g.set(h,j))}});const h=new dg(f);return new RJ(g,h,e.fieldTransforms)}function OK(a,b,c,d,e,f){const g=a.ja(1,b,c),h=[UK(b,d,c)],i=[e];if(f.length%2!=0)throw new Xd(Wd.INVALID_ARGUMENT,`Function ${b}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let j=0;j<f.length;j+=2)h.push(UK(b,f[j])),i.push(f[j+1]);const k=[],l=Yg.empty();for(let m=h.length-1;m>=0;--m)if(!YK(k,h[m])){const n=h[m];let p=i[m];p=(0,o.m9)(p);const q=g.La(n);if(p instanceof BK)k.push(n);else{const r=QK(p,q);null!=r&&(k.push(n),l.set(n,r))}}const s=new dg(k);return new RJ(l,s,g.fieldTransforms)}function PK(a,b,c,d=!1){return QK(c,a.ja(d?4:3,b))}function QK(a,b){if(SK(a=(0,o.m9)(a)))return TK("Unsupported field value:",b,a),RK(a,b);if(a instanceof DJ)return(function(a,b){if(!XJ(b.xa))throw b.Ua(`${a._methodName}() can only be used with update() and set()`);if(!b.path)throw b.Ua(`${a._methodName}() is not currently supported inside arrays`);const c=a._toFieldTransform(b);c&&b.fieldTransforms.push(c)})(a,b),null;if(void 0===a&&b.ignoreUndefinedProperties)return null;if(b.path&&b.fieldMask.push(b.path),a instanceof Array){if(b.settings.Oa&&4!==b.xa)throw b.Ua("Nested arrays are not supported");return(function(a,b){const c=[];let d=0;for(const e of a){let f=QK(e,b.Ba(d));null==f&&(f={nullValue:"NULL_VALUE"}),c.push(f),d++}return{arrayValue:{values:c}}})(a,b)}return(function(a,b){if(null===(a=(0,o.m9)(a)))return{nullValue:"NULL_VALUE"};if("number"==typeof a)return Cj(b.k,a);if("boolean"==typeof a)return{booleanValue:a};if("string"==typeof a)return{stringValue:a};if(a instanceof Date){const c=Ye.fromDate(a);return{timestampValue:qo(b.k,c)}}if(a instanceof Ye){const d=new Ye(a.seconds,1000*Math.floor(a.nanoseconds/1000));return{timestampValue:qo(b.k,d)}}if(a instanceof FJ)return{geoPointValue:{latitude:a.latitude,longitude:a.longitude}};if(a instanceof xJ)return{bytesValue:ro(b.k,a._byteString)};if(a instanceof wI){const e=b.databaseId,f=a.firestore._databaseId;if(!f.isEqual(e))throw b.Ua(`Document reference is for database ${f.projectId}/${f.database} but should be for database ${e.projectId}/${e.database}`);return{referenceValue:to(a.firestore._databaseId||b.databaseId,a._key.path)}}throw b.Ua(`Unsupported field value: ${lI(a)}`)})(a,b)}function RK(a,b){const c={};return nf(a)?b.path&&b.path.length>0&&b.fieldMask.push(b.path):mf(a,(a,d)=>{const e=QK(d,b.Fa(a));null!=e&&(c[a]=e)}),{mapValue:{fields:c}}}function SK(a){return!("object"!=typeof a||null===a||a instanceof Array||a instanceof Date||a instanceof Ye||a instanceof FJ||a instanceof xJ||a instanceof wI||a instanceof DJ)}function TK(a,b,c){var d;if(!SK(c)||"object"!=typeof(d=c)||null===d||Object.getPrototypeOf(d)!==Object.prototype&&null!==Object.getPrototypeOf(d)){const e=lI(c);throw"an object"===e?b.Ua(a+" a custom object"):b.Ua(a+" "+e)}}function UK(a,b,c){if((b=(0,o.m9)(b))instanceof tJ)return b._internalPath;if("string"==typeof b)return WK(a,b);throw XK("Field path arguments must be of type string or FieldPath.",a,!1,void 0,c)}const VK=new RegExp("[~\\*/\\[\\]]");function WK(a,b,c){if(b.search(VK)>=0)throw XK(`Invalid field path (${b}). Paths must not contain '~', '*', '/', '[', or ']'`,a,!1,void 0,c);try{return new tJ(...b.split("."))._internalPath}catch(d){throw XK(`Invalid field path (${b}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,a,!1,void 0,c)}}function XK(a,b,c,d,e){const f=d&&!d.isEmpty(),g=void 0!==e;let h=`Function ${b}() called with invalid data`;c&&(h+=" (via `toFirestore()`)"),h+=". ";let i="";return(f||g)&&(i+=" (found",f&&(i+=` in field ${d}`),g&&(i+=` in document ${e}`),i+=")"),new Xd(Wd.INVALID_ARGUMENT,h+a+i)}function YK(a,b){return a.some(a=>a.isEqual(b))}class ZK{constructor($K,_K,aL,bL,cL){this._firestore=$K,this._userDataWriter=_K,this._key=aL,this._document=bL,this._converter=cL}get id(){return this._key.path.lastSegment()}get ref(){return new wI(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const dL=new gL(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(dL)}return this._userDataWriter.convertValue(this._document.data.value)}}get(eL){if(this._document){const fL=this._document.data.field(hL("DocumentSnapshot.get",eL));if(null!==fL)return this._userDataWriter.convertValue(fL)}}}class gL extends ZK{data(){return super.data()}}function hL(a,b){return"string"==typeof b?WK(a,b):b instanceof tJ?b._internalPath:b._delegate._internalPath}class iL{constructor(jL,kL){this.hasPendingWrites=jL,this.fromCache=kL}isEqual(lL){return this.hasPendingWrites===lL.hasPendingWrites&&this.fromCache===lL.fromCache}}class mL extends ZK{constructor(nL,oL,pL,qL,rL,sL){super(nL,oL,pL,qL,sL),this._firestore=nL,this._firestoreImpl=nL,this.metadata=rL}exists(){return super.exists()}data(tL={}){if(this._document){if(this._converter){const uL=new yL(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(uL,tL)}return this._userDataWriter.convertValue(this._document.data.value,tL.serverTimestamps)}}get(vL,wL={}){if(this._document){const xL=this._document.data.field(hL("DocumentSnapshot.get",vL));if(null!==xL)return this._userDataWriter.convertValue(xL,wL.serverTimestamps)}}}class yL extends mL{data(zL={}){return super.data(zL)}}class AL{constructor(BL,CL,DL,EL){this._firestore=BL,this._userDataWriter=CL,this._snapshot=EL,this.metadata=new iL(EL.hasPendingWrites,EL.fromCache),this.query=DL}get docs(){const FL=[];return this.forEach(a=>FL.push(a)),FL}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(GL,HL){this._snapshot.docs.forEach(a=>{GL.call(HL,new yL(this._firestore,this._userDataWriter,a.key,a,new iL(this._snapshot.mutatedKeys.has(a.key),this._snapshot.fromCache),this.query.converter))})}docChanges(IL={}){const JL=!!IL.includeMetadataChanges;if(JL&&this._snapshot.excludesMetadataChanges)throw new Xd(Wd.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===JL||(this._cachedChanges=(function(a,b){if(a._snapshot.oldDocs.isEmpty()){let c=0;return a._snapshot.docChanges.map(b=>({type:"added",doc:new yL(a._firestore,a._userDataWriter,b.doc.key,b.doc,new iL(a._snapshot.mutatedKeys.has(b.doc.key),a._snapshot.fromCache),a.query.converter),oldIndex:-1,newIndex:c++}))}{let d=a._snapshot.oldDocs;return a._snapshot.docChanges.filter(a=>b||3!==a.type).map(b=>{const c=new yL(a._firestore,a._userDataWriter,b.doc.key,b.doc,new iL(a._snapshot.mutatedKeys.has(b.doc.key),a._snapshot.fromCache),a.query.converter);let e=-1,f=-1;return 0!==b.type&&(e=d.indexOf(b.doc.key),d=d.delete(b.doc.key)),1!==b.type&&(f=(d=d.add(b.doc)).indexOf(b.doc.key)),{type:KL(b.type),doc:c,oldIndex:e,newIndex:f}})}})(this,JL),this._cachedChangesIncludeMetadataChanges=JL),this._cachedChanges}}function KL(a){switch(a){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Td()}}function LL(a){if(nj(a)&&0===a.explicitOrderBy.length)throw new Xd(Wd.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class ML{}function NL(a,...b){for(const c of b)a=c._apply(a);return a}class OL extends ML{constructor(PL,QL,RL){super(),this.Ga=PL,this.za=QL,this.Ha=RL,this.type="where"}_apply(SL){const TL=zK(SL.firestore),UL=function(a,b,c,d,e,f,g){let h;if(e.isKeyField()){if("array-contains"===f||"array-contains-any"===f)throw new Xd(Wd.INVALID_ARGUMENT,`Invalid Query. You can't perform '${f}' queries on FieldPath.documentId().`);if("in"===f||"not-in"===f){rM(g,f);const i=[];for(const j of g)i.push(qM(d,a,j));h={arrayValue:{values:i}}}else h=qM(d,a,g)}else"in"!==f&&"not-in"!==f&&"array-contains-any"!==f||rM(g,f),h=PK(c,b,g,"in"===f||"not-in"===f);const k=Zh.create(e,f,h);return(function(a,b){if(b.V()){const c=pj(a);if(null!==c&&!c.isEqual(b.field))throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '${c.toString()}' and '${b.field.toString()}'`);const d=oj(a);null!==d&&sM(a,b.field,d)}const e=function(a,b){for(const c of a.filters)if(b.indexOf(c.op)>=0)return c.op;return null}(a,function(a){switch(a){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(b.op));if(null!==e)throw e===b.op?new Xd(Wd.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${b.op.toString()}' filter.`):new Xd(Wd.INVALID_ARGUMENT,`Invalid query. You cannot use '${b.op.toString()}' filters with '${e.toString()}' filters.`)})(a,k),k}(SL._query,"where",TL,SL.firestore._databaseId,this.Ga,this.za,this.Ha);return new BI(SL.firestore,SL.converter,function(a,b){const c=a.filters.concat([b]);return new cj(a.path,a.collectionGroup,a.explicitOrderBy.slice(),c,a.limit,a.limitType,a.startAt,a.endAt)}(SL._query,UL))}}function VL(a,b,c){const d=hL("where",a);return new OL(d,b,c)}class WL extends ML{constructor(XL,YL){super(),this.Ga=XL,this.Ja=YL,this.type="orderBy"}_apply(ZL){const $L=function(a,b,c){if(null!==a.startAt)throw new Xd(Wd.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==a.endAt)throw new Xd(Wd.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");const d=new Yi(b,c);return(function(a,b){if(null===oj(a)){const c=pj(a);null!==c&&sM(a,c,b.field)}})(a,d),d}(ZL._query,this.Ga,this.Ja);return new BI(ZL.firestore,ZL.converter,function(a,b){const c=a.explicitOrderBy.concat([b]);return new cj(a.path,a.collectionGroup,c,a.filters.slice(),a.limit,a.limitType,a.startAt,a.endAt)}(ZL._query,$L))}}function _L(a,b="asc"){const c=hL("orderBy",a);return new WL(c,b)}class aM extends ML{constructor(bM,cM,dM){super(),this.type=bM,this.Ya=cM,this.Xa=dM}_apply(eM){return new BI(eM.firestore,eM.converter,tj(eM._query,this.Ya,this.Xa))}}function fM(a){return(function(a,b){if(b<=0)throw new Xd(Wd.INVALID_ARGUMENT,`Function ${a}() requires a positive number, but it was: ${b}.`)})("limit",a),new aM("limit",a,"F")}class gM extends ML{constructor(hM,iM,jM){super(),this.type=hM,this.Za=iM,this.tc=jM}_apply(kM){var lM,mM;const nM=pM(kM,this.type,this.Za,this.tc);return new BI(kM.firestore,kM.converter,(lM=kM._query,mM=nM,new cj(lM.path,lM.collectionGroup,lM.explicitOrderBy.slice(),lM.filters.slice(),lM.limit,lM.limitType,mM,lM.endAt)))}}function oM(...a){return new gM("startAfter",a,!1)}function pM(a,b,c,d){if(c[0]=(0,o.m9)(c[0]),c[0]instanceof ZK)return(function(a,b,c,d,e){if(!d)throw new Xd(Wd.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${c}().`);const f=[];for(const g of rj(a))if(g.field.isKeyField())f.push(Rg(b,d.key));else{const h=d.data.field(g.field);if(ug(h))throw new Xd(Wd.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field \""+g.field+"\" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)");if(null===h){const i=g.field.canonicalString();throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${i}' (used as the orderBy) does not exist.`)}f.push(h)}return new Ui(f,e)})(a._query,a.firestore._databaseId,b,c[0]._document,d);{const e=zK(a.firestore);return(function(a,b,c,d,e,f){const g=a.explicitOrderBy;if(e.length>g.length)throw new Xd(Wd.INVALID_ARGUMENT,`Too many arguments provided to ${d}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const h=[];for(let i=0;i<e.length;i++){const j=e[i];if(g[i].field.isKeyField()){if("string"!=typeof j)throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${d}(), but got a ${typeof j}`);if(!qj(a)&& -1!==j.indexOf("/"))throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to ${d}() must be a plain document ID, but '${j}' contains a slash.`);const k=a.path.child(Kf.fromString(j));if(!Ag.isDocumentKey(k))throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to ${d}() must result in a valid document path, but '${k}' is not because it contains an odd number of segments.`);const l=new Ag(k);h.push(Rg(b,l))}else{const m=PK(c,d,j);h.push(m)}}return new Ui(h,f)})(a._query,a.firestore._databaseId,e,b,c,d)}}function qM(a,b,c){if("string"==typeof(c=(0,o.m9)(c))){if(""===c)throw new Xd(Wd.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!qj(b)&& -1!==c.indexOf("/"))throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '${c}' contains a '/' character.`);const d=b.path.child(Kf.fromString(c));if(!Ag.isDocumentKey(d))throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '${d}' is not because it has an odd number of segments (${d.length}).`);return Rg(a,new Ag(d))}if(c instanceof wI)return Rg(a,c._key);throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: ${lI(c)}.`)}function rM(a,b){if(!Array.isArray(a)||0===a.length)throw new Xd(Wd.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${b.toString()}' filters.`);if(a.length>10)throw new Xd(Wd.INVALID_ARGUMENT,`Invalid Query. '${b.toString()}' filters support a maximum of 10 elements in the value array.`)}function sM(a,b,c){if(!c.isEqual(b))throw new Xd(Wd.INVALID_ARGUMENT,`Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '${b.toString()}' and so you must also use '${b.toString()}' as your first argument to orderBy(), but your first orderBy() is on field '${c.toString()}' instead.`)}class tM{convertValue(uM,vM="none"){switch(Kg(uM)){case 0:return null;case 1:return uM.booleanValue;case 2:return sg(uM.integerValue||uM.doubleValue);case 3:return this.convertTimestamp(uM.timestampValue);case 4:return this.convertServerTimestamp(uM,vM);case 5:return uM.stringValue;case 6:return this.convertBytes(tg(uM.bytesValue));case 7:return this.convertReference(uM.referenceValue);case 8:return this.convertGeoPoint(uM.geoPointValue);case 9:return this.convertArray(uM.arrayValue,vM);case 10:return this.convertObject(uM.mapValue,vM);default:throw Td()}}convertObject(wM,xM){const yM={};return mf(wM.fields,(a,b)=>{yM[a]=this.convertValue(b,xM)}),yM}convertGeoPoint(zM){return new FJ(sg(zM.latitude),sg(zM.longitude))}convertArray(AM,BM){return(AM.values||[]).map(a=>this.convertValue(a,BM))}convertServerTimestamp(CM,DM){switch(DM){case"previous":const EM=vg(CM);return null==EM?null:this.convertValue(EM,DM);case"estimate":return this.convertTimestamp(wg(CM));default:return null}}convertTimestamp(FM){const GM=rg(FM);return new Ye(GM.seconds,GM.nanos)}convertDocumentKey(HM,IM){const JM=Kf.fromString(HM);Ud(Lo(JM));const KM=new dI(JM.get(1),JM.get(3)),LM=new Ag(JM.popFirst(5));return KM.isEqual(IM)||Qd(`Document ${LM} contains a document reference within a different database (${KM.projectId}/${KM.database}) which is not supported. It will be treated as a reference in the current database (${IM.projectId}/${IM.database}) instead.`),LM}}function MM(a,b,c){return a?c&&(c.merge||c.mergeFields)?a.toFirestore(b,c):a.toFirestore(b):b}class NM{constructor(OM,PM){this._firestore=OM,this._commitHandler=PM,this._mutations=[],this._committed=!1,this._dataReader=zK(OM)}set(QM,RM,SM){this._verifyNotCommitted();const TM=cN(QM,this._firestore),UM=MM(TM.converter,RM,SM),VM=AK(this._dataReader,"WriteBatch.set",TM._key,UM,null!==TM.converter,SM);return this._mutations.push(VM.toMutation(TM._key,Zj.none())),this}update(WM,XM,YM,...ZM){this._verifyNotCommitted();const $M=cN(WM,this._firestore);let _M;return _M="string"==typeof(XM=(0,o.m9)(XM))||XM instanceof tJ?OK(this._dataReader,"WriteBatch.update",$M._key,XM,YM,ZM):NK(this._dataReader,"WriteBatch.update",$M._key,XM),this._mutations.push(_M.toMutation($M._key,Zj.exists(!0))),this}delete(aN){this._verifyNotCommitted();const bN=cN(aN,this._firestore);return this._mutations=this._mutations.concat(new yk(bN._key,Zj.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new Xd(Wd.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function cN(a,b){if((a=(0,o.m9)(a)).firestore!==b)throw new Xd(Wd.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return a}function dN(a){a=mI(a,wI);const b=mI(a.firestore,SI);return UH(rJ(b),a._key).then(c=>tN(b,a,c))}class eN extends tM{constructor(fN){super(),this.firestore=fN}convertBytes(gN){return new xJ(gN)}convertReference(hN){const iN=this.convertDocumentKey(hN,this.firestore._databaseId);return new wI(this.firestore,null,iN)}}function jN(a){a=mI(a,wI);const b=mI(a.firestore,SI),c=rJ(b),d=new eN(b);return(function(a,b){const c=new $d;return a.asyncQueue.enqueueAndForget(async()=>(async function(a,b,c){try{const d=await function(a,b){const c=Vd(a);return c.persistence.runTransaction("read document","readonly",a=>c.Wn.Rn(a,b))}(a,b);d.isFoundDocument()?c.resolve(d):d.isNoDocument()?c.resolve(null):c.reject(new Xd(Wd.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const f=FE(e,`Failed to get document '${b} from cache`);c.reject(f)}})(await SH(a),b,c)),c.promise})(c,a._key).then(c=>new mL(b,d,a._key,c,new iL(null!==c&&c.hasLocalMutations,!0),a.converter))}function kN(a){a=mI(a,wI);const b=mI(a.firestore,SI);return UH(rJ(b),a._key,{source:"server"}).then(c=>tN(b,a,c))}function lN(a){a=mI(a,BI);const b=mI(a.firestore,SI),c=rJ(b),d=new eN(b);return LL(a._query),VH(c,a._query).then(c=>new AL(b,d,a,c))}function mN(a){a=mI(a,BI);const b=mI(a.firestore,SI),c=rJ(b),d=new eN(b);return(function(a,b){const c=new $d;return a.asyncQueue.enqueueAndForget(async()=>(async function(a,b,c){try{const d=await _v(a,b,!0),e=new YF(b,d.zn),f=e.bo(d.documents),g=e.applyChanges(f,!1);c.resolve(g.snapshot)}catch(h){const i=FE(h,`Failed to execute query '${b} against cache`);c.reject(i)}})(await SH(a),b,c)),c.promise})(c,a._query).then(c=>new AL(b,d,a,c))}function nN(a){a=mI(a,BI);const b=mI(a.firestore,SI),c=rJ(b),d=new eN(b);return VH(c,a._query,{source:"server"}).then(c=>new AL(b,d,a,c))}function oN(a,b,c){a=mI(a,wI);const d=mI(a.firestore,SI),e=MM(a.converter,b,c);return sN(d,[AK(zK(d),"setDoc",a._key,e,null!==a.converter,c).toMutation(a._key,Zj.none())])}function pN(a,b,c,...d){a=mI(a,wI);const e=mI(a.firestore,SI),f=zK(e);return sN(e,[("string"==typeof(b=(0,o.m9)(b))||b instanceof tJ?OK(f,"updateDoc",a._key,b,c,d):NK(f,"updateDoc",a._key,b)).toMutation(a._key,Zj.exists(!0))])}function qN(a){return sN(mI(a.firestore,SI),[new yk(a._key,Zj.none())])}function rN(a,...b){var c,d,e;a=(0,o.m9)(a);let f={includeMetadataChanges:!1},g=0;"object"!=typeof b[g]||RI(b[g])||(f=b[g],g++);const h={includeMetadataChanges:f.includeMetadataChanges};if(RI(b[g])){const i=b[g];b[g]=null===(c=i.next)|| void 0===c?void 0:c.bind(i),b[g+1]=null===(d=i.error)|| void 0===d?void 0:d.bind(i),b[g+2]=null===(e=i.complete)|| void 0===e?void 0:e.bind(i)}let j,k,l;if(a instanceof wI)k=mI(a.firestore,SI),l=lj(a._key.path),j={next:c=>{b[g]&&b[g](tN(k,a,c))},error:b[g+1],complete:b[g+2]};else{const m=mI(a,BI);k=mI(m.firestore,SI),l=m._query;const n=new eN(k);j={next:a=>{b[g]&&b[g](new AL(k,n,m,a))},error:b[g+1],complete:b[g+2]},LL(a._query)}return(function(a,b,c,d){const e=new BH(d),f=new DF(b,e,c);return a.asyncQueue.enqueueAndForget(async()=>yF(await TH(a),f)),()=>{e.na(),a.asyncQueue.enqueueAndForget(async()=>zF(await TH(a),f))}})(rJ(k),l,h,j)}function sN(a,b){return(function(a,b){const c=new $d;return a.asyncQueue.enqueueAndForget(async()=>QG(await RH(a).then(a=>a.syncEngine),b,c)),c.promise})(rJ(a),b)}function tN(a,b,c){const d=c.docs.get(b._key),e=new eN(a);return new mL(a,e,b._key,d,new iL(c.hasPendingWrites,c.fromCache),b.converter)}function uN(){return new EK("serverTimestamp")}function vN(a){return new HK("increment",a)}function wN(a){return rJ(a=mI(a,SI)),new NM(a,b=>sN(a,b))}!function(a,b=!0){Md=l.Jn,(0,l.Xd)(new m.wA("firestore",(a,{options:c})=>{const d=a.getProvider("app").getImmediate(),e=new SI(d,new fe(a.getProvider("auth-internal")),new Ee(a.getProvider("app-check-internal")));return c=Object.assign({useFetchStreams:b},c),e._setSettings(c),e},"PUBLIC")),(0,l.KN)(Id,"3.4.1",void 0),(0,l.KN)(Id,"3.4.1","esm2017")}()},1153:function(a,b,c){"use strict";c.d(b,{Jt:function(){return rd},cF:function(){return td},iH:function(){return sd},B0:function(){return qd}});var d,e,f=c(2238),g=c(4444),h=c(8463);const i="firebasestorage.googleapis.com",j="storageBucket";class k extends g.ZR{constructor(l,m){super(p(l),`Firebase Storage: ${m} (${p(l)})`),this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,k.prototype)}_codeEquals(n){return p(n)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(o){this.customData.serverResponse=o,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}function p(a){return"storage/"+a}function q(){return new k("unknown","An unknown error occurred, please check the error payload for server response.")}function r(){return new k("canceled","User canceled the upload/download.")}function s(){return new k("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function t(a){return new k("invalid-argument",a)}function u(){return new k("app-deleted","The Firebase app was deleted.")}function v(a,b){return new k("invalid-format","String does not match format '"+a+"': "+b)}function w(a){throw new k("internal-error","Internal error: "+a)}class x{constructor(y,z){this.bucket=y,this.path_=z}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const A=encodeURIComponent;return"/b/"+A(this.bucket)+"/o/"+A(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(B,C){var D;let E;try{E=x.makeFromUrl(B,C)}catch(F){return new x(B,"")}if(""===E.path)return E;throw D=B,new k("invalid-default-bucket","Invalid default bucket '"+D+"'.")}static makeFromUrl(G,H){let I=null;const J="([A-Za-z0-9.\\-_]+)",K=new RegExp("^gs://"+J+"(/(.*))?$","i");function L(a){a.path_=decodeURIComponent(a.path)}const M=H.replace(/[.]/g,"\\."),N=new RegExp(`^https?://${M}/v[A-Za-z0-9_]+/b/${J}/o(/([^?#]*).*)?$`,"i"),O=new RegExp(`^https?://${H===i?"(?:storage.googleapis.com|storage.cloud.google.com)":H}/${J}/([^?#]*)`,"i"),P=[{regex:K,indices:{bucket:1,path:3},postModify:function(a){"/"===a.path.charAt(a.path.length-1)&&(a.path_=a.path_.slice(0,-1))}},{regex:N,indices:{bucket:1,path:3},postModify:L},{regex:O,indices:{bucket:1,path:2},postModify:L}];for(let Q=0;Q<P.length;Q++){const R=P[Q],S=R.regex.exec(G);if(S){const T=S[R.indices.bucket];let U=S[R.indices.path];U||(U=""),I=new x(T,U),R.postModify(I);break}}if(null==I){var V;throw V=G,new k("invalid-url","Invalid URL '"+V+"'.")}return I}}class W{constructor(X){this.promise_=Promise.reject(X)}getPromise(){return this.promise_}cancel(Y=!1){}}function Z(a){return"string"==typeof a||a instanceof String}function $(a){return _()&&a instanceof Blob}function _(){return"undefined"!=typeof Blob}function aa(a,b,c,d){if(d<b)throw t(`Invalid value for '${a}'. Expected ${b} or greater.`);if(d>c)throw t(`Invalid value for '${a}'. Expected ${c} or less.`)}function ba(a,b,c){let d=b;return null==c&&(d=`https://${b}`),`${c}://${d}/v0${a}`}function ca(a){const b=encodeURIComponent;let c="?";for(const d in a)if(a.hasOwnProperty(d)){const e=b(d)+"="+b(a[d]);c=c+e+"&"}return c=c.slice(0,-1)}(d=e||(e={}))[d.NO_ERROR=0]="NO_ERROR",d[d.NETWORK_ERROR=1]="NETWORK_ERROR",d[d.ABORT=2]="ABORT";class da{constructor(ea,fa,ga,ha,ia,ja,ka,la,ma,na,oa){this.url_=ea,this.method_=fa,this.headers_=ga,this.body_=ha,this.successCodes_=ia,this.additionalRetryCodes_=ja,this.callback_=ka,this.errorCallback_=la,this.timeout_=ma,this.progressCallback_=na,this.connectionFactory_=oa,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise((a,b)=>{this.resolve_=a,this.reject_=b,this.start_()})}start_(){const pa=(a,b)=>{const c=this.resolve_,d=this.reject_,e=b.connection;if(b.wasSuccessCode)try{var f;const g=this.callback_(e,e.getResponse());(f=g,void 0!==f)?c(g):c()}catch(h){d(h)}else if(null!==e){const i=q();i.serverResponse=e.getErrorText(),d(this.errorCallback_?this.errorCallback_(e,i):i)}else if(b.canceled){const j=this.appDelete_?u():r();d(j)}else{const l=new k("retry-limit-exceeded","Max retry time for operation exceeded, please try again.");d(l)}};this.canceled_?pa(!1,new ua(!1,null,!0)):this.backoffId_=(function(a,b,c){let d=1,e=null,f=null,g=!1,h=0;function i(){return 2===h}let j=!1;function k(...a){j||(j=!0,b.apply(null,a))}function l(b){e=setTimeout(()=>{e=null,a(n,i())},b)}function m(){f&&clearTimeout(f)}function n(a,...b){if(j){m();return}if(a){m(),k.call(null,a,...b);return}const c=i()||g;if(c){m(),k.call(null,a,...b);return}d<64&&(d*=2);let e;1===h?(h=2,e=0):e=(d+Math.random())*1000,l(e)}let o=!1;function p(a){o||(o=!0,m(),!j&&(null!==e?(a||(h=2),clearTimeout(e),l(0)):a||(h=1)))}return l(0),f=setTimeout(()=>{g=!0,p(!0)},c),p})((a,b)=>{if(b){a(!1,new ua(!1,null,!0));return}const c=this.connectionFactory_();this.pendingConnection_=c;const d=a=>{const b=a.loaded,c=a.lengthComputable?a.total:-1;null!==this.progressCallback_&&this.progressCallback_(b,c)};null!==this.progressCallback_&&c.addUploadProgressListener(d),c.send(this.url_,this.method_,this.body_,this.headers_).then(()=>{null!==this.progressCallback_&&c.removeUploadProgressListener(d),this.pendingConnection_=null;const b=c.getErrorCode()===e.NO_ERROR,f=c.getStatus();if(!b||this.isRetryStatusCode_(f)){const g=c.getErrorCode()===e.ABORT;a(!1,new ua(!1,null,g));return}const h=-1!==this.successCodes_.indexOf(f);a(!0,new ua(h,c))})},pa,this.timeout_)}getPromise(){return this.promise_}cancel(qa){this.canceled_=!0,this.appDelete_=qa||!1,null!==this.backoffId_&&(function(a){a(!1)})(this.backoffId_),null!==this.pendingConnection_&&this.pendingConnection_.abort()}isRetryStatusCode_(ra){const sa=-1!==[408,429].indexOf(ra),ta=-1!==this.additionalRetryCodes_.indexOf(ra);return ra>=500&&ra<600||sa||ta}}class ua{constructor(va,wa,xa){this.wasSuccessCode=va,this.connection=wa,this.canceled=!!xa}}function ya(...a){const b="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0;if(void 0!==b){const c=new b();for(let d=0;d<a.length;d++)c.append(a[d]);return c.getBlob()}if(_())return new Blob(a);throw new k("unsupported-environment","This browser doesn't seem to support creating Blobs")}const za={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class Aa{constructor(Ba,Ca){this.data=Ba,this.contentType=Ca||null}}function Da(a){const b=[];for(let c=0;c<a.length;c++){let d=a.charCodeAt(c);if(d<=127)b.push(d);else if(d<=2047)b.push(192|d>>6,128|63&d);else if((64512&d)==55296){const e=c<a.length-1&&(64512&a.charCodeAt(c+1))==56320;if(e){const f=d,g=a.charCodeAt(++c);d=65536|(1023&f)<<10|1023&g,b.push(240|d>>18,128|d>>12&63,128|d>>6&63,128|63&d)}else b.push(239,191,189)}else(64512&d)==56320?b.push(239,191,189):b.push(224|d>>12,128|d>>6&63,128|63&d)}return new Uint8Array(b)}function Ea(a,b){switch(a){case za.BASE64:{const c=-1!==b.indexOf("-"),d=-1!==b.indexOf("_");if(c||d){const e=c?"-":"_";throw v(a,"Invalid character '"+e+"' found: is it base64url encoded?")}break}case za.BASE64URL:{const f=-1!==b.indexOf("+"),g=-1!==b.indexOf("/");if(f||g){const h=f?"+":"/";throw v(a,"Invalid character '"+h+"' found: is it base64 encoded?")}b=b.replace(/-/g,"+").replace(/_/g,"/");break}}let i;try{var j;i=(j=b,atob(j))}catch(k){throw v(a,"Invalid character found")}const l=new Uint8Array(i.length);for(let m=0;m<i.length;m++)l[m]=i.charCodeAt(m);return l}class Fa{constructor(Ga){this.base64=!1,this.contentType=null;const Ha=Ga.match(/^data:([^,]+)?,/);if(null===Ha)throw v(za.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const Ia=Ha[1]||null;null!=Ia&&(this.base64=(function(a,b){const c=a.length>=b.length;return!!c&&a.substring(a.length-b.length)===b})(Ia,";base64"),this.contentType=this.base64?Ia.substring(0,Ia.length-7):Ia),this.rest=Ga.substring(Ga.indexOf(",")+1)}}class Ja{constructor(Ka,La){let Ma=0,Na="";$(Ka)?(this.data_=Ka,Ma=Ka.size,Na=Ka.type):Ka instanceof ArrayBuffer?(La?this.data_=new Uint8Array(Ka):(this.data_=new Uint8Array(Ka.byteLength),this.data_.set(new Uint8Array(Ka))),Ma=this.data_.length):Ka instanceof Uint8Array&&(La?this.data_=Ka:(this.data_=new Uint8Array(Ka.length),this.data_.set(Ka)),Ma=Ka.length),this.size_=Ma,this.type_=Na}size(){return this.size_}type(){return this.type_}slice(Oa,Pa){if($(this.data_)){var Qa,Ra,Sa;const Ta=this.data_,Ua=(Qa=Ta,Ra=Oa,Sa=Pa,Qa.webkitSlice?Qa.webkitSlice(Ra,Sa):Qa.mozSlice?Qa.mozSlice(Ra,Sa):Qa.slice?Qa.slice(Ra,Sa):null);return null===Ua?null:new Ja(Ua)}{const Va=new Uint8Array(this.data_.buffer,Oa,Pa-Oa);return new Ja(Va,!0)}}static getBlob(...Wa){if(_()){const Xa=Wa.map(a=>a instanceof Ja?a.data_:a);return new Ja(ya.apply(null,Xa))}{const Ya=Wa.map(a=>Z(a)?(function(a,b){switch(a){case za.RAW:return new Aa(Da(b));case za.BASE64:case za.BASE64URL:return new Aa(Ea(a,b));case za.DATA_URL:return new Aa(function(a){const b=new Fa(a);return b.base64?Ea(za.BASE64,b.rest):(function(a){let b;try{b=decodeURIComponent(a)}catch(c){throw v(za.DATA_URL,"Malformed data URL.")}return Da(b)})(b.rest)}(b),function(a){const b=new Fa(a);return b.contentType}(b))}throw q()})(za.RAW,a).data:a.data_);let Za=0;Ya.forEach(a=>{Za+=a.byteLength});const $a=new Uint8Array(Za);let _a=0;return Ya.forEach(a=>{for(let b=0;b<a.length;b++)$a[_a++]=a[b]}),new Ja($a,!0)}}uploadData(){return this.data_}}function ab(a){var b;let c;try{c=JSON.parse(a)}catch(d){return null}return"object"!=typeof(b=c)||Array.isArray(b)?null:c}function bb(a){const b=a.lastIndexOf("/",a.length-2);return -1===b?a:a.slice(b+1)}class cb{constructor(db,eb,fb,gb){this.server=db,this.local=eb||db,this.writable=!!fb,this.xform=gb||function(a,b){return b}}}let hb=null;function ib(){if(hb)return hb;const a=[];a.push(new cb("bucket")),a.push(new cb("generation")),a.push(new cb("metageneration")),a.push(new cb("name","fullPath",!0));const b=new cb("name");b.xform=function(a,b){var c;return!Z(c=b)||c.length<2?c:bb(c)},a.push(b);const c=new cb("size");return c.xform=function(a,b){return void 0!==b?Number(b):b},a.push(c),a.push(new cb("timeCreated")),a.push(new cb("updated")),a.push(new cb("md5Hash",null,!0)),a.push(new cb("cacheControl",null,!0)),a.push(new cb("contentDisposition",null,!0)),a.push(new cb("contentEncoding",null,!0)),a.push(new cb("contentLanguage",null,!0)),a.push(new cb("contentType",null,!0)),a.push(new cb("metadata","customMetadata",!0)),hb=a}function jb(a,b,c){const d=ab(b);return null===d?null:(function(a,b,c){var d,e;const f={};f.type="file";const g=c.length;for(let h=0;h<g;h++){const i=c[h];f[i.local]=i.xform(f,b[i.server])}return d=f,e=a,Object.defineProperty(d,"ref",{get:function(){const a=d.bucket,b=d.fullPath,c=new x(a,b);return e._makeStorageReference(c)}}),f})(a,d,c)}function kb(a,b){const c={},d=b.length;for(let e=0;e<d;e++){const f=b[e];f.writable&&(c[f.server]=a[f.local])}return JSON.stringify(c)}const lb="prefixes",mb="items";class nb{constructor(ob,pb,qb,rb){this.url=ob,this.method=pb,this.handler=qb,this.timeout=rb,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function sb(a){if(!a)throw q()}function tb(a,b){return function(c,d){const e=jb(a,d,b);return sb(null!==e),e}}function ub(a){return function(b,c){var d,e;let f;return(f=401===b.getStatus()?b.getErrorText().includes("Firebase App Check token is invalid")?new k("unauthorized-app","This app does not have permission to access Firebase Storage on this project."):new k("unauthenticated","User is not authenticated, please authenticate using Firebase Authentication and try again."):402===b.getStatus()?(d=a.bucket,new k("quota-exceeded","Quota for bucket '"+d+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===b.getStatus()?(e=a.path,new k("unauthorized","User does not have permission to access '"+e+"'.")):c).serverResponse=c.serverResponse,f}}function vb(a){const b=ub(a);return function(c,d){let e=b(c,d);if(404===c.getStatus()){var f;e=(f=a.path,new k("object-not-found","Object '"+f+"' does not exist."))}return e.serverResponse=d.serverResponse,e}}function wb(a,b,c){const d=Object.assign({},c);if(d.fullPath=a.path,d.size=b.size(),!d.contentType){var e,f;d.contentType=(e=null,f=b,e&&e.contentType||f&&f.type()||"application/octet-stream")}return d}class xb{constructor(yb,zb,Ab,Bb){this.current=yb,this.total=zb,this.finalized=!!Ab,this.metadata=Bb||null}}function Cb(a,b){let c=null;try{c=a.getResponseHeader("X-Goog-Upload-Status")}catch(d){sb(!1)}return sb(!!c&& -1!==(b||["active"]).indexOf(c)),c}function Db(a){switch(a){case"running":case"pausing":case"canceling":return"running";case"paused":return"paused";case"success":return"success";case"canceled":return"canceled";case"error":return"error";default:return"error"}}class Eb{constructor(Fb,Gb,Hb){if("function"==typeof Fb||null!=Gb||null!=Hb)this.next=Fb,this.error=null!=Gb?Gb:void 0,this.complete=null!=Hb?Hb:void 0;else{const Ib=Fb;this.next=Ib.next,this.error=Ib.error,this.complete=Ib.complete}}}function Jb(a){return(...b)=>{Promise.resolve().then(()=>a(...b))}}class Kb{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest(),this.initXhr(),this.errorCode_=e.NO_ERROR,this.sendPromise_=new Promise(a=>{this.xhr_.addEventListener("abort",()=>{this.errorCode_=e.ABORT,a()}),this.xhr_.addEventListener("error",()=>{this.errorCode_=e.NETWORK_ERROR,a()}),this.xhr_.addEventListener("load",()=>{a()})})}send(Lb,Mb,Nb,Ob){if(this.sent_)throw w("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(Mb,Lb,!0),void 0!==Ob)for(const Pb in Ob)Ob.hasOwnProperty(Pb)&&this.xhr_.setRequestHeader(Pb,Ob[Pb].toString());return void 0!==Nb?this.xhr_.send(Nb):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw w("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw w("cannot .getStatus() before sending");try{return this.xhr_.status}catch(Qb){return -1}}getResponse(){if(!this.sent_)throw w("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw w("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(Rb){return this.xhr_.getResponseHeader(Rb)}addUploadProgressListener(Sb){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",Sb)}removeUploadProgressListener(Tb){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",Tb)}}class Ub extends Kb{initXhr(){this.xhr_.responseType="text"}}function Vb(){return new Ub()}class Wb{constructor(Xb,Yb,Zb=null){this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=Xb,this._blob=Yb,this._metadata=Zb,this._mappings=ib(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=a=>{this._request=void 0,this._chunkMultiplier=1,a._codeEquals("canceled")?(this._needToFetchStatus=!0,this.completeTransitions_()):(this._error=a,this._transition("error"))},this._metadataErrorHandler=a=>{this._request=void 0,a._codeEquals("canceled")?this.completeTransitions_():(this._error=a,this._transition("error"))},this._promise=new Promise((a,b)=>{this._resolve=a,this._reject=b,this._start()}),this._promise.then(null,()=>{})}_makeProgressCallback(){const $b=this._transferred;return a=>this._updateProgress($b+a)}_shouldDoResumable(_b){return _b.size()>262144}_start(){"running"===this._state&& void 0===this._request&&(this._resumable?void 0===this._uploadUrl?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())}_resolveToken(ac){Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(([a,b])=>{switch(this._state){case"running":ac(a,b);break;case"canceling":this._transition("canceled");break;case"pausing":this._transition("paused");break}})}_createResumable(){this._resolveToken((a,b)=>{const c=function(a,b,c,d,e){const f=b.bucketOnlyServerUrl(),g=wb(b,d,e),h={name:g.fullPath},i=ba(f,a.host,a._protocol),j={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${d.size()}`,"X-Goog-Upload-Header-Content-Type":g.contentType,"Content-Type":"application/json; charset=utf-8"},k=kb(g,c),l=a.maxUploadRetryTime,m=new nb(i,"POST",function(a){Cb(a);let b;try{b=a.getResponseHeader("X-Goog-Upload-URL")}catch(c){sb(!1)}return sb(Z(b)),b},l);return m.urlParams=h,m.headers=j,m.body=k,m.errorHandler=ub(b),m}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),d=this._ref.storage._makeRequest(c,Vb,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._uploadUrl=a,this._needToFetchStatus=!1,this.completeTransitions_()},this._errorHandler)})}_fetchStatus(){const bc=this._uploadUrl;this._resolveToken((a,b)=>{const c=function(a,b,c,d){const e=a.maxUploadRetryTime,f=new nb(c,"POST",function(a){const b=Cb(a,["active","final"]);let c=null;try{c=a.getResponseHeader("X-Goog-Upload-Size-Received")}catch(e){sb(!1)}c||sb(!1);const f=Number(c);return sb(!isNaN(f)),new xb(f,d.size(),"final"===b)},e);return f.headers={"X-Goog-Upload-Command":"query"},f.errorHandler=ub(b),f}(this._ref.storage,this._ref._location,bc,this._blob),d=this._ref.storage._makeRequest(c,Vb,a,b);this._request=d,d.getPromise().then(a=>{a=a,this._request=void 0,this._updateProgress(a.current),this._needToFetchStatus=!1,a.finalized&&(this._needToFetchMetadata=!0),this.completeTransitions_()},this._errorHandler)})}_continueUpload(){const cc=262144*this._chunkMultiplier,dc=new xb(this._transferred,this._blob.size()),ec=this._uploadUrl;this._resolveToken((a,b)=>{let c;try{c=(function(a,b,c,d,e,f,g,h){const i=new xb(0,0);if(g?(i.current=g.current,i.total=g.total):(i.current=0,i.total=d.size()),d.size()!==i.total)throw new k("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.");const j=i.total-i.current;let l=j;e>0&&(l=Math.min(l,e));const m=i.current,n={"X-Goog-Upload-Command":l===j?"upload, finalize":"upload","X-Goog-Upload-Offset":`${i.current}`},o=d.slice(m,m+l);if(null===o)throw s();const p=b.maxUploadRetryTime,q=new nb(c,"POST",function(a,c){const e=Cb(a,["active","final"]),g=i.current+l,h=d.size();let j;return j="final"===e?tb(b,f)(a,c):null,new xb(g,h,"final"===e,j)},p);return q.headers=n,q.body=o.uploadData(),q.progressCallback=h||null,q.errorHandler=ub(a),q})(this._ref._location,this._ref.storage,ec,this._blob,cc,this._mappings,dc,this._makeProgressCallback())}catch(d){this._error=d,this._transition("error");return}const e=this._ref.storage._makeRequest(c,Vb,a,b);this._request=e,e.getPromise().then(a=>{this._increaseMultiplier(),this._request=void 0,this._updateProgress(a.current),a.finalized?(this._metadata=a.metadata,this._transition("success")):this.completeTransitions_()},this._errorHandler)})}_increaseMultiplier(){const fc=262144*this._chunkMultiplier;fc<33554432&&(this._chunkMultiplier*=2)}_fetchMetadata(){this._resolveToken((a,b)=>{const c=function(a,b,c){const d=b.fullServerUrl(),e=ba(d,a.host,a._protocol),f=a.maxOperationRetryTime,g=new nb(e,"GET",tb(a,c),f);return g.errorHandler=vb(b),g}(this._ref.storage,this._ref._location,this._mappings),d=this._ref.storage._makeRequest(c,Vb,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._transition("success")},this._metadataErrorHandler)})}_oneShotUpload(){this._resolveToken((a,b)=>{const c=function(a,b,c,d,e){const f=b.bucketOnlyServerUrl(),g={"X-Goog-Upload-Protocol":"multipart"},h=function(){let a="";for(let b=0;b<2;b++)a+=Math.random().toString().slice(2);return a}();g["Content-Type"]="multipart/related; boundary="+h;const i=wb(b,d,e),j=kb(i,c),k="--"+h+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+j+"\r\n--"+h+"\r\nContent-Type: "+i.contentType+"\r\n\r\n",l=Ja.getBlob(k,d,"\r\n--"+h+"--");if(null===l)throw s();const m={name:i.fullPath},n=ba(f,a.host,a._protocol),o=a.maxUploadRetryTime,p=new nb(n,"POST",tb(a,c),o);return p.urlParams=m,p.headers=g,p.body=l.uploadData(),p.errorHandler=ub(b),p}(this._ref.storage,this._ref._location,this._mappings,this._blob,this._metadata),d=this._ref.storage._makeRequest(c,Vb,a,b);this._request=d,d.getPromise().then(a=>{this._request=void 0,this._metadata=a,this._updateProgress(this._blob.size()),this._transition("success")},this._errorHandler)})}_updateProgress(gc){const hc=this._transferred;this._transferred=gc,this._transferred!==hc&&this._notifyObservers()}_transition(ic){if(this._state!==ic)switch(ic){case"canceling":this._state=ic,void 0!==this._request&&this._request.cancel();break;case"pausing":this._state=ic,void 0!==this._request&&this._request.cancel();break;case"running":const jc="paused"===this._state;this._state=ic,jc&&(this._notifyObservers(),this._start());break;case"paused":this._state=ic,this._notifyObservers();break;case"canceled":this._error=r(),this._state=ic,this._notifyObservers();break;case"error":this._state=ic,this._notifyObservers();break;case"success":this._state=ic,this._notifyObservers();break}}completeTransitions_(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}}get snapshot(){const kc=Db(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:kc,metadata:this._metadata,task:this,ref:this._ref}}on(lc,mc,nc,oc){const pc=new Eb(mc||void 0,nc||void 0,oc||void 0);return this._addObserver(pc),()=>{this._removeObserver(pc)}}then(qc,rc){return this._promise.then(qc,rc)}catch(sc){return this.then(null,sc)}_addObserver(tc){this._observers.push(tc),this._notifyObserver(tc)}_removeObserver(uc){const vc=this._observers.indexOf(uc);-1!==vc&&this._observers.splice(vc,1)}_notifyObservers(){this._finishPromise();const wc=this._observers.slice();wc.forEach(a=>{this._notifyObserver(a)})}_finishPromise(){if(void 0!==this._resolve){let xc=!0;switch(Db(this._state)){case"success":Jb(this._resolve.bind(null,this.snapshot))();break;case"canceled":case"error":const yc=this._reject;Jb(yc.bind(null,this._error))();break;default:xc=!1;break}xc&&(this._resolve=void 0,this._reject=void 0)}}_notifyObserver(zc){const Ac=Db(this._state);switch(Ac){case"running":case"paused":zc.next&&Jb(zc.next.bind(zc,this.snapshot))();break;case"success":zc.complete&&Jb(zc.complete.bind(zc))();break;case"canceled":case"error":zc.error&&Jb(zc.error.bind(zc,this._error))();break;default:zc.error&&Jb(zc.error.bind(zc,this._error))()}}resume(){const Bc="paused"===this._state||"pausing"===this._state;return Bc&&this._transition("running"),Bc}pause(){const Cc="running"===this._state;return Cc&&this._transition("pausing"),Cc}cancel(){const Dc="running"===this._state||"pausing"===this._state;return Dc&&this._transition("canceling"),Dc}}class Ec{constructor(Fc,Gc){this._service=Fc,Gc instanceof x?this._location=Gc:this._location=x.makeFromUrl(Gc,Fc.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(Hc,Ic){return new Ec(Hc,Ic)}get root(){const Jc=new x(this._location.bucket,"");return this._newRef(this._service,Jc)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return bb(this._location.path)}get storage(){return this._service}get parent(){const Kc=function(a){if(0===a.length)return null;const b=a.lastIndexOf("/");if(-1===b)return"";const c=a.slice(0,b);return c}(this._location.path);if(null===Kc)return null;const Lc=new x(this._location.bucket,Kc);return new Ec(this._service,Lc)}_throwIfRoot(Mc){if(""===this._location.path){var Nc;throw Nc=Mc,new k("invalid-root-operation","The operation '"+Nc+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}}}async function Oc(a,b,c){const d=await Pc(a,{pageToken:c});b.prefixes.push(...d.prefixes),b.items.push(...d.items),null!=d.nextPageToken&&await Oc(a,b,d.nextPageToken)}function Pc(a,b){null!=b&&"number"==typeof b.maxResults&&aa("options.maxResults",1,1000,b.maxResults);const c=b||{},d=function(a,b,c,d,e){var f,g;const h={};b.isRoot?h.prefix="":h.prefix=b.path+"/",c&&c.length>0&&(h.delimiter=c),d&&(h.pageToken=d),e&&(h.maxResults=e);const i=b.bucketOnlyServerUrl(),j=ba(i,a.host,a._protocol),k=a.maxOperationRetryTime,l=new nb(j,"GET",(f=a,g=b.bucket,function(a,b){const c=function(a,b,c){const d=ab(c);return null===d?null:(function(a,b,c){const d={prefixes:[],items:[],nextPageToken:c.nextPageToken};if(c[lb])for(const e of c[lb]){const f=e.replace(/\/$/,""),g=a._makeStorageReference(new x(b,f));d.prefixes.push(g)}if(c[mb])for(const h of c[mb]){const i=a._makeStorageReference(new x(b,h.name));d.items.push(i)}return d})(a,b,d)}(f,g,b);return sb(null!==c),c}),k);return l.urlParams=h,l.errorHandler=ub(b),l}(a.storage,a._location,"/",c.pageToken,c.maxResults);return a.storage.makeRequestWithTokens(d,Vb)}function Qc(a,b){if(a instanceof Sc){const c=a;if(null==c._bucket)throw new k("no-default-bucket","No default bucket found. Did you set the '"+j+"' property when initializing the app?");const d=new Ec(c,c._bucket);return null!=b?Qc(d,b):d}return void 0!==b?(function(a,b){const c=function(a,b){const c=b.split("/").filter(a=>a.length>0).join("/");return 0===a.length?c:a+"/"+c}(a._location.path,b),d=new x(a._location.bucket,c);return new Ec(a.storage,d)})(a,b):a}function Rc(a,b){const c=null==b?void 0:b[j];return null==c?null:x.makeFromBucketSpec(c,a)}class Sc{constructor(Tc,Uc,Vc,Wc,Xc){this.app=Tc,this._authProvider=Uc,this._appCheckProvider=Vc,this._url=Wc,this._firebaseVersion=Xc,this._bucket=null,this._host=i,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=120e3,this._maxUploadRetryTime=60e4,this._requests=new Set(),null!=Wc?this._bucket=x.makeFromBucketSpec(Wc,this._host):this._bucket=Rc(this._host,this.app.options)}get host(){return this._host}set host(Yc){this._host=Yc,null!=this._url?this._bucket=x.makeFromBucketSpec(this._url,Yc):this._bucket=Rc(Yc,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(Zc){aa("time",0,Number.POSITIVE_INFINITY,Zc),this._maxUploadRetryTime=Zc}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime($c){aa("time",0,Number.POSITIVE_INFINITY,$c),this._maxOperationRetryTime=$c}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const _c=this._authProvider.getImmediate({optional:!0});if(_c){const ad=await _c.getToken();if(null!==ad)return ad.accessToken}return null}async _getAppCheckToken(){const bd=this._appCheckProvider.getImmediate({optional:!0});if(bd){const cd=await bd.getToken();return cd.token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach(a=>a.cancel()),this._requests.clear()),Promise.resolve()}_makeStorageReference(dd){return new Ec(this,dd)}_makeRequest(ed,fd,gd,hd){if(this._deleted)return new W(u());{const id=function(a,b,c,d,e,f){var g,h,i,j,k,l,m,n;const o=ca(a.urlParams),p=a.url+o,q=Object.assign({},a.headers);return g=q,(h=b)&&(g["X-Firebase-GMPID"]=h),i=q,null!==(j=c)&&j.length>0&&(i.Authorization="Firebase "+j),k=q,l=f,k["X-Firebase-Storage-Version"]="webjs/"+(null!=l?l:"AppManager"),m=q,null!==(n=d)&&(m["X-Firebase-AppCheck"]=n),new da(p,a.method,q,a.body,a.successCodes,a.additionalRetryCodes,a.handler,a.errorHandler,a.timeout,a.progressCallback,e)}(ed,this._appId,gd,hd,fd,this._firebaseVersion);return this._requests.add(id),id.getPromise().then(()=>this._requests.delete(id),()=>this._requests.delete(id)),id}}async makeRequestWithTokens(jd,kd){const[ld,md]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(jd,kd,ld,md).getPromise()}}const nd="@firebase/storage",od="0.9.0",pd="storage";function qd(a,b,c){var d,e,f;return d=a=(0,g.m9)(a),e=b,f=c,d._throwIfRoot("uploadBytesResumable"),new Wb(d,new Ja(e),f)}function rd(a){return(function(a){a._throwIfRoot("getDownloadURL");const b=function(a,b,c){var d,e;const f=b.fullServerUrl(),g=ba(f,a.host,a._protocol),h=a.maxOperationRetryTime,i=new nb(g,"GET",(d=a,e=c,function(a,b){const c=jb(d,b,e);return sb(null!==c),(function(a,b,c,d){const e=ab(b);if(null===e)return null;if(!Z(e.downloadTokens))return null;const f=e.downloadTokens;if(0===f.length)return null;const g=encodeURIComponent,h=f.split(","),i=h.map(b=>{const e=a.bucket,f=a.fullPath,h="/b/"+g(e)+"/o/"+g(f),i=ba(h,c,d),j=ca({alt:"media",token:b});return i+j});return i[0]})(c,b,d.host,d._protocol)}),h);return i.errorHandler=vb(b),i}(a.storage,a._location,ib());return a.storage.makeRequestWithTokens(b,Vb).then(a=>{if(null===a)throw new k("no-download-url","The given file does not have any download URLs.");return a})})(a=(0,g.m9)(a))}function sd(a,b){return(function(a,b){var c,d,e;if(!(b&&(c=b,/^[A-Za-z]+:\/\//.test(c))))return Qc(a,b);if(a instanceof Sc)return d=a,e=b,new Ec(d,e);throw t("To use ref(service, url), the first argument must be a Storage instance.")})(a=(0,g.m9)(a),b)}function td(a=(0,f.Mq)(),b){a=(0,g.m9)(a);const c=(0,f.qX)(a,pd),d=c.getImmediate({identifier:b});return d}(0,f.Xd)(new h.wA(pd,function(a,{instanceIdentifier:b}){const c=a.getProvider("app").getImmediate(),d=a.getProvider("auth-internal"),e=a.getProvider("app-check-internal");return new Sc(c,d,e,b,f.Jn)},"PUBLIC").setMultipleInstances(!0)),(0,f.KN)(nd,od,""),(0,f.KN)(nd,od,"esm2017")},6363:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return c(2721)}])},8200:function(a,b,c){"use strict";c.d(b,{S:function(){return d}});var d=(0,c(7294).createContext)({user:null,username:null})},8403:function(a,b,c){"use strict";c.d(b,{mC:function(){return m},I8:function(){return j},qV:function(){return k},tO:function(){return l}}),c(8520);var d=c(2238);(0,d.KN)("firebase","9.6.1","app");var e=c(2720),f=c(5321),g=c(1153);function h(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}var i=function(a){try{return(0,d.Mq)()}catch(b){return(0,d.ZF)(a)}}({apiKey:"AIzaSyAUDpfAI-rxnqE13gWj1POG3vliz57eqgU",authDomain:"blog-868f9.firebaseapp.com",projectId:"blog-868f9",storageBucket:"blog-868f9.appspot.com",messagingSenderId:"687306599383",appId:"1:687306599383:web:863e8e899e571774b9f992",measurementId:"G-DLPBXLH39H"}),j=(0,e.v0)(i),k=new e.hJ();(0,f.ad)(i);var l=(0,g.cF)(i),m="state_changed";function n(){return(n=(function(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){h(f,d,e,g,i,"next",a)}function i(a){h(f,d,e,g,i,"throw",a)}g(void 0)})}})(regeneratorRuntime.mark(function a(b){var c,d;return regeneratorRuntime.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return c=query(collection(getFirestore(),"users"),where("username","==",b),limit(1)),a.next=3,getDocs(c);case 3:return d=a.sent.docs[0],a.abrupt("return",d);case 5:case"end":return a.stop()}},a)}))).apply(this,arguments)}},8418:function(a,b,c){"use strict";function d(a,b){return(function(a){if(Array.isArray(a))return a})(a)||(function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c})(a,b)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")})()}b.default=void 0;var e,f=(e=c(7294))&&e.__esModule?e:{default:e},g=c(6273),h=c(387),i=c(7190),j={};function k(a,b,c,d){if(a&&g.isLocalURL(b)){a.prefetch(b,c,d).catch(function(a){});var e=d&& void 0!==d.locale?d.locale:a&&a.locale;j[b+"%"+c+(e?"%"+e:"")]=!0}}b.default=function(a){var b,c=!1!==a.prefetch,e=h.useRouter(),l=f.default.useMemo(function(){var b=d(g.resolveHref(e,a.href,!0),2),c=b[0],f=b[1];return{href:c,as:a.as?g.resolveHref(e,a.as):f||c}},[e,a.href,a.as]),m=l.href,n=l.as,o=a.children,p=a.replace,q=a.shallow,r=a.scroll,s=a.locale;"string"==typeof o&&(o=f.default.createElement("a",null,o));var t=(b=f.default.Children.only(o))&&"object"==typeof b&&b.ref,u=d(i.useIntersection({rootMargin:"200px"}),2),v=u[0],w=u[1],x=f.default.useCallback(function(a){v(a),t&&("function"==typeof t?t(a):"object"==typeof t&&(t.current=a))},[t,v]);f.default.useEffect(function(){var a=w&&c&&g.isLocalURL(m),b=void 0!==s?s:e&&e.locale,d=j[m+"%"+n+(b?"%"+b:"")];a&&!d&&k(e,m,n,{locale:b})},[n,m,w,s,c,e]);var y={ref:x,onClick:function(a){var c,d,f,h,i,j,k,l,o,t;b.props&&"function"==typeof b.props.onClick&&b.props.onClick(a),a.defaultPrevented||(c=a,d=e,f=m,h=n,i=p,j=q,k=r,l=s,"A"===c.currentTarget.nodeName&&((t=(o=c).currentTarget.target)&&"_self"!==t||o.metaKey||o.ctrlKey||o.shiftKey||o.altKey||o.nativeEvent&&2===o.nativeEvent.which||!g.isLocalURL(f))||(c.preventDefault(),null==k&&h.indexOf("#")>=0&&(k=!1),d[i?"replace":"push"](f,h,{shallow:j,locale:l,scroll:k})))}};if(y.onMouseEnter=function(a){b.props&&"function"==typeof b.props.onMouseEnter&&b.props.onMouseEnter(a),g.isLocalURL(m)&&k(e,m,n,{priority:!0})},a.passHref||"a"===b.type&&!("href"in b.props)){var z=void 0!==s?s:e&&e.locale,A=e&&e.isLocaleDomain&&g.getDomainLocale(n,z,e&&e.locales,e&&e.domainLocales);y.href=A||g.addBasePath(g.addLocale(n,z,e&&e.defaultLocale))}return f.default.cloneElement(b,y)}},7190:function(a,b,c){"use strict";Object.defineProperty(b,"__esModule",{value:!0}),b.useIntersection=function(a){var b,c=a.rootMargin,h=a.disabled||!f,i=d.useRef(),j=function(a){if(Array.isArray(a))return a}(b=d.useState(!1))||function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c}(b,2)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}(),k=j[0],l=j[1],m=d.useCallback(function(a){i.current&&(i.current(),i.current=void 0),!h&&!k&&a&&a.tagName&&(i.current=g(a,function(a){return a&&l(a)},{rootMargin:c}))},[h,c,k]);return d.useEffect(function(){if(!f&&!k){var a=e.requestIdleCallback(function(){return l(!0)});return function(){return e.cancelIdleCallback(a)}}},[k]),[m,k]};var d=c(7294),e=c(9311),f="undefined"!=typeof IntersectionObserver;function g(a,b,c){var d=i(c),e=d.id,f=d.observer,g=d.elements;return g.set(a,b),f.observe(a),function(){g.delete(a),f.unobserve(a),0===g.size&&(f.disconnect(),h.delete(e))}}var h=new Map();function i(a){var b=a.rootMargin||"",c=h.get(b);if(c)return c;var d=new Map(),e=new IntersectionObserver(function(a){a.forEach(function(a){var b=d.get(a.target),c=a.isIntersecting||a.intersectionRatio>0;b&&c&&b(c)})},a);return h.set(b,c={id:b,observer:e,elements:d}),c}},2721:function(a,b,c){"use strict";c.r(b),c.d(b,{"default":function(){return r}});var d=c(5893);c(906);var e=c(1664),f=c(7294),g=c(8200);function h(){var a=(0,f.useContext)(g.S),b=a.user,c=a.username;return(0,d.jsx)("nav",{className:"navbar",children:(0,d.jsxs)("ul",{children:[(0,d.jsx)("li",{children:(0,d.jsx)(e.default,{href:"/",children:(0,d.jsx)("button",{children:"FEED"})})}),c&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("li",{children:(0,d.jsx)(e.default,{href:"/admin",children:(0,d.jsx)("button",{children:"Write Posts"})})}),(0,d.jsx)("li",{children:(0,d.jsx)(e.default,{href:"/".concat(c),children:(0,d.jsx)("img",{src:null==b?void 0:b.photoURL})})})]}),!c&&(0,d.jsx)("li",{children:(0,d.jsx)(e.default,{href:"/enter",children:(0,d.jsx)("button",{children:"Log in"})})})]})})}var i=c(2620),j=c(5321),k=c(8403),l=c(2720),m=function(){return(m=Object.assign||function(a){for(var b,c=1,d=arguments.length;c<d;c++)for(var e in b=arguments[c])Object.prototype.hasOwnProperty.call(b,e)&&(a[e]=b[e]);return a}).apply(this,arguments)},n=function(a){return{loading:null==a,value:a}},o=function(a){var b=a?a():void 0,c=(0,f.useReducer)(function(a,b){switch(b.type){case"error":return m({},a,{error:b.error,loading:!1,value:void 0});case"reset":return n(b.defaultValue);case"value":return m({},a,{error:void 0,loading:!1,value:b.value});default:return a}},n(b)),d=c[0],e=c[1],g=function(){e({type:"reset",defaultValue:a?a():void 0})},h=function(a){e({type:"error",error:a})},i=function(a){e({type:"value",value:a})};return(0,f.useMemo)(function(){return{error:d.error,loading:d.loading,reset:g,setError:h,setValue:i,value:d.value}},[d.error,d.loading,g,h,i,d.value])},p=function(a){var b=o(function(){return a.currentUser}),c=b.error,d=b.loading,e=b.setError,g=b.setValue,h=b.value;(0,f.useEffect)(function(){return(0,l.Aj)(a,g,e)},[a]);var i=[h,d,c];return(0,f.useMemo)(function(){return i},i)};function q(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var r=function(a){var b,c,e,l,m,n=a.Component,o=a.pageProps,r=(c=(function(a){if(Array.isArray(a))return a}(b=p(k.I8))||function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c}(b,1)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}())[0],l=(e=(0,f.useState)(null))[0],m=e[1],(0,f.useEffect)(function(){var a;if(c){var b=(0,j.JU)((0,j.ad)(),"users",c.uid);a=(0,j.cf)(b,function(a){var b;m(null===(b=a.data())|| void 0===b?void 0:b.username)})}else m(null);return a},[c]),{user:c,username:l});return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)(g.S.Provider,{value:r,children:[(0,d.jsx)(h,{}),(0,d.jsx)(n,function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){q(a,b,c[b])})}return a}({},o)),(0,d.jsx)(i.x7,{})]})})}},906:function(){},1664:function(a,b,c){a.exports=c(8418)},2620:function(a,b,c){"use strict";c.d(b,{x7:function(){return xa},ZP:function(){return ya}});var d,e=c(7294);let f={data:""},g=a=>"object"==typeof window?((a?a.querySelector("#_goober"):window._goober)||Object.assign((a||document.head).appendChild(document.createElement("style")),{innerHTML:" ",id:"_goober"})).firstChild:a||f,h=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,i=/\/\*[^]*?\*\/|\s\s+|\n/g,j=(a,b)=>{let c="",d="",e="";for(let f in a){let g=a[f];"@"==f[0]?"i"==f[1]?c=f+" "+g+";":d+="f"==f[1]?j(g,f):f+"{"+j(g,"k"==f[1]?"":b)+"}":"object"==typeof g?d+=j(g,b?b.replace(/([^,])+/g,a=>f.replace(/(^:.*)|([^,])+/g,b=>/&/.test(b)?b.replace(/&/g,a):a?a+" "+b:b)):f):null!=g&&(f=f.replace(/[A-Z]/g,"-$&").toLowerCase(),e+=j.p?j.p(f,g):f+":"+g+";")}return c+(b&&e?b+"{"+e+"}":e)+d},k={},l=a=>{if("object"==typeof a){let b="";for(let c in a)b+=c+l(a[c]);return b}return a},m=(a,b,c,d,e)=>{var f,g,m;let n=l(a),o=k[n]||(k[n]=(a=>{let b=0,c=11;for(;b<a.length;)c=101*c+a.charCodeAt(b++)>>>0;return"go"+c})(n));if(!k[o]){let p=n!==a?a:(a=>{let b,c=[{}];for(;b=h.exec(a.replace(i,""));)b[4]?c.shift():b[3]?c.unshift(c[0][b[3]]=c[0][b[3]]||{}):c[0][b[1]]=b[2];return c[0]})(a);k[o]=j(e?{["@keyframes "+o]:p}:p,c?"":"."+o)}return f=k[o],g=b,m=d,-1==g.data.indexOf(f)&&(g.data=m?f+g.data:g.data+f),o},n=(a,b,c)=>a.reduce((a,d,e)=>{let f=b[e];if(f&&f.call){let g=f(c),h=g&&g.props&&g.props.className||/^go/.test(g)&&g;f=h?"."+h:g&&"object"==typeof g?g.props?"":j(g,""):!1===g?"":g}return a+d+(null==f?"":f)},"");function o(a){let b=this||{},c=a.call?a(b.p):a;return m(c.unshift?c.raw?n(c,[].slice.call(arguments,1),b.p):c.reduce((a,c)=>Object.assign(a,c&&c.call?c(b.p):c),{}):c,g(b.target),b.g,b.o,b.k)}let p,q,r,s=o.bind({g:1}),t=o.bind({k:1});function u(a,b){let c=this||{};return function(){let d=arguments;function e(f,g){let h=Object.assign({},f),i=h.className||e.className;c.p=Object.assign({theme:q&&q()},h),c.o=/ *go\d+/.test(i),h.className=o.apply(c,d)+(i?" "+i:""),b&&(h.ref=g);let j=a;return a[0]&&(j=h.as||a,delete h.as),r&&j[0]&&r(h),p(j,h)}return b?b(e):e}}function v(){return(v=Object.assign||function(a){for(var b=1;b<arguments.length;b++){var c=arguments[b];for(var d in c)Object.prototype.hasOwnProperty.call(c,d)&&(a[d]=c[d])}return a}).apply(this,arguments)}function w(a,b){return b||(b=a.slice(0)),a.raw=b,a}var x,y,z,A=function(a,b){return"function"==typeof a?a(b):a},B=(x=0,function(){return(++x).toString()}),C=(y=void 0,function(){if(void 0===y&&"undefined"!=typeof window){var a=matchMedia("(prefers-reduced-motion: reduce)");y=!a||a.matches}return y});(z=d||(d={}))[z.ADD_TOAST=0]="ADD_TOAST",z[z.UPDATE_TOAST=1]="UPDATE_TOAST",z[z.UPSERT_TOAST=2]="UPSERT_TOAST",z[z.DISMISS_TOAST=3]="DISMISS_TOAST",z[z.REMOVE_TOAST=4]="REMOVE_TOAST",z[z.START_PAUSE=5]="START_PAUSE",z[z.END_PAUSE=6]="END_PAUSE";var D=new Map(),E=function(a){if(!D.has(a)){var b=setTimeout(function(){D.delete(a),J({type:d.REMOVE_TOAST,toastId:a})},1000);D.set(a,b)}},F=function(a){var b=D.get(a);b&&clearTimeout(b)},G=function a(b,c){switch(c.type){case d.ADD_TOAST:return v({},b,{toasts:[c.toast].concat(b.toasts).slice(0,20)});case d.UPDATE_TOAST:return c.toast.id&&F(c.toast.id),v({},b,{toasts:b.toasts.map(function(a){return a.id===c.toast.id?v({},a,c.toast):a})});case d.UPSERT_TOAST:var e=c.toast;return b.toasts.find(function(a){return a.id===e.id})?a(b,{type:d.UPDATE_TOAST,toast:e}):a(b,{type:d.ADD_TOAST,toast:e});case d.DISMISS_TOAST:var f=c.toastId;return f?E(f):b.toasts.forEach(function(a){E(a.id)}),v({},b,{toasts:b.toasts.map(function(a){return a.id===f|| void 0===f?v({},a,{visible:!1}):a})});case d.REMOVE_TOAST:if(void 0===c.toastId)return v({},b,{toasts:[]});return v({},b,{toasts:b.toasts.filter(function(a){return a.id!==c.toastId})});case d.START_PAUSE:return v({},b,{pausedAt:c.time});case d.END_PAUSE:var g=c.time-(b.pausedAt||0);return v({},b,{pausedAt:void 0,toasts:b.toasts.map(function(a){return v({},a,{pauseDuration:a.pauseDuration+g})})})}},H=[],I={toasts:[],pausedAt:void 0},J=function(a){I=G(I,a),H.forEach(function(a){a(I)})},K={blank:4000,error:4000,success:2000,loading:1/0,custom:4000},L=function(a){void 0===a&&(a={});var b=(0,e.useState)(I),c=b[0],d=b[1];(0,e.useEffect)(function(){return H.push(d),function(){var a=H.indexOf(d);a> -1&&H.splice(a,1)}},[c]);var f=c.toasts.map(function(b){var c,d,e;return v({},a,a[b.type],b,{duration:b.duration||(null==(c=a[b.type])?void 0:c.duration)||(null==(d=a)?void 0:d.duration)||K[b.type],style:v({},a.style,null==(e=a[b.type])?void 0:e.style,b.style)})});return v({},c,{toasts:f})},M=function(a){return function(b,c){var e,f,g,h=(e=b,f=a,g=c,void 0===f&&(f="blank"),v({createdAt:Date.now(),visible:!0,type:f,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0},g,{id:(null==g?void 0:g.id)||B()}));return J({type:d.UPSERT_TOAST,toast:h}),h.id}},N=function(a,b){return M("blank")(a,b)};N.error=M("error"),N.success=M("success"),N.loading=M("loading"),N.custom=M("custom"),N.dismiss=function(a){J({type:d.DISMISS_TOAST,toastId:a})},N.remove=function(a){return J({type:d.REMOVE_TOAST,toastId:a})},N.promise=function(a,b,c){var d=N.loading(b.loading,v({},c,null==c?void 0:c.loading));return a.then(function(a){return N.success(A(b.success,a),v({id:d},c,null==c?void 0:c.success)),a}).catch(function(a){N.error(A(b.error,a),v({id:d},c,null==c?void 0:c.error))}),a};var O=function(a){var b=L(a),c=b.toasts,f=b.pausedAt;(0,e.useEffect)(function(){if(!f){var a=Date.now(),b=c.map(function(b){if(b.duration!==1/0){var c=(b.duration||0)+b.pauseDuration-(a-b.createdAt);if(c<0){b.visible&&N.dismiss(b.id);return}return setTimeout(function(){return N.dismiss(b.id)},c)}});return function(){b.forEach(function(a){return a&&clearTimeout(a)})}}},[c,f]);var g=(0,e.useMemo)(function(){return{startPause:function(){J({type:d.START_PAUSE,time:Date.now()})},endPause:function(){f&&J({type:d.END_PAUSE,time:Date.now()})},updateHeight:function(a,b){return J({type:d.UPDATE_TOAST,toast:{id:a,height:b}})},calculateOffset:function(a,b){var d,e=b||{},f=e.reverseOrder,g=e.gutter,h=void 0===g?8:g,i=e.defaultPosition,j=c.filter(function(b){return(b.position||i)===(a.position||i)&&b.height}),k=j.findIndex(function(b){return b.id===a.id}),l=j.filter(function(a,b){return b<k&&a.visible}).length;return(d=j.filter(function(a){return a.visible})).slice.apply(d,void 0!==f&&f?[l+1]:[0,l]).reduce(function(a,b){return a+(b.height||0)+h},0)}}},[c,f]);return{toasts:c,handlers:g}};function P(){var a=w(["\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ",";\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: "," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n\n  &:after,\n  &:before {\n    content: '';\n    animation: "," 0.15s ease-out forwards;\n    animation-delay: 150ms;\n    position: absolute;\n    border-radius: 3px;\n    opacity: 0;\n    background: ",";\n    bottom: 9px;\n    left: 4px;\n    height: 2px;\n    width: 12px;\n  }\n\n  &:before {\n    animation: "," 0.15s ease-out forwards;\n    animation-delay: 180ms;\n    transform: rotate(90deg);\n  }\n"]);return P=function(){return a},a}function Q(){var a=w(["\nfrom {\n  transform: scale(0) rotate(90deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(90deg);\n\topacity: 1;\n}"]);return Q=function(){return a},a}function R(){var a=w(["\nfrom {\n  transform: scale(0);\n  opacity: 0;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}"]);return R=function(){return a},a}function S(){var a=w(["\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n transform: scale(1) rotate(45deg);\n  opacity: 1;\n}"]);return S=function(){return a},a}var T=t(S()),U=t(R()),V=t(Q()),W=u("div")(P(),function(a){return a.primary||"#ff4b4b"},T,U,function(a){return a.secondary||"#fff"},V);function X(){var a=w(["\n  width: 12px;\n  height: 12px;\n  box-sizing: border-box;\n  border: 2px solid;\n  border-radius: 100%;\n  border-color: ",";\n  border-right-color: ",";\n  animation: "," 1s linear infinite;\n"]);return X=function(){return a},a}function Y(){var a=w(["\n  from {\n    transform: rotate(0deg);\n  }\n  to {\n    transform: rotate(360deg);\n  }\n"]);return Y=function(){return a},a}var Z=t(Y()),$=u("div")(X(),function(a){return a.secondary||"#e0e0e0"},function(a){return a.primary||"#616161"},Z);function _(){var a=w(["\n  width: 20px;\n  opacity: 0;\n  height: 20px;\n  border-radius: 10px;\n  background: ",";\n  position: relative;\n  transform: rotate(45deg);\n\n  animation: "," 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n  animation-delay: 100ms;\n  &:after {\n    content: '';\n    box-sizing: border-box;\n    animation: "," 0.2s ease-out forwards;\n    opacity: 0;\n    animation-delay: 200ms;\n    position: absolute;\n    border-right: 2px solid;\n    border-bottom: 2px solid;\n    border-color: ",";\n    bottom: 6px;\n    left: 6px;\n    height: 10px;\n    width: 6px;\n  }\n"]);return _=function(){return a},a}function aa(){var a=w(["\n0% {\n\theight: 0;\n\twidth: 0;\n\topacity: 0;\n}\n40% {\n  height: 0;\n\twidth: 6px;\n\topacity: 1;\n}\n100% {\n  opacity: 1;\n  height: 10px;\n}"]);return aa=function(){return a},a}function ba(){var a=w(["\nfrom {\n  transform: scale(0) rotate(45deg);\n\topacity: 0;\n}\nto {\n  transform: scale(1) rotate(45deg);\n\topacity: 1;\n}"]);return ba=function(){return a},a}var ca=t(ba()),da=t(aa()),ea=u("div")(_(),function(a){return a.primary||"#61d345"},ca,da,function(a){return a.secondary||"#fff"});function fa(){var a=w(["\n  position: relative;\n  transform: scale(0.6);\n  opacity: 0.4;\n  min-width: 20px;\n  animation: "," 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)\n    forwards;\n"]);return fa=function(){return a},a}function ga(){var a=w(["\nfrom {\n  transform: scale(0.6);\n  opacity: 0.4;\n}\nto {\n  transform: scale(1);\n  opacity: 1;\n}"]);return ga=function(){return a},a}function ha(){var a=w(["\n  position: relative;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  min-width: 20px;\n  min-height: 20px;\n"]);return ha=function(){return a},a}function ia(){var a=w(["\n  position: absolute;\n"]);return ia=function(){return a},a}var ja=u("div")(ia()),ka=u("div")(ha()),la=t(ga()),ma=u("div")(fa(),la),na=function(a){var b=a.toast,c=b.icon,d=b.type,f=b.iconTheme;return void 0!==c?"string"==typeof c?(0,e.createElement)(ma,null,c):c:"blank"===d?null:(0,e.createElement)(ka,null,(0,e.createElement)($,Object.assign({},f)),"loading"!==d&&(0,e.createElement)(ja,null,"error"===d?(0,e.createElement)(W,Object.assign({},f)):(0,e.createElement)(ea,Object.assign({},f))))};function oa(){var a=w(["\n  display: flex;\n  justify-content: center;\n  margin: 4px 10px;\n  color: inherit;\n  flex: 1 1 auto;\n"]);return oa=function(){return a},a}function pa(){var a=w(["\n  display: flex;\n  align-items: center;\n  background: #fff;\n  color: #363636;\n  line-height: 1.3;\n  will-change: transform;\n  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);\n  max-width: 350px;\n  pointer-events: auto;\n  padding: 8px 10px;\n  border-radius: 8px;\n"]);return pa=function(){return a},a}var qa=u("div",e.forwardRef)(pa()),ra=u("div")(oa()),sa=function(a,b){var c=a.includes("top")?1:-1,d=C()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:["\n0% {transform: translate3d(0,"+ -200*c+"%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n","\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,"+ -150*c+"%,-1px) scale(.6); opacity:0;}\n"],e=d[0],f=d[1];return{animation:b?t(e)+" 0.35s cubic-bezier(.21,1.02,.73,1) forwards":t(f)+" 0.4s forwards cubic-bezier(.06,.71,.55,1)"}},ta=(0,e.memo)(function(a){var b=a.toast,c=a.position,d=a.style,f=a.children,g=null!=b&&b.height?sa(b.position||c||"top-center",b.visible):{opacity:0},h=(0,e.createElement)(na,{toast:b}),i=(0,e.createElement)(ra,Object.assign({},b.ariaProps),A(b.message,b));return(0,e.createElement)(qa,{className:b.className,style:v({},g,d,b.style)},"function"==typeof f?f({icon:h,message:i}):(0,e.createElement)(e.Fragment,null,h,i))});function ua(){var a=w(["\n  z-index: 9999;\n  > * {\n    pointer-events: auto;\n  }\n"]);return ua=function(){return a},a}e.createElement,j.p=void 0,p=e.createElement,q=void 0,r=void 0;var va=function(a,b){var c=a.includes("top"),d=a.includes("center")?{justifyContent:"center"}:a.includes("right")?{justifyContent:"flex-end"}:{};return v({left:0,right:0,display:"flex",position:"absolute",transition:C()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:"translateY("+b*(c?1:-1)+"px)"},c?{top:0}:{bottom:0},d)},wa=o(ua()),xa=function(a){var b=a.reverseOrder,c=a.position,d=void 0===c?"top-center":c,f=a.toastOptions,g=a.gutter,h=a.children,i=a.containerStyle,j=a.containerClassName,k=O(f),l=k.toasts,m=k.handlers;return(0,e.createElement)("div",{style:v({position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none"},i),className:j,onMouseEnter:m.startPause,onMouseLeave:m.endPause},l.map(function(a){var c=a.position||d,f=va(c,m.calculateOffset(a,{reverseOrder:b,gutter:g,defaultPosition:d})),i=a.height?void 0:function(a){return function(b){b&&setTimeout(function(){a(b.getBoundingClientRect())})}}(function(b){m.updateHeight(a.id,b.height)});return(0,e.createElement)("div",{ref:i,className:a.visible?wa:"",key:a.id,style:f},"custom"===a.type?A(a.message,a):h?h(a):(0,e.createElement)(ta,{toast:a,position:c}))}))},ya=N},2238:function(a,b,c){"use strict";c.d(b,{Jn:function(){return B},qX:function(){return t},Xd:function(){return s},Mq:function(){return D},ZF:function(){return C},KN:function(){return E}});var d=c(8463),e=c(3333),f=c(4444);class g{constructor(h){this.container=h}getPlatformInfoString(){const i=this.container.getProviders();return i.map(a=>{if(!j(a))return null;{const b=a.getImmediate();return`${b.library}/${b.version}`}}).filter(a=>a).join(" ")}}function j(a){const b=a.getComponent();return(null==b?void 0:b.type)==="VERSION"}const k="@firebase/app",l="0.7.11",m=new e.Yd("@firebase/app"),n="[DEFAULT]",o={[k]:"fire-core",["@firebase/app-compat"]:"fire-core-compat",["@firebase/analytics"]:"fire-analytics",["@firebase/analytics-compat"]:"fire-analytics-compat",["@firebase/app-check"]:"fire-app-check",["@firebase/app-check-compat"]:"fire-app-check-compat",["@firebase/auth"]:"fire-auth",["@firebase/auth-compat"]:"fire-auth-compat",["@firebase/database"]:"fire-rtdb",["@firebase/database-compat"]:"fire-rtdb-compat",["@firebase/functions"]:"fire-fn",["@firebase/functions-compat"]:"fire-fn-compat",["@firebase/installations"]:"fire-iid",["@firebase/installations-compat"]:"fire-iid-compat",["@firebase/messaging"]:"fire-fcm",["@firebase/messaging-compat"]:"fire-fcm-compat",["@firebase/performance"]:"fire-perf",["@firebase/performance-compat"]:"fire-perf-compat",["@firebase/remote-config"]:"fire-rc",["@firebase/remote-config-compat"]:"fire-rc-compat",["@firebase/storage"]:"fire-gcs",["@firebase/storage-compat"]:"fire-gcs-compat",["@firebase/firestore"]:"fire-fst",["@firebase/firestore-compat"]:"fire-fst-compat","fire-js":"fire-js",["firebase"]:"fire-js-all"},p=new Map(),q=new Map();function r(a,b){try{a.container.addComponent(b)}catch(c){m.debug(`Component ${b.name} failed to register with FirebaseApp ${a.name}`,c)}}function s(a){const b=a.name;if(q.has(b))return m.debug(`There were multiple attempts to register component ${b}.`),!1;for(const c of(q.set(b,a),p.values()))r(c,a);return!0}function t(a,b){return a.container.getProvider(b)}const u=new f.LL("app","Firebase",{["no-app"]:"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",["bad-app-name"]:"Illegal App name: '{$appName}",["duplicate-app"]:"Firebase App named '{$appName}' already exists with different options or config",["app-deleted"]:"Firebase App named '{$appName}' already deleted",["invalid-app-argument"]:"firebase.{$appName}() takes either no argument or a Firebase App instance.",["invalid-log-argument"]:"First argument to `onLog` must be null or a function."});class v{constructor(w,x,y){this._isDeleted=!1,this._options=Object.assign({},w),this._config=Object.assign({},x),this._name=x.name,this._automaticDataCollectionEnabled=x.automaticDataCollectionEnabled,this._container=y,this.container.addComponent(new d.wA("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(z){this.checkDestroyed(),this._automaticDataCollectionEnabled=z}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(A){this._isDeleted=A}checkDestroyed(){if(this.isDeleted)throw u.create("app-deleted",{appName:this._name})}}const B="9.6.1";function C(a,b={}){if("object"!=typeof b){const c=b;b={name:c}}const e=Object.assign({name:n,automaticDataCollectionEnabled:!1},b),g=e.name;if("string"!=typeof g||!g)throw u.create("bad-app-name",{appName:String(g)});const h=p.get(g);if(h){if((0,f.vZ)(a,h.options)&&(0,f.vZ)(e,h.config))return h;throw u.create("duplicate-app",{appName:g})}const i=new d.H0(g);for(const j of q.values())i.addComponent(j);const k=new v(a,e,i);return p.set(g,k),k}function D(a=n){const b=p.get(a);if(!b)throw u.create("no-app",{appName:a});return b}function E(a,b,c){var e;let f=null!==(e=o[a])&& void 0!==e?e:a;c&&(f+=`-${c}`);const g=f.match(/\s|\//),h=b.match(/\s|\//);if(g||h){const i=[`Unable to register library "${f}" with version "${b}":`];g&&i.push(`library name "${f}" contains illegal characters (whitespace or "/")`),g&&h&&i.push("and"),h&&i.push(`version name "${b}" contains illegal characters (whitespace or "/")`),m.warn(i.join(" "));return}s(new d.wA(`${f}-version`,()=>({library:f,version:b}),"VERSION"))}s(new d.wA("platform-logger",a=>new g(a),"PRIVATE")),E(k,l,""),E(k,l,"esm2017"),E("fire-js","")},8463:function(a,b,c){"use strict";c.d(b,{wA:function(){return e},H0:function(){return ia}});var d=c(4444);class e{constructor(f,g,h){this.name=f,this.instanceFactory=g,this.type=h,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(i){return this.instantiationMode=i,this}setMultipleInstances(j){return this.multipleInstances=j,this}setServiceProps(k){return this.serviceProps=k,this}setInstanceCreatedCallback(l){return this.onInstanceCreated=l,this}}const m="[DEFAULT]";class n{constructor(o,p){this.name=o,this.container=p,this.component=null,this.instances=new Map(),this.instancesDeferred=new Map(),this.instancesOptions=new Map(),this.onInitCallbacks=new Map()}get(q){const r=this.normalizeInstanceIdentifier(q);if(!this.instancesDeferred.has(r)){const s=new d.BH();if(this.instancesDeferred.set(r,s),this.isInitialized(r)||this.shouldAutoInitialize())try{const t=this.getOrInitializeService({instanceIdentifier:r});t&&s.resolve(t)}catch(u){}}return this.instancesDeferred.get(r).promise}getImmediate(v){var w;const x=this.normalizeInstanceIdentifier(null==v?void 0:v.identifier),y=null!==(w=null==v?void 0:v.optional)&& void 0!==w&&w;if(this.isInitialized(x)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:x})}catch(z){if(y)return null;throw z}else{if(y)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(A){if(A.name!==this.name)throw Error(`Mismatching Component ${A.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=A,this.shouldAutoInitialize()){if(ha(A))try{this.getOrInitializeService({instanceIdentifier:m})}catch(B){}for(const[C,D]of this.instancesDeferred.entries()){const E=this.normalizeInstanceIdentifier(C);try{const F=this.getOrInitializeService({instanceIdentifier:E});D.resolve(F)}catch(G){}}}}clearInstance(H=m){this.instancesDeferred.delete(H),this.instancesOptions.delete(H),this.instances.delete(H)}async delete(){const I=Array.from(this.instances.values());await Promise.all([...I.filter(a=>"INTERNAL"in a).map(a=>a.INTERNAL.delete()),...I.filter(a=>"_delete"in a).map(a=>a._delete())])}isComponentSet(){return null!=this.component}isInitialized(J=m){return this.instances.has(J)}getOptions(K=m){return this.instancesOptions.get(K)||{}}initialize(L={}){const{options:M={}}=L,N=this.normalizeInstanceIdentifier(L.instanceIdentifier);if(this.isInitialized(N))throw Error(`${this.name}(${N}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const O=this.getOrInitializeService({instanceIdentifier:N,options:M});for(const[P,Q]of this.instancesDeferred.entries()){const R=this.normalizeInstanceIdentifier(P);N===R&&Q.resolve(O)}return O}onInit(S,T){var U;const V=this.normalizeInstanceIdentifier(T),W=null!==(U=this.onInitCallbacks.get(V))&& void 0!==U?U:new Set();W.add(S),this.onInitCallbacks.set(V,W);const X=this.instances.get(V);return X&&S(X,V),()=>{W.delete(S)}}invokeOnInitCallbacks(Y,Z){const $=this.onInitCallbacks.get(Z);if($)for(const _ of $)try{_(Y,Z)}catch(aa){}}getOrInitializeService({instanceIdentifier:ba,options:ca={}}){let da=this.instances.get(ba);if(!da&&this.component&&(da=this.component.instanceFactory(this.container,{instanceIdentifier:ga(ba),options:ca}),this.instances.set(ba,da),this.instancesOptions.set(ba,ca),this.invokeOnInitCallbacks(da,ba),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,ba,da)}catch(ea){}return da||null}normalizeInstanceIdentifier(fa=m){return this.component?this.component.multipleInstances?fa:m:fa}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}function ga(a){return a===m?void 0:a}function ha(a){return"EAGER"===a.instantiationMode}class ia{constructor(ja){this.name=ja,this.providers=new Map()}addComponent(ka){const la=this.getProvider(ka.name);if(la.isComponentSet())throw new Error(`Component ${ka.name} has already been registered with ${this.name}`);la.setComponent(ka)}addOrOverwriteComponent(ma){const na=this.getProvider(ma.name);na.isComponentSet()&&this.providers.delete(ma.name),this.addComponent(ma)}getProvider(oa){if(this.providers.has(oa))return this.providers.get(oa);const pa=new n(oa,this);return this.providers.set(oa,pa),pa}getProviders(){return Array.from(this.providers.values())}}},3333:function(a,b,c){"use strict";var d,e;c.d(b,{"in":function(){return d},Yd:function(){return i}}),(e=d||(d={}))[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT";const f={debug:d.DEBUG,verbose:d.VERBOSE,info:d.INFO,warn:d.WARN,error:d.ERROR,silent:d.SILENT},g=d.INFO,h={[d.DEBUG]:"log",[d.VERBOSE]:"log",[d.INFO]:"info",[d.WARN]:"warn",[d.ERROR]:"error"};class i{constructor(j){this.name=j,this._logLevel=g,this._logHandler=(a,b,...c)=>{if(!(b<a.logLevel)){const d=new Date().toISOString(),e=h[b];if(e)console[e](`[${d}]  ${a.name}:`,...c);else throw new Error(`Attempted to log a message with an invalid logType (value: ${b})`)}},this._userLogHandler=null,[].push(this)}get logLevel(){return this._logLevel}set logLevel(k){if(!(k in d))throw new TypeError(`Invalid value "${k}" assigned to \`logLevel\``);this._logLevel=k}setLogLevel(l){this._logLevel="string"==typeof l?f[l]:l}get logHandler(){return this._logHandler}set logHandler(m){if("function"!=typeof m)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=m}get userLogHandler(){return this._userLogHandler}set userLogHandler(n){this._userLogHandler=n}debug(...o){this._userLogHandler&&this._userLogHandler(this,d.DEBUG,...o),this._logHandler(this,d.DEBUG,...o)}log(...p){this._userLogHandler&&this._userLogHandler(this,d.VERBOSE,...p),this._logHandler(this,d.VERBOSE,...p)}info(...q){this._userLogHandler&&this._userLogHandler(this,d.INFO,...q),this._logHandler(this,d.INFO,...q)}warn(...r){this._userLogHandler&&this._userLogHandler(this,d.WARN,...r),this._logHandler(this,d.WARN,...r)}error(...s){this._userLogHandler&&this._userLogHandler(this,d.ERROR,...s),this._logHandler(this,d.ERROR,...s)}}}},function(a){var b=function(b){return a(a.s=b)};a.O(0,[774,179],function(){return b(6363),b(387)}),_N_E=a.O()}])